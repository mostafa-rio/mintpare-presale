import{w as nw,x as sw,y as ow,z as aw,A as cw,C as uw,D as hw,E as lw,F as fw,G as pw,J as dw,K as kc,L as Pf,M as re,N as Of,O as Lo,P as gw,Q as Rf,R as yw,S as To,T as vw,U as mw,V as On,W as ww,X as Tf,Z as Kr,e as Af,_ as bw}from"./index-IIPSTlTY.js";import{e as $r,$ as Hc}from"./events-4rXtr3br.js";function Kc(s){return globalThis.Buffer!=null?new Uint8Array(s.buffer,s.byteOffset,s.byteLength):s}function Cf(s=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Kc(globalThis.Buffer.allocUnsafe(s)):new Uint8Array(s)}function Rc(s,t){t||(t=s.reduce((a,h)=>a+h.length,0));const r=Cf(t);let n=0;for(const a of s)r.set(a,n),n+=a.length;return Kc(r)}const nl={...nw,...sw,...ow,...aw,...cw,...uw,...hw,...lw,...fw,...pw};function Nf(s,t,r,n){return{name:s,prefix:t,encoder:{name:s,prefix:t,encode:r},decoder:{decode:n}}}const sl=Nf("utf8","u",s=>"u"+new TextDecoder("utf8").decode(s),s=>new TextEncoder().encode(s.substring(1))),hc=Nf("ascii","a",s=>{let t="a";for(let r=0;r<s.length;r++)t+=String.fromCharCode(s[r]);return t},s=>{s=s.substring(1);const t=Cf(s.length);for(let r=0;r<s.length;r++)t[r]=s.charCodeAt(r);return t}),$f={utf8:sl,"utf-8":sl,hex:nl.base16,latin1:hc,ascii:hc,binary:hc,...nl};function gr(s,t="utf8"){const r=$f[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Kc(globalThis.Buffer.from(s,"utf-8")):r.decoder.decode(`${r.prefix}${s}`)}function sr(s,t="utf8"){const r=$f[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(s.buffer,s.byteOffset,s.byteLength).toString("utf8"):r.encoder.encode(s).substring(1)}var ol=function(s,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,h;n<a;n++)(h||!(n in t))&&(h||(h=Array.prototype.slice.call(t,0,n)),h[n]=t[n]);return s.concat(h||Array.prototype.slice.call(t))},_w=function(){function s(t,r,n){this.name=t,this.version=r,this.os=n,this.type="browser"}return s}(),Ew=function(){function s(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return s}(),Iw=function(){function s(t,r,n,a){this.name=t,this.version=r,this.os=n,this.bot=a,this.type="bot-device"}return s}(),xw=function(){function s(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return s}(),Sw=function(){function s(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return s}(),Pw=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Ow=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,al=3,Rw=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Pw]],cl=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Tw(s){return s?ul(s):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Sw:typeof navigator<"u"?ul(navigator.userAgent):Nw()}function Aw(s){return s!==""&&Rw.reduce(function(t,r){var n=r[0],a=r[1];if(t)return t;var h=a.exec(s);return!!h&&[n,h]},!1)}function ul(s){var t=Aw(s);if(!t)return null;var r=t[0],n=t[1];if(r==="searchbot")return new xw;var a=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);a?a.length<al&&(a=ol(ol([],a,!0),$w(al-a.length),!0)):a=[];var h=a.join("."),f=Cw(s),g=Ow.exec(s);return g&&g[1]?new Iw(r,h,f,g[1]):new _w(r,h,f)}function Cw(s){for(var t=0,r=cl.length;t<r;t++){var n=cl[t],a=n[0],h=n[1],f=h.exec(s);if(f)return a}return null}function Nw(){var s=typeof process<"u"&&process.version;return s?new Ew(process.version.slice(1)):null}function $w(s){for(var t=[],r=0;r<s;r++)t.push("0");return t}const Dw={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}},Lw=":";function Mw(s){const[t,r]=s.split(Lw);return{namespace:t,reference:r}}function jw(s,t=[]){const r=[];return Object.keys(s).forEach(n=>{if(t.length&&!t.includes(n))return;const a=s[n];r.push(...a.accounts)}),r}function Df(s,t){return s.includes(":")?[s]:t.chains||[]}const Lf="base10",nr="base16",Tc="base64pad",Bc="utf8",Mf=0,Yi=1,Uw=0,hl=1,Ac=12,Vc=32;function qw(){const s=Of.generateKeyPair();return{privateKey:sr(s.secretKey,nr),publicKey:sr(s.publicKey,nr)}}function Cc(){const s=Lo.randomBytes(Vc);return sr(s,nr)}function zw(s,t){const r=Of.sharedKey(gr(s,nr),gr(t,nr),!0),n=new gw(kc.SHA256,r).expand(Vc);return sr(n,nr)}function kw(s){const t=kc.hash(gr(s,nr));return sr(t,nr)}function xn(s){const t=kc.hash(gr(s,Bc));return sr(t,nr)}function Hw(s){return gr(`${s}`,Lf)}function us(s){return Number(sr(s,Lf))}function Kw(s){const t=Hw(typeof s.type<"u"?s.type:Mf);if(us(t)===Yi&&typeof s.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof s.senderPublicKey<"u"?gr(s.senderPublicKey,nr):void 0,n=typeof s.iv<"u"?gr(s.iv,nr):Lo.randomBytes(Ac),a=new Rf.ChaCha20Poly1305(gr(s.symKey,nr)).seal(n,gr(s.message,Bc));return Vw({type:t,sealed:a,iv:n,senderPublicKey:r})}function Bw(s){const t=new Rf.ChaCha20Poly1305(gr(s.symKey,nr)),{sealed:r,iv:n}=Ao(s.encoded),a=t.open(n,r);if(a===null)throw new Error("Failed to decrypt");return sr(a,Bc)}function Vw(s){if(us(s.type)===Yi){if(typeof s.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return sr(Rc([s.type,s.senderPublicKey,s.iv,s.sealed]),Tc)}return sr(Rc([s.type,s.iv,s.sealed]),Tc)}function Ao(s){const t=gr(s,Tc),r=t.slice(Uw,hl),n=hl;if(us(r)===Yi){const g=n+Vc,b=g+Ac,y=t.slice(n,g),E=t.slice(g,b),O=t.slice(b);return{type:r,sealed:O,iv:E,senderPublicKey:y}}const a=n+Ac,h=t.slice(n,a),f=t.slice(a);return{type:r,sealed:f,iv:h}}function Fw(s,t){const r=Ao(s);return jf({type:us(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?sr(r.senderPublicKey,nr):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function jf(s){const t=(s==null?void 0:s.type)||Mf;if(t===Yi){if(typeof(s==null?void 0:s.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(s==null?void 0:s.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:s==null?void 0:s.senderPublicKey,receiverPublicKey:s==null?void 0:s.receiverPublicKey}}function ll(s){return s.type===Yi&&typeof s.senderPublicKey=="string"&&typeof s.receiverPublicKey=="string"}var Ww=Object.defineProperty,fl=Object.getOwnPropertySymbols,Gw=Object.prototype.hasOwnProperty,Jw=Object.prototype.propertyIsEnumerable,pl=(s,t,r)=>t in s?Ww(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,dl=(s,t)=>{for(var r in t||(t={}))Gw.call(t,r)&&pl(s,r,t[r]);if(fl)for(var r of fl(t))Jw.call(t,r)&&pl(s,r,t[r]);return s};const Qw="ReactNative",Er={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Yw="js";function Fc(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Rn(){return!yw()&&!!Pf()&&navigator.product===Qw}function Tn(){return!Fc()&&!!Pf()}function hs(){return Rn()?Er.reactNative:Fc()?Er.node:Tn()?Er.browser:Er.unknown}function Xw(){var s;try{return Rn()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(s=global.Application)==null?void 0:s.applicationId:void 0}catch{return}}function Zw(s,t){let r=To.parse(s);return r=dl(dl({},r),t),s=To.stringify(r),s}function eb(){return dw()||{name:"",description:"",url:"",icons:[""]}}function tb(){if(hs()===Er.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:n}=global.Platform;return[r,n].join("-")}const s=Tw();if(s===null)return"unknown";const t=s.os?s.os.replace(" ","").toLowerCase():"unknown";return s.type==="browser"?[t,s.name,s.version].join("-"):[t,s.version].join("-")}function rb(){var s;const t=hs();return t===Er.browser?[t,((s=vw())==null?void 0:s.host)||"unknown"].join(":"):t}function ib(s,t,r){const n=tb(),a=rb();return[[s,t].join("-"),[Yw,r].join("-"),n,a].join("/")}function nb({protocol:s,version:t,relayUrl:r,sdkVersion:n,auth:a,projectId:h,useOnCloseEvent:f,bundleId:g}){const b=r.split("?"),y=ib(s,t,n),E={auth:a,ua:y,projectId:h,useOnCloseEvent:f||void 0,origin:g||void 0},O=Zw(b[1]||"",E);return b[0]+"?"+O}function Ji(s,t){return s.filter(r=>t.includes(r)).length===s.length}function Uf(s){return Object.fromEntries(s.entries())}function qf(s){return new Map(Object.entries(s))}function En(s=re.FIVE_MINUTES,t){const r=re.toMiliseconds(s||re.FIVE_MINUTES);let n,a,h;return{resolve:f=>{h&&n&&(clearTimeout(h),n(f))},reject:f=>{h&&a&&(clearTimeout(h),a(f))},done:()=>new Promise((f,g)=>{h=setTimeout(()=>{g(new Error(t))},r),n=f,a=g})}}function cs(s,t,r){return new Promise(async(n,a)=>{const h=setTimeout(()=>a(new Error(r)),t);try{const f=await s;n(f)}catch(f){a(f)}clearTimeout(h)})}function zf(s,t){if(typeof t=="string"&&t.startsWith(`${s}:`))return t;if(s.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(s.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${s}`)}function sb(s){return zf("topic",s)}function ob(s){return zf("id",s)}function kf(s){const[t,r]=s.split(":"),n={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")n.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))n.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return n}function kr(s,t){return re.fromMiliseconds((t||Date.now())+re.toMiliseconds(s))}function Ti(s){return Date.now()>=re.toMiliseconds(s)}function Dt(s,t){return`${s}${t?`:${t}`:""}`}function lc(s=[],t=[]){return[...new Set([...s,...t])]}async function ab({id:s,topic:t,wcDeepLink:r}){try{if(!r)return;const n=typeof r=="string"?JSON.parse(r):r;let a=n==null?void 0:n.href;if(typeof a!="string")return;a.endsWith("/")&&(a=a.slice(0,-1));const h=`${a}/wc?requestId=${s}&sessionTopic=${t}`,f=hs();f===Er.browser?h.startsWith("https://")?window.open(h,"_blank","noreferrer noopener"):window.open(h,"_self","noreferrer noopener"):f===Er.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(h)}catch(n){console.error(n)}}async function cb(s,t){try{return await s.getItem(t)||(Tn()?localStorage.getItem(t):void 0)}catch(r){console.error(r)}}const ub="irn";function Nc(s){return(s==null?void 0:s.relay)||{protocol:ub}}function So(s){const t=Dw[s];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${s}`);return t}var hb=Object.defineProperty,gl=Object.getOwnPropertySymbols,lb=Object.prototype.hasOwnProperty,fb=Object.prototype.propertyIsEnumerable,yl=(s,t,r)=>t in s?hb(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,pb=(s,t)=>{for(var r in t||(t={}))lb.call(t,r)&&yl(s,r,t[r]);if(gl)for(var r of gl(t))fb.call(t,r)&&yl(s,r,t[r]);return s};function db(s,t="-"){const r={},n="relay"+t;return Object.keys(s).forEach(a=>{if(a.startsWith(n)){const h=a.replace(n,""),f=s[a];r[h]=f}}),r}function vl(s){s=s.includes("wc://")?s.replace("wc://",""):s,s=s.includes("wc:")?s.replace("wc:",""):s;const t=s.indexOf(":"),r=s.indexOf("?")!==-1?s.indexOf("?"):void 0,n=s.substring(0,t),a=s.substring(t+1,r).split("@"),h=typeof r<"u"?s.substring(r):"",f=To.parse(h);return{protocol:n,topic:gb(a[0]),version:parseInt(a[1],10),symKey:f.symKey,relay:db(f)}}function gb(s){return s.startsWith("//")?s.substring(2):s}function yb(s,t="-"){const r="relay",n={};return Object.keys(s).forEach(a=>{const h=r+t+a;s[a]&&(n[h]=s[a])}),n}function vb(s){return`${s.protocol}:${s.topic}@${s.version}?`+To.stringify(pb({symKey:s.symKey},yb(s.relay)))}function An(s){const t=[];return s.forEach(r=>{const[n,a]=r.split(":");t.push(`${n}:${a}`)}),t}function mb(s){const t=[];return Object.values(s).forEach(r=>{t.push(...An(r.accounts))}),t}function wb(s,t){const r=[];return Object.values(s).forEach(n=>{An(n.accounts).includes(t)&&r.push(...n.methods)}),r}function bb(s,t){const r=[];return Object.values(s).forEach(n=>{An(n.accounts).includes(t)&&r.push(...n.events)}),r}function _b(s,t){const r=Po(s,t);if(r)throw new Error(r.message);const n={};for(const[a,h]of Object.entries(s))n[a]={methods:h.methods,events:h.events,chains:h.accounts.map(f=>`${f.split(":")[0]}:${f.split(":")[1]}`)};return n}function Wc(s){return s.includes(":")}function ns(s){return Wc(s)?s.split(":")[0]:s}const Eb={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Ib={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function J(s,t){const{message:r,code:n}=Ib[s];return{message:t?`${r} ${t}`:r,code:n}}function It(s,t){const{message:r,code:n}=Eb[s];return{message:t?`${r} ${t}`:r,code:n}}function Xr(s,t){return Array.isArray(s)?typeof t<"u"&&s.length?s.every(t):!0:!1}function Sn(s){return Object.getPrototypeOf(s)===Object.prototype&&Object.keys(s).length}function ir(s){return typeof s>"u"}function Ht(s,t){return t&&ir(s)?!0:typeof s=="string"&&!!s.trim().length}function Gc(s,t){return t&&ir(s)?!0:typeof s=="number"&&!isNaN(s)}function xb(s,t){const{requiredNamespaces:r}=t,n=Object.keys(s.namespaces),a=Object.keys(r);let h=!0;return Ji(a,n)?(n.forEach(f=>{const{accounts:g,methods:b,events:y}=s.namespaces[f],E=An(g),O=r[f];(!Ji(Df(f,O),E)||!Ji(O.methods,b)||!Ji(O.events,y))&&(h=!1)}),h):!1}function Co(s){return Ht(s,!1)&&s.includes(":")?s.split(":").length===2:!1}function Sb(s){if(Ht(s,!1)&&s.includes(":")){const t=s.split(":");if(t.length===3){const r=t[0]+":"+t[1];return!!t[2]&&Co(r)}}return!1}function Pb(s){if(Ht(s,!1))try{return typeof new URL(s)<"u"}catch{return!1}return!1}function Ob(s){var t;return(t=s==null?void 0:s.proposer)==null?void 0:t.publicKey}function Rb(s){return s==null?void 0:s.topic}function Tb(s,t){let r=null;return Ht(s==null?void 0:s.publicKey,!1)||(r=J("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function ml(s){let t=!0;return Xr(s)?s.length&&(t=s.every(r=>Ht(r,!1))):t=!1,t}function Ab(s,t,r){let n=null;return Xr(t)&&t.length?t.forEach(a=>{n||Co(a)||(n=It("UNSUPPORTED_CHAINS",`${r}, chain ${a} should be a string and conform to "namespace:chainId" format`))}):Co(s)||(n=It("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),n}function Cb(s,t,r){let n=null;return Object.entries(s).forEach(([a,h])=>{if(n)return;const f=Ab(a,Df(a,h),`${t} ${r}`);f&&(n=f)}),n}function Nb(s,t){let r=null;return Xr(s)?s.forEach(n=>{r||Sb(n)||(r=It("UNSUPPORTED_ACCOUNTS",`${t}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):r=It("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function $b(s,t){let r=null;return Object.values(s).forEach(n=>{if(r)return;const a=Nb(n==null?void 0:n.accounts,`${t} namespace`);a&&(r=a)}),r}function Db(s,t){let r=null;return ml(s==null?void 0:s.methods)?ml(s==null?void 0:s.events)||(r=It("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=It("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function Hf(s,t){let r=null;return Object.values(s).forEach(n=>{if(r)return;const a=Db(n,`${t}, namespace`);a&&(r=a)}),r}function Lb(s,t,r){let n=null;if(s&&Sn(s)){const a=Hf(s,t);a&&(n=a);const h=Cb(s,t,r);h&&(n=h)}else n=J("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return n}function Po(s,t){let r=null;if(s&&Sn(s)){const n=Hf(s,t);n&&(r=n);const a=$b(s,t);a&&(r=a)}else r=J("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function Kf(s){return Ht(s.protocol,!0)}function Mb(s,t){let r=!1;return t&&!s?r=!0:s&&Xr(s)&&s.length&&s.forEach(n=>{r=Kf(n)}),r}function jb(s){return typeof s=="number"}function dr(s){return typeof s<"u"&&typeof s!==null}function Ub(s){return!(!s||typeof s!="object"||!s.code||!Gc(s.code,!1)||!s.message||!Ht(s.message,!1))}function qb(s){return!(ir(s)||!Ht(s.method,!1))}function zb(s){return!(ir(s)||ir(s.result)&&ir(s.error)||!Gc(s.id,!1)||!Ht(s.jsonrpc,!1))}function kb(s){return!(ir(s)||!Ht(s.name,!1))}function wl(s,t){return!(!Co(t)||!mb(s).includes(t))}function Hb(s,t,r){return Ht(r,!1)?wb(s,t).includes(r):!1}function Kb(s,t,r){return Ht(r,!1)?bb(s,t).includes(r):!1}function bl(s,t,r){let n=null;const a=Bb(s),h=Vb(t),f=Object.keys(a),g=Object.keys(h),b=_l(Object.keys(s)),y=_l(Object.keys(t)),E=b.filter(O=>!y.includes(O));return E.length&&(n=J("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${E.toString()}
      Received: ${Object.keys(t).toString()}`)),Ji(f,g)||(n=J("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${f.toString()}
      Approved: ${g.toString()}`)),Object.keys(t).forEach(O=>{if(!O.includes(":")||n)return;const C=An(t[O].accounts);C.includes(O)||(n=J("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${O}
        Required: ${O}
        Approved: ${C.toString()}`))}),f.forEach(O=>{n||(Ji(a[O].methods,h[O].methods)?Ji(a[O].events,h[O].events)||(n=J("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${O}`)):n=J("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${O}`))}),n}function Bb(s){const t={};return Object.keys(s).forEach(r=>{var n;r.includes(":")?t[r]=s[r]:(n=s[r].chains)==null||n.forEach(a=>{t[a]={methods:s[r].methods,events:s[r].events}})}),t}function _l(s){return[...new Set(s.map(t=>t.includes(":")?t.split(":")[0]:t))]}function Vb(s){const t={};return Object.keys(s).forEach(r=>{if(r.includes(":"))t[r]=s[r];else{const n=An(s[r].accounts);n==null||n.forEach(a=>{t[a]={accounts:s[r].accounts.filter(h=>h.includes(`${a}:`)),methods:s[r].methods,events:s[r].events}})}}),t}function Fb(s,t){return Gc(s,!1)&&s<=t.max&&s>=t.min}function El(){const s=hs();return new Promise(t=>{switch(s){case Er.browser:t(Wb());break;case Er.reactNative:t(Gb());break;case Er.node:t(Jb());break;default:t(!0)}})}function Wb(){return Tn()&&(navigator==null?void 0:navigator.onLine)}async function Gb(){if(Rn()&&typeof global<"u"&&global!=null&&global.NetInfo){const s=await(global==null?void 0:global.NetInfo.fetch());return s==null?void 0:s.isConnected}return!0}function Jb(){return!0}function Qb(s){switch(hs()){case Er.browser:Yb(s);break;case Er.reactNative:Xb(s);break}}function Yb(s){!Rn()&&Tn()&&(window.addEventListener("online",()=>s(!0)),window.addEventListener("offline",()=>s(!1)))}function Xb(s){Rn()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(t=>s(t==null?void 0:t.isConnected)))}const fc={};let wo=class{static get(t){return fc[t]}static set(t,r){fc[t]=r}static delete(t){delete fc[t]}};const Zb=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,e_=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,t_=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function r_(s,t){if(s==="__proto__"||s==="constructor"&&t&&typeof t=="object"&&"prototype"in t){i_(s);return}return t}function i_(s){console.warn(`[destr] Dropping "${s}" key to prevent prototype pollution.`)}function bo(s,t={}){if(typeof s!="string")return s;const r=s.trim();if(s[0]==='"'&&s.at(-1)==='"'&&!s.includes("\\"))return r.slice(1,-1);if(r.length<=9){const n=r.toLowerCase();if(n==="true")return!0;if(n==="false")return!1;if(n==="undefined")return;if(n==="null")return null;if(n==="nan")return Number.NaN;if(n==="infinity")return Number.POSITIVE_INFINITY;if(n==="-infinity")return Number.NEGATIVE_INFINITY}if(!t_.test(s)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return s}try{if(Zb.test(s)||e_.test(s)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(s,r_)}return JSON.parse(s)}catch(n){if(t.strict)throw n;return s}}function n_(s){return!s||typeof s.then!="function"?Promise.resolve(s):s}function kt(s,...t){try{return n_(s(...t))}catch(r){return Promise.reject(r)}}function s_(s){const t=typeof s;return s===null||t!=="object"&&t!=="function"}function o_(s){const t=Object.getPrototypeOf(s);return!t||t.isPrototypeOf(Object)}function Oo(s){if(s_(s))return String(s);if(o_(s)||Array.isArray(s))return JSON.stringify(s);if(typeof s.toJSON=="function")return Oo(s.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function Bf(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const $c="base64:";function a_(s){if(typeof s=="string")return s;Bf();const t=Buffer.from(s).toString("base64");return $c+t}function c_(s){return typeof s!="string"||!s.startsWith($c)?s:(Bf(),Buffer.from(s.slice($c.length),"base64"))}function pr(s){return s?s.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function u_(...s){return pr(s.join(":"))}function _o(s){return s=pr(s),s?s+":":""}const h_="memory",l_=()=>{const s=new Map;return{name:h_,options:{},hasItem(t){return s.has(t)},getItem(t){return s.get(t)??null},getItemRaw(t){return s.get(t)??null},setItem(t,r){s.set(t,r)},setItemRaw(t,r){s.set(t,r)},removeItem(t){s.delete(t)},getKeys(){return Array.from(s.keys())},clear(){s.clear()},dispose(){s.clear()}}};function f_(s={}){const t={mounts:{"":s.driver||l_()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=y=>{for(const E of t.mountpoints)if(y.startsWith(E))return{base:E,relativeKey:y.slice(E.length),driver:t.mounts[E]};return{base:"",relativeKey:y,driver:t.mounts[""]}},n=(y,E)=>t.mountpoints.filter(O=>O.startsWith(y)||E&&y.startsWith(O)).map(O=>({relativeBase:y.length>O.length?y.slice(O.length):void 0,mountpoint:O,driver:t.mounts[O]})),a=(y,E)=>{if(t.watching){E=pr(E);for(const O of t.watchListeners)O(y,E)}},h=async()=>{if(!t.watching){t.watching=!0;for(const y in t.mounts)t.unwatch[y]=await Il(t.mounts[y],a,y)}},f=async()=>{if(t.watching){for(const y in t.unwatch)await t.unwatch[y]();t.unwatch={},t.watching=!1}},g=(y,E,O)=>{const C=new Map,q=A=>{let V=C.get(A.base);return V||(V={driver:A.driver,base:A.base,items:[]},C.set(A.base,V)),V};for(const A of y){const V=typeof A=="string",ie=pr(V?A:A.key),he=V?void 0:A.value,le=V||!A.options?E:{...E,...A.options},fe=r(ie);q(fe).items.push({key:ie,value:he,relativeKey:fe.relativeKey,options:le})}return Promise.all([...C.values()].map(A=>O(A))).then(A=>A.flat())},b={hasItem(y,E={}){y=pr(y);const{relativeKey:O,driver:C}=r(y);return kt(C.hasItem,O,E)},getItem(y,E={}){y=pr(y);const{relativeKey:O,driver:C}=r(y);return kt(C.getItem,O,E).then(q=>bo(q))},getItems(y,E){return g(y,E,O=>O.driver.getItems?kt(O.driver.getItems,O.items.map(C=>({key:C.relativeKey,options:C.options})),E).then(C=>C.map(q=>({key:u_(O.base,q.key),value:bo(q.value)}))):Promise.all(O.items.map(C=>kt(O.driver.getItem,C.relativeKey,C.options).then(q=>({key:C.key,value:bo(q)})))))},getItemRaw(y,E={}){y=pr(y);const{relativeKey:O,driver:C}=r(y);return C.getItemRaw?kt(C.getItemRaw,O,E):kt(C.getItem,O,E).then(q=>c_(q))},async setItem(y,E,O={}){if(E===void 0)return b.removeItem(y);y=pr(y);const{relativeKey:C,driver:q}=r(y);q.setItem&&(await kt(q.setItem,C,Oo(E),O),q.watch||a("update",y))},async setItems(y,E){await g(y,E,async O=>{O.driver.setItems&&await kt(O.driver.setItems,O.items.map(C=>({key:C.relativeKey,value:Oo(C.value),options:C.options})),E),O.driver.setItem&&await Promise.all(O.items.map(C=>kt(O.driver.setItem,C.relativeKey,Oo(C.value),C.options)))})},async setItemRaw(y,E,O={}){if(E===void 0)return b.removeItem(y,O);y=pr(y);const{relativeKey:C,driver:q}=r(y);if(q.setItemRaw)await kt(q.setItemRaw,C,E,O);else if(q.setItem)await kt(q.setItem,C,a_(E),O);else return;q.watch||a("update",y)},async removeItem(y,E={}){typeof E=="boolean"&&(E={removeMeta:E}),y=pr(y);const{relativeKey:O,driver:C}=r(y);C.removeItem&&(await kt(C.removeItem,O,E),(E.removeMeta||E.removeMata)&&await kt(C.removeItem,O+"$",E),C.watch||a("remove",y))},async getMeta(y,E={}){typeof E=="boolean"&&(E={nativeOnly:E}),y=pr(y);const{relativeKey:O,driver:C}=r(y),q=Object.create(null);if(C.getMeta&&Object.assign(q,await kt(C.getMeta,O,E)),!E.nativeOnly){const A=await kt(C.getItem,O+"$",E).then(V=>bo(V));A&&typeof A=="object"&&(typeof A.atime=="string"&&(A.atime=new Date(A.atime)),typeof A.mtime=="string"&&(A.mtime=new Date(A.mtime)),Object.assign(q,A))}return q},setMeta(y,E,O={}){return this.setItem(y+"$",E,O)},removeMeta(y,E={}){return this.removeItem(y+"$",E)},async getKeys(y,E={}){y=_o(y);const O=n(y,!0);let C=[];const q=[];for(const A of O){const ie=(await kt(A.driver.getKeys,A.relativeBase,E)).map(he=>A.mountpoint+pr(he)).filter(he=>!C.some(le=>he.startsWith(le)));q.push(...ie),C=[A.mountpoint,...C.filter(he=>!he.startsWith(A.mountpoint))]}return y?q.filter(A=>A.startsWith(y)&&!A.endsWith("$")):q.filter(A=>!A.endsWith("$"))},async clear(y,E={}){y=_o(y),await Promise.all(n(y,!1).map(async O=>{if(O.driver.clear)return kt(O.driver.clear,O.relativeBase,E);if(O.driver.removeItem){const C=await O.driver.getKeys(O.relativeBase||"",E);return Promise.all(C.map(q=>O.driver.removeItem(q,E)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(y=>xl(y)))},async watch(y){return await h(),t.watchListeners.push(y),async()=>{t.watchListeners=t.watchListeners.filter(E=>E!==y),t.watchListeners.length===0&&await f()}},async unwatch(){t.watchListeners=[],await f()},mount(y,E){if(y=_o(y),y&&t.mounts[y])throw new Error(`already mounted at ${y}`);return y&&(t.mountpoints.push(y),t.mountpoints.sort((O,C)=>C.length-O.length)),t.mounts[y]=E,t.watching&&Promise.resolve(Il(E,a,y)).then(O=>{t.unwatch[y]=O}).catch(console.error),b},async unmount(y,E=!0){y=_o(y),!(!y||!t.mounts[y])&&(t.watching&&y in t.unwatch&&(t.unwatch[y](),delete t.unwatch[y]),E&&await xl(t.mounts[y]),t.mountpoints=t.mountpoints.filter(O=>O!==y),delete t.mounts[y])},getMount(y=""){y=pr(y)+":";const E=r(y);return{driver:E.driver,base:E.base}},getMounts(y="",E={}){return y=pr(y),n(y,E.parents).map(C=>({driver:C.driver,base:C.mountpoint}))}};return b}function Il(s,t,r){return s.watch?s.watch((n,a)=>t(n,r+a)):()=>{}}async function xl(s){typeof s.dispose=="function"&&await kt(s.dispose)}function Xi(s){return new Promise((t,r)=>{s.oncomplete=s.onsuccess=()=>t(s.result),s.onabort=s.onerror=()=>r(s.error)})}function Vf(s,t){const r=indexedDB.open(s);r.onupgradeneeded=()=>r.result.createObjectStore(t);const n=Xi(r);return(a,h)=>n.then(f=>h(f.transaction(t,a).objectStore(t)))}let pc;function ls(){return pc||(pc=Vf("keyval-store","keyval")),pc}function Sl(s,t=ls()){return t("readonly",r=>Xi(r.get(s)))}function p_(s,t,r=ls()){return r("readwrite",n=>(n.put(t,s),Xi(n.transaction)))}function d_(s,t=ls()){return t("readwrite",r=>(r.delete(s),Xi(r.transaction)))}function g_(s=ls()){return s("readwrite",t=>(t.clear(),Xi(t.transaction)))}function y_(s,t){return s.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Xi(s.transaction)}function v_(s=ls()){return s("readonly",t=>{if(t.getAllKeys)return Xi(t.getAllKeys());const r=[];return y_(t,n=>r.push(n.key)).then(()=>r)})}const m_=s=>JSON.stringify(s,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),w_=s=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=s.replace(t,'$1"$2n"$3');return JSON.parse(r,(n,a)=>typeof a=="string"&&a.match(/^\d+n$/)?BigInt(a.substring(0,a.length-1)):a)};function fs(s){if(typeof s!="string")throw new Error(`Cannot safe json parse value of type ${typeof s}`);try{return w_(s)}catch{return s}}function Qi(s){return typeof s=="string"?s:m_(s)||""}const b_="idb-keyval";var __=(s={})=>{const t=s.base&&s.base.length>0?`${s.base}:`:"",r=a=>t+a;let n;return s.dbName&&s.storeName&&(n=Vf(s.dbName,s.storeName)),{name:b_,options:s,async hasItem(a){return!(typeof await Sl(r(a),n)>"u")},async getItem(a){return await Sl(r(a),n)??null},setItem(a,h){return p_(r(a),h,n)},removeItem(a){return d_(r(a),n)},getKeys(){return v_(n)},clear(){return g_(n)}}};const E_="WALLET_CONNECT_V2_INDEXED_DB",I_="keyvaluestorage";let x_=class{constructor(){this.indexedDb=f_({driver:__({dbName:E_,storeName:I_})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const r=await this.indexedDb.getItem(t);if(r!==null)return r}async setItem(t,r){await this.indexedDb.setItem(t,Qi(r))}async removeItem(t){await this.indexedDb.removeItem(t)}};var dc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ro={exports:{}};(function(){let s;function t(){}s=t,s.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},s.prototype.setItem=function(r,n){this[r]=String(n)},s.prototype.removeItem=function(r){delete this[r]},s.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},s.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},s.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof dc<"u"&&dc.localStorage?Ro.exports=dc.localStorage:typeof window<"u"&&window.localStorage?Ro.exports=window.localStorage:Ro.exports=new t})();function S_(s){var t;return[s[0],fs((t=s[1])!=null?t:"")]}class P_{constructor(){this.localStorage=Ro.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(S_)}async getItem(t){const r=this.localStorage.getItem(t);if(r!==null)return fs(r)}async setItem(t,r){this.localStorage.setItem(t,Qi(r))}async removeItem(t){this.localStorage.removeItem(t)}}const O_="wc_storage_version",Pl=1,R_=async(s,t,r)=>{const n=O_,a=await t.getItem(n);if(a&&a>=Pl){r(t);return}const h=await s.getKeys();if(!h.length){r(t);return}const f=[];for(;h.length;){const g=h.shift();if(!g)continue;const b=g.toLowerCase();if(b.includes("wc@")||b.includes("walletconnect")||b.includes("wc_")||b.includes("wallet_connect")){const y=await s.getItem(g);await t.setItem(g,y),f.push(g)}}await t.setItem(n,Pl),r(t),T_(s,f)},T_=async(s,t)=>{t.length&&t.forEach(async r=>{await s.removeItem(r)})};let A_=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const t=new P_;this.storage=t;try{const r=new x_;R_(t,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,r){return await this.initialize(),this.storage.setItem(t,r)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),t())},20)})}};var Cn={},Yn={},gc={},Xn={};let Zi=class{};const C_=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Zi},Symbol.toStringTag,{value:"Module"})),N_=mw(C_);var Ol;function $_(){if(Ol)return Xn;Ol=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.IHeartBeat=void 0;const s=N_;class t extends s.IEvents{constructor(n){super()}}return Xn.IHeartBeat=t,Xn}var Rl;function Ff(){return Rl||(Rl=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),On.__exportStar($_(),s)}(gc)),gc}var yc={},Wi={},Tl;function D_(){if(Tl)return Wi;Tl=1,Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.HEARTBEAT_EVENTS=Wi.HEARTBEAT_INTERVAL=void 0;const s=re;return Wi.HEARTBEAT_INTERVAL=s.FIVE_SECONDS,Wi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Wi}var Al;function Wf(){return Al||(Al=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),On.__exportStar(D_(),s)}(yc)),yc}var Cl;function L_(){if(Cl)return Yn;Cl=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.HeartBeat=void 0;const s=On,t=$r,r=re,n=Ff(),a=Wf();class h extends n.IHeartBeat{constructor(g){super(g),this.events=new t.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=(g==null?void 0:g.interval)||a.HEARTBEAT_INTERVAL}static init(g){return s.__awaiter(this,void 0,void 0,function*(){const b=new h(g);return yield b.init(),b})}init(){return s.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(g,b){this.events.on(g,b)}once(g,b){this.events.once(g,b)}off(g,b){this.events.off(g,b)}removeListener(g,b){this.events.removeListener(g,b)}initialize(){return s.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return Yn.HeartBeat=h,Yn}(function(s){Object.defineProperty(s,"__esModule",{value:!0});const t=On;t.__exportStar(L_(),s),t.__exportStar(Ff(),s),t.__exportStar(Wf(),s)})(Cn);var Ae={},vc,Nl;function M_(){if(Nl)return vc;Nl=1;function s(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}vc=t;function t(r,n,a){var h=a&&a.stringify||s,f=1;if(typeof r=="object"&&r!==null){var g=n.length+f;if(g===1)return r;var b=new Array(g);b[0]=h(r);for(var y=1;y<g;y++)b[y]=h(n[y]);return b.join(" ")}if(typeof r!="string")return r;var E=n.length;if(E===0)return r;for(var O="",C=1-f,q=-1,A=r&&r.length||0,V=0;V<A;){if(r.charCodeAt(V)===37&&V+1<A){switch(q=q>-1?q:0,r.charCodeAt(V+1)){case 100:case 102:if(C>=E||n[C]==null)break;q<V&&(O+=r.slice(q,V)),O+=Number(n[C]),q=V+2,V++;break;case 105:if(C>=E||n[C]==null)break;q<V&&(O+=r.slice(q,V)),O+=Math.floor(Number(n[C])),q=V+2,V++;break;case 79:case 111:case 106:if(C>=E||n[C]===void 0)break;q<V&&(O+=r.slice(q,V));var ie=typeof n[C];if(ie==="string"){O+="'"+n[C]+"'",q=V+2,V++;break}if(ie==="function"){O+=n[C].name||"<anonymous>",q=V+2,V++;break}O+=h(n[C]),q=V+2,V++;break;case 115:if(C>=E)break;q<V&&(O+=r.slice(q,V)),O+=String(n[C]),q=V+2,V++;break;case 37:q<V&&(O+=r.slice(q,V)),O+="%",q=V+2,V++,C--;break}++C}++V}return q===-1?r:(q<A&&(O+=r.slice(q)),O)}return vc}var mc,$l;function j_(){if($l)return mc;$l=1;const s=M_();mc=a;const t=de().console||{},r={mapHttpRequest:A,mapHttpResponse:A,wrapRequestSerializer:V,wrapResponseSerializer:V,wrapErrorSerializer:V,req:A,res:A,err:C};function n(L,k){return Array.isArray(L)?L.filter(function(ve){return ve!=="!stdSerializers.err"}):L===!0?Object.keys(k):!1}function a(L){L=L||{},L.browser=L.browser||{};const k=L.browser.transmit;if(k&&typeof k.send!="function")throw Error("pino: transmit option must have a send function");const G=L.browser.write||t;L.browser.write&&(L.browser.asObject=!0);const ve=L.serializers||{},ne=n(L.browser.serialize,ve);let ue=L.browser.serialize;Array.isArray(L.browser.serialize)&&L.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ue=!1);const Ce=["error","fatal","warn","info","debug","trace"];typeof G=="function"&&(G.error=G.fatal=G.warn=G.info=G.debug=G.trace=G),L.enabled===!1&&(L.level="silent");const ze=L.level||"info",m=Object.create(G);m.log||(m.log=ie),Object.defineProperty(m,"levelVal",{get:X}),Object.defineProperty(m,"level",{get:ce,set:F});const x={transmit:k,serialize:ne,asObject:L.browser.asObject,levels:Ce,timestamp:q(L)};m.levels=a.levels,m.level=ze,m.setMaxListeners=m.getMaxListeners=m.emit=m.addListener=m.on=m.prependListener=m.once=m.prependOnceListener=m.removeListener=m.removeAllListeners=m.listeners=m.listenerCount=m.eventNames=m.write=m.flush=ie,m.serializers=ve,m._serialize=ne,m._stdErrSerialize=ue,m.child=H,k&&(m._logEvent=O());function X(){return this.level==="silent"?1/0:this.levels.values[this.level]}function ce(){return this._level}function F(B){if(B!=="silent"&&!this.levels.values[B])throw Error("unknown level "+B);this._level=B,h(x,m,"error","log"),h(x,m,"fatal","error"),h(x,m,"warn","error"),h(x,m,"info","log"),h(x,m,"debug","log"),h(x,m,"trace","log")}function H(B,W){if(!B)throw new Error("missing bindings for child Pino");W=W||{},ne&&B.serializers&&(W.serializers=B.serializers);const Je=W.serializers;if(ne&&Je){var Ke=Object.assign({},ve,Je),Br=L.browser.serialize===!0?Object.keys(Ke):ne;delete B.serializers,b([B],Br,Ke,this._stdErrSerialize)}function Ie(xt){this._childLevel=(xt._childLevel|0)+1,this.error=y(xt,B,"error"),this.fatal=y(xt,B,"fatal"),this.warn=y(xt,B,"warn"),this.info=y(xt,B,"info"),this.debug=y(xt,B,"debug"),this.trace=y(xt,B,"trace"),Ke&&(this.serializers=Ke,this._serialize=Br),k&&(this._logEvent=O([].concat(xt._logEvent.bindings,B)))}return Ie.prototype=this,new Ie(this)}return m}a.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},a.stdSerializers=r,a.stdTimeFunctions=Object.assign({},{nullTime:he,epochTime:le,unixTime:fe,isoTime:pe});function h(L,k,G,ve){const ne=Object.getPrototypeOf(k);k[G]=k.levelVal>k.levels.values[G]?ie:ne[G]?ne[G]:t[G]||t[ve]||ie,f(L,k,G)}function f(L,k,G){!L.transmit&&k[G]===ie||(k[G]=function(ve){return function(){const ue=L.timestamp(),Ce=new Array(arguments.length),ze=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var m=0;m<Ce.length;m++)Ce[m]=arguments[m];if(L.serialize&&!L.asObject&&b(Ce,this._serialize,this.serializers,this._stdErrSerialize),L.asObject?ve.call(ze,g(this,G,Ce,ue)):ve.apply(ze,Ce),L.transmit){const x=L.transmit.level||k.level,X=a.levels.values[x],ce=a.levels.values[G];if(ce<X)return;E(this,{ts:ue,methodLevel:G,methodValue:ce,transmitLevel:x,transmitValue:a.levels.values[L.transmit.level||k.level],send:L.transmit.send,val:k.levelVal},Ce)}}}(k[G]))}function g(L,k,G,ve){L._serialize&&b(G,L._serialize,L.serializers,L._stdErrSerialize);const ne=G.slice();let ue=ne[0];const Ce={};ve&&(Ce.time=ve),Ce.level=a.levels.values[k];let ze=(L._childLevel|0)+1;if(ze<1&&(ze=1),ue!==null&&typeof ue=="object"){for(;ze--&&typeof ne[0]=="object";)Object.assign(Ce,ne.shift());ue=ne.length?s(ne.shift(),ne):void 0}else typeof ue=="string"&&(ue=s(ne.shift(),ne));return ue!==void 0&&(Ce.msg=ue),Ce}function b(L,k,G,ve){for(const ne in L)if(ve&&L[ne]instanceof Error)L[ne]=a.stdSerializers.err(L[ne]);else if(typeof L[ne]=="object"&&!Array.isArray(L[ne]))for(const ue in L[ne])k&&k.indexOf(ue)>-1&&ue in G&&(L[ne][ue]=G[ue](L[ne][ue]))}function y(L,k,G){return function(){const ve=new Array(1+arguments.length);ve[0]=k;for(var ne=1;ne<ve.length;ne++)ve[ne]=arguments[ne-1];return L[G].apply(this,ve)}}function E(L,k,G){const ve=k.send,ne=k.ts,ue=k.methodLevel,Ce=k.methodValue,ze=k.val,m=L._logEvent.bindings;b(G,L._serialize||Object.keys(L.serializers),L.serializers,L._stdErrSerialize===void 0?!0:L._stdErrSerialize),L._logEvent.ts=ne,L._logEvent.messages=G.filter(function(x){return m.indexOf(x)===-1}),L._logEvent.level.label=ue,L._logEvent.level.value=Ce,ve(ue,L._logEvent,ze),L._logEvent=O(m)}function O(L){return{ts:0,messages:[],bindings:L||[],level:{label:"",value:0}}}function C(L){const k={type:L.constructor.name,msg:L.message,stack:L.stack};for(const G in L)k[G]===void 0&&(k[G]=L[G]);return k}function q(L){return typeof L.timestamp=="function"?L.timestamp:L.timestamp===!1?he:le}function A(){return{}}function V(L){return L}function ie(){}function he(){return!1}function le(){return Date.now()}function fe(){return Math.round(Date.now()/1e3)}function pe(){return new Date(Date.now()).toISOString()}function de(){function L(k){return typeof k<"u"&&k}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return L(self)||L(window)||L(this)||{}}}return mc}var Gi={},Dl;function Gf(){return Dl||(Dl=1,Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.PINO_CUSTOM_CONTEXT_KEY=Gi.PINO_LOGGER_DEFAULTS=void 0,Gi.PINO_LOGGER_DEFAULTS={level:"info"},Gi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Gi}var rr={},Ll;function U_(){if(Ll)return rr;Ll=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.generateChildLogger=rr.formatChildLoggerContext=rr.getLoggerContext=rr.setBrowserLoggerContext=rr.getBrowserLoggerContext=rr.getDefaultLoggerOptions=void 0;const s=Gf();function t(g){return Object.assign(Object.assign({},g),{level:(g==null?void 0:g.level)||s.PINO_LOGGER_DEFAULTS.level})}rr.getDefaultLoggerOptions=t;function r(g,b=s.PINO_CUSTOM_CONTEXT_KEY){return g[b]||""}rr.getBrowserLoggerContext=r;function n(g,b,y=s.PINO_CUSTOM_CONTEXT_KEY){return g[y]=b,g}rr.setBrowserLoggerContext=n;function a(g,b=s.PINO_CUSTOM_CONTEXT_KEY){let y="";return typeof g.bindings>"u"?y=r(g,b):y=g.bindings().context||"",y}rr.getLoggerContext=a;function h(g,b,y=s.PINO_CUSTOM_CONTEXT_KEY){const E=a(g,y);return E.trim()?`${E}/${b}`:b}rr.formatChildLoggerContext=h;function f(g,b,y=s.PINO_CUSTOM_CONTEXT_KEY){const E=h(g,b,y),O=g.child({context:E});return n(O,E,y)}return rr.generateChildLogger=f,rr}(function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.pino=void 0;const t=On,r=t.__importDefault(j_());Object.defineProperty(s,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(Gf(),s),t.__exportStar(U_(),s)})(Ae);class q_ extends Zi{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}let z_=class extends Zi{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}},k_=class{constructor(t,r){this.logger=t,this.core=r}},H_=class extends Zi{constructor(t,r){super(),this.relayer=t,this.logger=r}},K_=class extends Zi{constructor(t){super()}},B_=class{constructor(t,r,n,a){this.core=t,this.logger=r,this.name=n}};class V_ extends Zi{constructor(t,r){super(),this.relayer=t,this.logger=r}}let F_=class extends Zi{constructor(t,r){super(),this.core=t,this.logger=r}},W_=class{constructor(t,r){this.projectId=t,this.logger=r}},G_=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},J_=class{constructor(t){this.client=t}};var Jc={},Jf={};(function(s){Object.defineProperty(s,"__esModule",{value:!0});var t=ww,r=Tf;s.DIGEST_LENGTH=64,s.BLOCK_SIZE=128;var n=function(){function g(){this.digestLength=s.DIGEST_LENGTH,this.blockSize=s.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return g.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},g.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},g.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},g.prototype.update=function(b,y){if(y===void 0&&(y=b.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var E=0;if(this._bytesHashed+=y,this._bufferLength>0){for(;this._bufferLength<s.BLOCK_SIZE&&y>0;)this._buffer[this._bufferLength++]=b[E++],y--;this._bufferLength===this.blockSize&&(h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(y>=this.blockSize&&(E=h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,b,E,y),y%=this.blockSize);y>0;)this._buffer[this._bufferLength++]=b[E++],y--;return this},g.prototype.finish=function(b){if(!this._finished){var y=this._bytesHashed,E=this._bufferLength,O=y/536870912|0,C=y<<3,q=y%128<112?128:256;this._buffer[E]=128;for(var A=E+1;A<q-8;A++)this._buffer[A]=0;t.writeUint32BE(O,this._buffer,q-8),t.writeUint32BE(C,this._buffer,q-4),h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,q),this._finished=!0}for(var A=0;A<this.digestLength/8;A++)t.writeUint32BE(this._stateHi[A],b,A*8),t.writeUint32BE(this._stateLo[A],b,A*8+4);return this},g.prototype.digest=function(){var b=new Uint8Array(this.digestLength);return this.finish(b),b},g.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},g.prototype.restoreState=function(b){return this._stateHi.set(b.stateHi),this._stateLo.set(b.stateLo),this._bufferLength=b.bufferLength,b.buffer&&this._buffer.set(b.buffer),this._bytesHashed=b.bytesHashed,this._finished=!1,this},g.prototype.cleanSavedState=function(b){r.wipe(b.stateHi),r.wipe(b.stateLo),b.buffer&&r.wipe(b.buffer),b.bufferLength=0,b.bytesHashed=0},g}();s.SHA512=n;var a=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function h(g,b,y,E,O,C,q){for(var A=y[0],V=y[1],ie=y[2],he=y[3],le=y[4],fe=y[5],pe=y[6],de=y[7],L=E[0],k=E[1],G=E[2],ve=E[3],ne=E[4],ue=E[5],Ce=E[6],ze=E[7],m,x,X,ce,F,H,B,W;q>=128;){for(var Je=0;Je<16;Je++){var Ke=8*Je+C;g[Je]=t.readUint32BE(O,Ke),b[Je]=t.readUint32BE(O,Ke+4)}for(var Je=0;Je<80;Je++){var Br=A,Ie=V,xt=ie,D=he,$=le,T=fe,u=pe,I=de,ee=L,ge=k,_e=G,Ne=ve,De=ne,Pe=ue,St=Ce,mt=ze;if(m=de,x=ze,F=x&65535,H=x>>>16,B=m&65535,W=m>>>16,m=(le>>>14|ne<<18)^(le>>>18|ne<<14)^(ne>>>9|le<<23),x=(ne>>>14|le<<18)^(ne>>>18|le<<14)^(le>>>9|ne<<23),F+=x&65535,H+=x>>>16,B+=m&65535,W+=m>>>16,m=le&fe^~le&pe,x=ne&ue^~ne&Ce,F+=x&65535,H+=x>>>16,B+=m&65535,W+=m>>>16,m=a[Je*2],x=a[Je*2+1],F+=x&65535,H+=x>>>16,B+=m&65535,W+=m>>>16,m=g[Je%16],x=b[Je%16],F+=x&65535,H+=x>>>16,B+=m&65535,W+=m>>>16,H+=F>>>16,B+=H>>>16,W+=B>>>16,X=B&65535|W<<16,ce=F&65535|H<<16,m=X,x=ce,F=x&65535,H=x>>>16,B=m&65535,W=m>>>16,m=(A>>>28|L<<4)^(L>>>2|A<<30)^(L>>>7|A<<25),x=(L>>>28|A<<4)^(A>>>2|L<<30)^(A>>>7|L<<25),F+=x&65535,H+=x>>>16,B+=m&65535,W+=m>>>16,m=A&V^A&ie^V&ie,x=L&k^L&G^k&G,F+=x&65535,H+=x>>>16,B+=m&65535,W+=m>>>16,H+=F>>>16,B+=H>>>16,W+=B>>>16,I=B&65535|W<<16,mt=F&65535|H<<16,m=D,x=Ne,F=x&65535,H=x>>>16,B=m&65535,W=m>>>16,m=X,x=ce,F+=x&65535,H+=x>>>16,B+=m&65535,W+=m>>>16,H+=F>>>16,B+=H>>>16,W+=B>>>16,D=B&65535|W<<16,Ne=F&65535|H<<16,V=Br,ie=Ie,he=xt,le=D,fe=$,pe=T,de=u,A=I,k=ee,G=ge,ve=_e,ne=Ne,ue=De,Ce=Pe,ze=St,L=mt,Je%16===15)for(var Ke=0;Ke<16;Ke++)m=g[Ke],x=b[Ke],F=x&65535,H=x>>>16,B=m&65535,W=m>>>16,m=g[(Ke+9)%16],x=b[(Ke+9)%16],F+=x&65535,H+=x>>>16,B+=m&65535,W+=m>>>16,X=g[(Ke+1)%16],ce=b[(Ke+1)%16],m=(X>>>1|ce<<31)^(X>>>8|ce<<24)^X>>>7,x=(ce>>>1|X<<31)^(ce>>>8|X<<24)^(ce>>>7|X<<25),F+=x&65535,H+=x>>>16,B+=m&65535,W+=m>>>16,X=g[(Ke+14)%16],ce=b[(Ke+14)%16],m=(X>>>19|ce<<13)^(ce>>>29|X<<3)^X>>>6,x=(ce>>>19|X<<13)^(X>>>29|ce<<3)^(ce>>>6|X<<26),F+=x&65535,H+=x>>>16,B+=m&65535,W+=m>>>16,H+=F>>>16,B+=H>>>16,W+=B>>>16,g[Ke]=B&65535|W<<16,b[Ke]=F&65535|H<<16}m=A,x=L,F=x&65535,H=x>>>16,B=m&65535,W=m>>>16,m=y[0],x=E[0],F+=x&65535,H+=x>>>16,B+=m&65535,W+=m>>>16,H+=F>>>16,B+=H>>>16,W+=B>>>16,y[0]=A=B&65535|W<<16,E[0]=L=F&65535|H<<16,m=V,x=k,F=x&65535,H=x>>>16,B=m&65535,W=m>>>16,m=y[1],x=E[1],F+=x&65535,H+=x>>>16,B+=m&65535,W+=m>>>16,H+=F>>>16,B+=H>>>16,W+=B>>>16,y[1]=V=B&65535|W<<16,E[1]=k=F&65535|H<<16,m=ie,x=G,F=x&65535,H=x>>>16,B=m&65535,W=m>>>16,m=y[2],x=E[2],F+=x&65535,H+=x>>>16,B+=m&65535,W+=m>>>16,H+=F>>>16,B+=H>>>16,W+=B>>>16,y[2]=ie=B&65535|W<<16,E[2]=G=F&65535|H<<16,m=he,x=ve,F=x&65535,H=x>>>16,B=m&65535,W=m>>>16,m=y[3],x=E[3],F+=x&65535,H+=x>>>16,B+=m&65535,W+=m>>>16,H+=F>>>16,B+=H>>>16,W+=B>>>16,y[3]=he=B&65535|W<<16,E[3]=ve=F&65535|H<<16,m=le,x=ne,F=x&65535,H=x>>>16,B=m&65535,W=m>>>16,m=y[4],x=E[4],F+=x&65535,H+=x>>>16,B+=m&65535,W+=m>>>16,H+=F>>>16,B+=H>>>16,W+=B>>>16,y[4]=le=B&65535|W<<16,E[4]=ne=F&65535|H<<16,m=fe,x=ue,F=x&65535,H=x>>>16,B=m&65535,W=m>>>16,m=y[5],x=E[5],F+=x&65535,H+=x>>>16,B+=m&65535,W+=m>>>16,H+=F>>>16,B+=H>>>16,W+=B>>>16,y[5]=fe=B&65535|W<<16,E[5]=ue=F&65535|H<<16,m=pe,x=Ce,F=x&65535,H=x>>>16,B=m&65535,W=m>>>16,m=y[6],x=E[6],F+=x&65535,H+=x>>>16,B+=m&65535,W+=m>>>16,H+=F>>>16,B+=H>>>16,W+=B>>>16,y[6]=pe=B&65535|W<<16,E[6]=Ce=F&65535|H<<16,m=de,x=ze,F=x&65535,H=x>>>16,B=m&65535,W=m>>>16,m=y[7],x=E[7],F+=x&65535,H+=x>>>16,B+=m&65535,W+=m>>>16,H+=F>>>16,B+=H>>>16,W+=B>>>16,y[7]=de=B&65535|W<<16,E[7]=ze=F&65535|H<<16,C+=128,q-=128}return C}function f(g){var b=new n;b.update(g);var y=b.digest();return b.clean(),y}s.hash=f})(Jf);(function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.convertSecretKeyToX25519=s.convertPublicKeyToX25519=s.verify=s.sign=s.extractPublicKeyFromSecretKey=s.generateKeyPair=s.generateKeyPairFromSeed=s.SEED_LENGTH=s.SECRET_KEY_LENGTH=s.PUBLIC_KEY_LENGTH=s.SIGNATURE_LENGTH=void 0;const t=Lo,r=Jf,n=Tf;s.SIGNATURE_LENGTH=64,s.PUBLIC_KEY_LENGTH=32,s.SECRET_KEY_LENGTH=64,s.SEED_LENGTH=32;function a(D){const $=new Float64Array(16);if(D)for(let T=0;T<D.length;T++)$[T]=D[T];return $}const h=new Uint8Array(32);h[0]=9;const f=a(),g=a([1]),b=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),y=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),E=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),O=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),C=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function q(D,$){for(let T=0;T<16;T++)D[T]=$[T]|0}function A(D){let $=1;for(let T=0;T<16;T++){let u=D[T]+$+65535;$=Math.floor(u/65536),D[T]=u-$*65536}D[0]+=$-1+37*($-1)}function V(D,$,T){const u=~(T-1);for(let I=0;I<16;I++){const ee=u&(D[I]^$[I]);D[I]^=ee,$[I]^=ee}}function ie(D,$){const T=a(),u=a();for(let I=0;I<16;I++)u[I]=$[I];A(u),A(u),A(u);for(let I=0;I<2;I++){T[0]=u[0]-65517;for(let ge=1;ge<15;ge++)T[ge]=u[ge]-65535-(T[ge-1]>>16&1),T[ge-1]&=65535;T[15]=u[15]-32767-(T[14]>>16&1);const ee=T[15]>>16&1;T[14]&=65535,V(u,T,1-ee)}for(let I=0;I<16;I++)D[2*I]=u[I]&255,D[2*I+1]=u[I]>>8}function he(D,$){let T=0;for(let u=0;u<32;u++)T|=D[u]^$[u];return(1&T-1>>>8)-1}function le(D,$){const T=new Uint8Array(32),u=new Uint8Array(32);return ie(T,D),ie(u,$),he(T,u)}function fe(D){const $=new Uint8Array(32);return ie($,D),$[0]&1}function pe(D,$){for(let T=0;T<16;T++)D[T]=$[2*T]+($[2*T+1]<<8);D[15]&=32767}function de(D,$,T){for(let u=0;u<16;u++)D[u]=$[u]+T[u]}function L(D,$,T){for(let u=0;u<16;u++)D[u]=$[u]-T[u]}function k(D,$,T){let u,I,ee=0,ge=0,_e=0,Ne=0,De=0,Pe=0,St=0,mt=0,ot=0,Me=0,Ye=0,Xe=0,at=0,ke=0,Ze=0,$e=0,Be=0,ht=0,Ue=0,Pt=0,Lt=0,Kt=0,Bt=0,Ut=0,Qt=0,or=0,Vr=0,Yt=0,Zr=0,mi=0,$i=0,lt=T[0],rt=T[1],ft=T[2],pt=T[3],ct=T[4],it=T[5],Ot=T[6],Rt=T[7],dt=T[8],Tt=T[9],gt=T[10],wt=T[11],yt=T[12],Qe=T[13],At=T[14],Ct=T[15];u=$[0],ee+=u*lt,ge+=u*rt,_e+=u*ft,Ne+=u*pt,De+=u*ct,Pe+=u*it,St+=u*Ot,mt+=u*Rt,ot+=u*dt,Me+=u*Tt,Ye+=u*gt,Xe+=u*wt,at+=u*yt,ke+=u*Qe,Ze+=u*At,$e+=u*Ct,u=$[1],ge+=u*lt,_e+=u*rt,Ne+=u*ft,De+=u*pt,Pe+=u*ct,St+=u*it,mt+=u*Ot,ot+=u*Rt,Me+=u*dt,Ye+=u*Tt,Xe+=u*gt,at+=u*wt,ke+=u*yt,Ze+=u*Qe,$e+=u*At,Be+=u*Ct,u=$[2],_e+=u*lt,Ne+=u*rt,De+=u*ft,Pe+=u*pt,St+=u*ct,mt+=u*it,ot+=u*Ot,Me+=u*Rt,Ye+=u*dt,Xe+=u*Tt,at+=u*gt,ke+=u*wt,Ze+=u*yt,$e+=u*Qe,Be+=u*At,ht+=u*Ct,u=$[3],Ne+=u*lt,De+=u*rt,Pe+=u*ft,St+=u*pt,mt+=u*ct,ot+=u*it,Me+=u*Ot,Ye+=u*Rt,Xe+=u*dt,at+=u*Tt,ke+=u*gt,Ze+=u*wt,$e+=u*yt,Be+=u*Qe,ht+=u*At,Ue+=u*Ct,u=$[4],De+=u*lt,Pe+=u*rt,St+=u*ft,mt+=u*pt,ot+=u*ct,Me+=u*it,Ye+=u*Ot,Xe+=u*Rt,at+=u*dt,ke+=u*Tt,Ze+=u*gt,$e+=u*wt,Be+=u*yt,ht+=u*Qe,Ue+=u*At,Pt+=u*Ct,u=$[5],Pe+=u*lt,St+=u*rt,mt+=u*ft,ot+=u*pt,Me+=u*ct,Ye+=u*it,Xe+=u*Ot,at+=u*Rt,ke+=u*dt,Ze+=u*Tt,$e+=u*gt,Be+=u*wt,ht+=u*yt,Ue+=u*Qe,Pt+=u*At,Lt+=u*Ct,u=$[6],St+=u*lt,mt+=u*rt,ot+=u*ft,Me+=u*pt,Ye+=u*ct,Xe+=u*it,at+=u*Ot,ke+=u*Rt,Ze+=u*dt,$e+=u*Tt,Be+=u*gt,ht+=u*wt,Ue+=u*yt,Pt+=u*Qe,Lt+=u*At,Kt+=u*Ct,u=$[7],mt+=u*lt,ot+=u*rt,Me+=u*ft,Ye+=u*pt,Xe+=u*ct,at+=u*it,ke+=u*Ot,Ze+=u*Rt,$e+=u*dt,Be+=u*Tt,ht+=u*gt,Ue+=u*wt,Pt+=u*yt,Lt+=u*Qe,Kt+=u*At,Bt+=u*Ct,u=$[8],ot+=u*lt,Me+=u*rt,Ye+=u*ft,Xe+=u*pt,at+=u*ct,ke+=u*it,Ze+=u*Ot,$e+=u*Rt,Be+=u*dt,ht+=u*Tt,Ue+=u*gt,Pt+=u*wt,Lt+=u*yt,Kt+=u*Qe,Bt+=u*At,Ut+=u*Ct,u=$[9],Me+=u*lt,Ye+=u*rt,Xe+=u*ft,at+=u*pt,ke+=u*ct,Ze+=u*it,$e+=u*Ot,Be+=u*Rt,ht+=u*dt,Ue+=u*Tt,Pt+=u*gt,Lt+=u*wt,Kt+=u*yt,Bt+=u*Qe,Ut+=u*At,Qt+=u*Ct,u=$[10],Ye+=u*lt,Xe+=u*rt,at+=u*ft,ke+=u*pt,Ze+=u*ct,$e+=u*it,Be+=u*Ot,ht+=u*Rt,Ue+=u*dt,Pt+=u*Tt,Lt+=u*gt,Kt+=u*wt,Bt+=u*yt,Ut+=u*Qe,Qt+=u*At,or+=u*Ct,u=$[11],Xe+=u*lt,at+=u*rt,ke+=u*ft,Ze+=u*pt,$e+=u*ct,Be+=u*it,ht+=u*Ot,Ue+=u*Rt,Pt+=u*dt,Lt+=u*Tt,Kt+=u*gt,Bt+=u*wt,Ut+=u*yt,Qt+=u*Qe,or+=u*At,Vr+=u*Ct,u=$[12],at+=u*lt,ke+=u*rt,Ze+=u*ft,$e+=u*pt,Be+=u*ct,ht+=u*it,Ue+=u*Ot,Pt+=u*Rt,Lt+=u*dt,Kt+=u*Tt,Bt+=u*gt,Ut+=u*wt,Qt+=u*yt,or+=u*Qe,Vr+=u*At,Yt+=u*Ct,u=$[13],ke+=u*lt,Ze+=u*rt,$e+=u*ft,Be+=u*pt,ht+=u*ct,Ue+=u*it,Pt+=u*Ot,Lt+=u*Rt,Kt+=u*dt,Bt+=u*Tt,Ut+=u*gt,Qt+=u*wt,or+=u*yt,Vr+=u*Qe,Yt+=u*At,Zr+=u*Ct,u=$[14],Ze+=u*lt,$e+=u*rt,Be+=u*ft,ht+=u*pt,Ue+=u*ct,Pt+=u*it,Lt+=u*Ot,Kt+=u*Rt,Bt+=u*dt,Ut+=u*Tt,Qt+=u*gt,or+=u*wt,Vr+=u*yt,Yt+=u*Qe,Zr+=u*At,mi+=u*Ct,u=$[15],$e+=u*lt,Be+=u*rt,ht+=u*ft,Ue+=u*pt,Pt+=u*ct,Lt+=u*it,Kt+=u*Ot,Bt+=u*Rt,Ut+=u*dt,Qt+=u*Tt,or+=u*gt,Vr+=u*wt,Yt+=u*yt,Zr+=u*Qe,mi+=u*At,$i+=u*Ct,ee+=38*Be,ge+=38*ht,_e+=38*Ue,Ne+=38*Pt,De+=38*Lt,Pe+=38*Kt,St+=38*Bt,mt+=38*Ut,ot+=38*Qt,Me+=38*or,Ye+=38*Vr,Xe+=38*Yt,at+=38*Zr,ke+=38*mi,Ze+=38*$i,I=1,u=ee+I+65535,I=Math.floor(u/65536),ee=u-I*65536,u=ge+I+65535,I=Math.floor(u/65536),ge=u-I*65536,u=_e+I+65535,I=Math.floor(u/65536),_e=u-I*65536,u=Ne+I+65535,I=Math.floor(u/65536),Ne=u-I*65536,u=De+I+65535,I=Math.floor(u/65536),De=u-I*65536,u=Pe+I+65535,I=Math.floor(u/65536),Pe=u-I*65536,u=St+I+65535,I=Math.floor(u/65536),St=u-I*65536,u=mt+I+65535,I=Math.floor(u/65536),mt=u-I*65536,u=ot+I+65535,I=Math.floor(u/65536),ot=u-I*65536,u=Me+I+65535,I=Math.floor(u/65536),Me=u-I*65536,u=Ye+I+65535,I=Math.floor(u/65536),Ye=u-I*65536,u=Xe+I+65535,I=Math.floor(u/65536),Xe=u-I*65536,u=at+I+65535,I=Math.floor(u/65536),at=u-I*65536,u=ke+I+65535,I=Math.floor(u/65536),ke=u-I*65536,u=Ze+I+65535,I=Math.floor(u/65536),Ze=u-I*65536,u=$e+I+65535,I=Math.floor(u/65536),$e=u-I*65536,ee+=I-1+37*(I-1),I=1,u=ee+I+65535,I=Math.floor(u/65536),ee=u-I*65536,u=ge+I+65535,I=Math.floor(u/65536),ge=u-I*65536,u=_e+I+65535,I=Math.floor(u/65536),_e=u-I*65536,u=Ne+I+65535,I=Math.floor(u/65536),Ne=u-I*65536,u=De+I+65535,I=Math.floor(u/65536),De=u-I*65536,u=Pe+I+65535,I=Math.floor(u/65536),Pe=u-I*65536,u=St+I+65535,I=Math.floor(u/65536),St=u-I*65536,u=mt+I+65535,I=Math.floor(u/65536),mt=u-I*65536,u=ot+I+65535,I=Math.floor(u/65536),ot=u-I*65536,u=Me+I+65535,I=Math.floor(u/65536),Me=u-I*65536,u=Ye+I+65535,I=Math.floor(u/65536),Ye=u-I*65536,u=Xe+I+65535,I=Math.floor(u/65536),Xe=u-I*65536,u=at+I+65535,I=Math.floor(u/65536),at=u-I*65536,u=ke+I+65535,I=Math.floor(u/65536),ke=u-I*65536,u=Ze+I+65535,I=Math.floor(u/65536),Ze=u-I*65536,u=$e+I+65535,I=Math.floor(u/65536),$e=u-I*65536,ee+=I-1+37*(I-1),D[0]=ee,D[1]=ge,D[2]=_e,D[3]=Ne,D[4]=De,D[5]=Pe,D[6]=St,D[7]=mt,D[8]=ot,D[9]=Me,D[10]=Ye,D[11]=Xe,D[12]=at,D[13]=ke,D[14]=Ze,D[15]=$e}function G(D,$){k(D,$,$)}function ve(D,$){const T=a();let u;for(u=0;u<16;u++)T[u]=$[u];for(u=253;u>=0;u--)G(T,T),u!==2&&u!==4&&k(T,T,$);for(u=0;u<16;u++)D[u]=T[u]}function ne(D,$){const T=a();let u;for(u=0;u<16;u++)T[u]=$[u];for(u=250;u>=0;u--)G(T,T),u!==1&&k(T,T,$);for(u=0;u<16;u++)D[u]=T[u]}function ue(D,$){const T=a(),u=a(),I=a(),ee=a(),ge=a(),_e=a(),Ne=a(),De=a(),Pe=a();L(T,D[1],D[0]),L(Pe,$[1],$[0]),k(T,T,Pe),de(u,D[0],D[1]),de(Pe,$[0],$[1]),k(u,u,Pe),k(I,D[3],$[3]),k(I,I,y),k(ee,D[2],$[2]),de(ee,ee,ee),L(ge,u,T),L(_e,ee,I),de(Ne,ee,I),de(De,u,T),k(D[0],ge,_e),k(D[1],De,Ne),k(D[2],Ne,_e),k(D[3],ge,De)}function Ce(D,$,T){for(let u=0;u<4;u++)V(D[u],$[u],T)}function ze(D,$){const T=a(),u=a(),I=a();ve(I,$[2]),k(T,$[0],I),k(u,$[1],I),ie(D,u),D[31]^=fe(T)<<7}function m(D,$,T){q(D[0],f),q(D[1],g),q(D[2],g),q(D[3],f);for(let u=255;u>=0;--u){const I=T[u/8|0]>>(u&7)&1;Ce(D,$,I),ue($,D),ue(D,D),Ce(D,$,I)}}function x(D,$){const T=[a(),a(),a(),a()];q(T[0],E),q(T[1],O),q(T[2],g),k(T[3],E,O),m(D,T,$)}function X(D){if(D.length!==s.SEED_LENGTH)throw new Error(`ed25519: seed must be ${s.SEED_LENGTH} bytes`);const $=(0,r.hash)(D);$[0]&=248,$[31]&=127,$[31]|=64;const T=new Uint8Array(32),u=[a(),a(),a(),a()];x(u,$),ze(T,u);const I=new Uint8Array(64);return I.set(D),I.set(T,32),{publicKey:T,secretKey:I}}s.generateKeyPairFromSeed=X;function ce(D){const $=(0,t.randomBytes)(32,D),T=X($);return(0,n.wipe)($),T}s.generateKeyPair=ce;function F(D){if(D.length!==s.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${s.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(D.subarray(32))}s.extractPublicKeyFromSecretKey=F;const H=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function B(D,$){let T,u,I,ee;for(u=63;u>=32;--u){for(T=0,I=u-32,ee=u-12;I<ee;++I)$[I]+=T-16*$[u]*H[I-(u-32)],T=Math.floor(($[I]+128)/256),$[I]-=T*256;$[I]+=T,$[u]=0}for(T=0,I=0;I<32;I++)$[I]+=T-($[31]>>4)*H[I],T=$[I]>>8,$[I]&=255;for(I=0;I<32;I++)$[I]-=T*H[I];for(u=0;u<32;u++)$[u+1]+=$[u]>>8,D[u]=$[u]&255}function W(D){const $=new Float64Array(64);for(let T=0;T<64;T++)$[T]=D[T];for(let T=0;T<64;T++)D[T]=0;B(D,$)}function Je(D,$){const T=new Float64Array(64),u=[a(),a(),a(),a()],I=(0,r.hash)(D.subarray(0,32));I[0]&=248,I[31]&=127,I[31]|=64;const ee=new Uint8Array(64);ee.set(I.subarray(32),32);const ge=new r.SHA512;ge.update(ee.subarray(32)),ge.update($);const _e=ge.digest();ge.clean(),W(_e),x(u,_e),ze(ee,u),ge.reset(),ge.update(ee.subarray(0,32)),ge.update(D.subarray(32)),ge.update($);const Ne=ge.digest();W(Ne);for(let De=0;De<32;De++)T[De]=_e[De];for(let De=0;De<32;De++)for(let Pe=0;Pe<32;Pe++)T[De+Pe]+=Ne[De]*I[Pe];return B(ee.subarray(32),T),ee}s.sign=Je;function Ke(D,$){const T=a(),u=a(),I=a(),ee=a(),ge=a(),_e=a(),Ne=a();return q(D[2],g),pe(D[1],$),G(I,D[1]),k(ee,I,b),L(I,I,D[2]),de(ee,D[2],ee),G(ge,ee),G(_e,ge),k(Ne,_e,ge),k(T,Ne,I),k(T,T,ee),ne(T,T),k(T,T,I),k(T,T,ee),k(T,T,ee),k(D[0],T,ee),G(u,D[0]),k(u,u,ee),le(u,I)&&k(D[0],D[0],C),G(u,D[0]),k(u,u,ee),le(u,I)?-1:(fe(D[0])===$[31]>>7&&L(D[0],f,D[0]),k(D[3],D[0],D[1]),0)}function Br(D,$,T){const u=new Uint8Array(32),I=[a(),a(),a(),a()],ee=[a(),a(),a(),a()];if(T.length!==s.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${s.SIGNATURE_LENGTH} bytes`);if(Ke(ee,D))return!1;const ge=new r.SHA512;ge.update(T.subarray(0,32)),ge.update(D),ge.update($);const _e=ge.digest();return W(_e),m(I,ee,_e),x(ee,T.subarray(32)),ue(I,ee),ze(u,I),!he(T,u)}s.verify=Br;function Ie(D){let $=[a(),a(),a(),a()];if(Ke($,D))throw new Error("Ed25519: invalid public key");let T=a(),u=a(),I=$[1];de(T,g,I),L(u,g,I),ve(u,u),k(T,T,u);let ee=new Uint8Array(32);return ie(ee,T),ee}s.convertPublicKeyToX25519=Ie;function xt(D){const $=(0,r.hash)(D.subarray(0,32));$[0]&=248,$[31]&=127,$[31]|=64;const T=new Uint8Array($.subarray(0,32));return(0,n.wipe)($),T}s.convertSecretKeyToX25519=xt})(Jc);const Q_="EdDSA",Y_="JWT",Qf=".",Yf="base64url",X_="utf8",Z_="utf8",e1=":",t1="did",r1="key",Ml="base58btc",i1="z",n1="K36",s1=32;function No(s){return sr(gr(Qi(s),X_),Yf)}function Xf(s){const t=gr(n1,Ml),r=i1+sr(Rc([t,s]),Ml);return[t1,r1,r].join(e1)}function o1(s){return sr(s,Yf)}function a1(s){return gr([No(s.header),No(s.payload)].join(Qf),Z_)}function c1(s){return[No(s.header),No(s.payload),o1(s.signature)].join(Qf)}function jl(s=Lo.randomBytes(s1)){return Jc.generateKeyPairFromSeed(s)}async function u1(s,t,r,n,a=re.fromMiliseconds(Date.now())){const h={alg:Q_,typ:Y_},f=Xf(n.publicKey),g=a+r,b={iss:f,sub:s,aud:t,iat:a,exp:g},y=a1({header:h,payload:b}),E=Jc.sign(n.secretKey,y);return c1({header:h,payload:b,signature:E})}const h1="PARSE_ERROR",l1="INVALID_REQUEST",f1="METHOD_NOT_FOUND",p1="INVALID_PARAMS",Zf="INTERNAL_ERROR",Qc="SERVER_ERROR",d1=[-32700,-32600,-32601,-32602,-32603],as={[h1]:{code:-32700,message:"Parse error"},[l1]:{code:-32600,message:"Invalid Request"},[f1]:{code:-32601,message:"Method not found"},[p1]:{code:-32602,message:"Invalid params"},[Zf]:{code:-32603,message:"Internal error"},[Qc]:{code:-32e3,message:"Server error"}},ep=Qc;function g1(s){return d1.includes(s)}function Ul(s){return Object.keys(as).includes(s)?as[s]:as[ep]}function y1(s){const t=Object.values(as).find(r=>r.code===s);return t||as[ep]}function tp(s,t,r){return s.message.includes("getaddrinfo ENOTFOUND")||s.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):s}var rp={},li={},ql;function v1(){if(ql)return li;ql=1,Object.defineProperty(li,"__esModule",{value:!0}),li.isBrowserCryptoAvailable=li.getSubtleCrypto=li.getBrowerCrypto=void 0;function s(){return(Kr===null||Kr===void 0?void 0:Kr.crypto)||(Kr===null||Kr===void 0?void 0:Kr.msCrypto)||{}}li.getBrowerCrypto=s;function t(){const n=s();return n.subtle||n.webkitSubtle}li.getSubtleCrypto=t;function r(){return!!s()&&!!t()}return li.isBrowserCryptoAvailable=r,li}var fi={},zl;function m1(){if(zl)return fi;zl=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.isBrowser=fi.isNode=fi.isReactNative=void 0;function s(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}fi.isReactNative=s;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}fi.isNode=t;function r(){return!s()&&!t()}return fi.isBrowser=r,fi}(function(s){Object.defineProperty(s,"__esModule",{value:!0});const t=On;t.__exportStar(v1(),s),t.__exportStar(m1(),s)})(rp);function Yc(s=3){const t=Date.now()*Math.pow(10,s),r=Math.floor(Math.random()*Math.pow(10,s));return t+r}function ip(s=6){return BigInt(Yc(s))}function Pn(s,t,r){return{id:r||Yc(),jsonrpc:"2.0",method:s,params:t}}function Xc(s,t){return{id:s,jsonrpc:"2.0",result:t}}function Mo(s,t,r){return{id:s,jsonrpc:"2.0",error:w1(t,r)}}function w1(s,t){return typeof s>"u"?Ul(Zf):(typeof s=="string"&&(s=Object.assign(Object.assign({},Ul(Qc)),{message:s})),typeof t<"u"&&(s.data=t),g1(s.code)&&(s=y1(s.code)),s)}class b1{}class _1 extends b1{constructor(){super()}}class E1 extends _1{constructor(t){super()}}const I1="^https?:",x1="^wss?:";function S1(s){const t=s.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function np(s,t){const r=S1(s);return typeof r>"u"?!1:new RegExp(t).test(r)}function kl(s){return np(s,I1)}function Hl(s){return np(s,x1)}function P1(s){return new RegExp("wss?://localhost(:d{2,5})?").test(s)}function sp(s){return typeof s=="object"&&"id"in s&&"jsonrpc"in s&&s.jsonrpc==="2.0"}function Zc(s){return sp(s)&&"method"in s}function jo(s){return sp(s)&&(gi(s)||Hr(s))}function gi(s){return"result"in s}function Hr(s){return"error"in s}class yi extends E1{constructor(t){super(t),this.events=new $r.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(Pn(t.method,t.params||[],t.id||ip().toString()),r)}async requestStrict(t,r){return new Promise(async(n,a)=>{if(!this.connection.connected)try{await this.open()}catch(h){a(h)}this.events.on(`${t.id}`,h=>{Hr(h)?a(h.error):n(h.result)});try{await this.connection.send(t,r)}catch(h){a(h)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),jo(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const O1=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),R1=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Kl=s=>s.split("?")[0],Bl=10,T1=O1();let A1=class{constructor(t){if(this.url=t,this.events=new $r.EventEmitter,this.registering=!1,!Hl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Qi(t))}catch(r){this.onError(t.id,r)}}register(t=this.url){if(!Hl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,a)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),a(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return a(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,n)=>{const a=new URLSearchParams(t).get("origin"),h=rp.isReactNative()?{headers:{origin:a}}:{rejectUnauthorized:!P1(t)},f=new T1(t,[],h);R1()?f.onerror=g=>{const b=g;n(this.emitError(b.error))}:f.on("error",g=>{n(this.emitError(g))}),f.onopen=()=>{this.onOpen(f),r(f)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?fs(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const n=this.parseError(r),a=n.message||n.toString(),h=Mo(t,a);this.events.emit("payload",h)}parseError(t,r=this.url){return tp(t,Kl(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Bl&&this.events.setMaxListeners(Bl)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${Kl(this.url)}`));return this.events.emit("register_error",r),r}};var $o={exports:{}};$o.exports;(function(s,t){var r=200,n="__lodash_hash_undefined__",a=1,h=2,f=9007199254740991,g="[object Arguments]",b="[object Array]",y="[object AsyncFunction]",E="[object Boolean]",O="[object Date]",C="[object Error]",q="[object Function]",A="[object GeneratorFunction]",V="[object Map]",ie="[object Number]",he="[object Null]",le="[object Object]",fe="[object Promise]",pe="[object Proxy]",de="[object RegExp]",L="[object Set]",k="[object String]",G="[object Symbol]",ve="[object Undefined]",ne="[object WeakMap]",ue="[object ArrayBuffer]",Ce="[object DataView]",ze="[object Float32Array]",m="[object Float64Array]",x="[object Int8Array]",X="[object Int16Array]",ce="[object Int32Array]",F="[object Uint8Array]",H="[object Uint8ClampedArray]",B="[object Uint16Array]",W="[object Uint32Array]",Je=/[\\^$.*+?()[\]{}|]/g,Ke=/^\[object .+?Constructor\]$/,Br=/^(?:0|[1-9]\d*)$/,Ie={};Ie[ze]=Ie[m]=Ie[x]=Ie[X]=Ie[ce]=Ie[F]=Ie[H]=Ie[B]=Ie[W]=!0,Ie[g]=Ie[b]=Ie[ue]=Ie[E]=Ie[Ce]=Ie[O]=Ie[C]=Ie[q]=Ie[V]=Ie[ie]=Ie[le]=Ie[de]=Ie[L]=Ie[k]=Ie[ne]=!1;var xt=typeof Kr=="object"&&Kr&&Kr.Object===Object&&Kr,D=typeof self=="object"&&self&&self.Object===Object&&self,$=xt||D||Function("return this")(),T=t&&!t.nodeType&&t,u=T&&!0&&s&&!s.nodeType&&s,I=u&&u.exports===T,ee=I&&xt.process,ge=function(){try{return ee&&ee.binding&&ee.binding("util")}catch{}}(),_e=ge&&ge.isTypedArray;function Ne(v,S){for(var z=-1,Y=v==null?0:v.length,Fe=0,me=[];++z<Y;){var et=v[z];S(et,z,v)&&(me[Fe++]=et)}return me}function De(v,S){for(var z=-1,Y=S.length,Fe=v.length;++z<Y;)v[Fe+z]=S[z];return v}function Pe(v,S){for(var z=-1,Y=v==null?0:v.length;++z<Y;)if(S(v[z],z,v))return!0;return!1}function St(v,S){for(var z=-1,Y=Array(v);++z<v;)Y[z]=S(z);return Y}function mt(v){return function(S){return v(S)}}function ot(v,S){return v.has(S)}function Me(v,S){return v==null?void 0:v[S]}function Ye(v){var S=-1,z=Array(v.size);return v.forEach(function(Y,Fe){z[++S]=[Fe,Y]}),z}function Xe(v,S){return function(z){return v(S(z))}}function at(v){var S=-1,z=Array(v.size);return v.forEach(function(Y){z[++S]=Y}),z}var ke=Array.prototype,Ze=Function.prototype,$e=Object.prototype,Be=$["__core-js_shared__"],ht=Ze.toString,Ue=$e.hasOwnProperty,Pt=function(){var v=/[^.]+$/.exec(Be&&Be.keys&&Be.keys.IE_PROTO||"");return v?"Symbol(src)_1."+v:""}(),Lt=$e.toString,Kt=RegExp("^"+ht.call(Ue).replace(Je,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Bt=I?$.Buffer:void 0,Ut=$.Symbol,Qt=$.Uint8Array,or=$e.propertyIsEnumerable,Vr=ke.splice,Yt=Ut?Ut.toStringTag:void 0,Zr=Object.getOwnPropertySymbols,mi=Bt?Bt.isBuffer:void 0,$i=Xe(Object.keys,Object),lt=yr($,"DataView"),rt=yr($,"Map"),ft=yr($,"Promise"),pt=yr($,"Set"),ct=yr($,"WeakMap"),it=yr(Object,"create"),Ot=ti(lt),Rt=ti(rt),dt=ti(ft),Tt=ti(pt),gt=ti(ct),wt=Ut?Ut.prototype:void 0,yt=wt?wt.valueOf:void 0;function Qe(v){var S=-1,z=v==null?0:v.length;for(this.clear();++S<z;){var Y=v[S];this.set(Y[0],Y[1])}}function At(){this.__data__=it?it(null):{},this.size=0}function Ct(v){var S=this.has(v)&&delete this.__data__[v];return this.size-=S?1:0,S}function zo(v){var S=this.__data__;if(it){var z=S[v];return z===n?void 0:z}return Ue.call(S,v)?S[v]:void 0}function ko(v){var S=this.__data__;return it?S[v]!==void 0:Ue.call(S,v)}function Ho(v,S){var z=this.__data__;return this.size+=this.has(v)?0:1,z[v]=it&&S===void 0?n:S,this}Qe.prototype.clear=At,Qe.prototype.delete=Ct,Qe.prototype.get=zo,Qe.prototype.has=ko,Qe.prototype.set=Ho;function Ir(v){var S=-1,z=v==null?0:v.length;for(this.clear();++S<z;){var Y=v[S];this.set(Y[0],Y[1])}}function Ko(){this.__data__=[],this.size=0}function Bo(v){var S=this.__data__,z=Di(S,v);if(z<0)return!1;var Y=S.length-1;return z==Y?S.pop():Vr.call(S,z,1),--this.size,!0}function Vo(v){var S=this.__data__,z=Di(S,v);return z<0?void 0:S[z][1]}function Fo(v){return Di(this.__data__,v)>-1}function Wo(v,S){var z=this.__data__,Y=Di(z,v);return Y<0?(++this.size,z.push([v,S])):z[Y][1]=S,this}Ir.prototype.clear=Ko,Ir.prototype.delete=Bo,Ir.prototype.get=Vo,Ir.prototype.has=Fo,Ir.prototype.set=Wo;function ei(v){var S=-1,z=v==null?0:v.length;for(this.clear();++S<z;){var Y=v[S];this.set(Y[0],Y[1])}}function tn(){this.size=0,this.__data__={hash:new Qe,map:new(rt||Ir),string:new Qe}}function Go(v){var S=wi(this,v).delete(v);return this.size-=S?1:0,S}function rn(v){return wi(this,v).get(v)}function Jo(v){return wi(this,v).has(v)}function Qo(v,S){var z=wi(this,v),Y=z.size;return z.set(v,S),this.size+=z.size==Y?0:1,this}ei.prototype.clear=tn,ei.prototype.delete=Go,ei.prototype.get=rn,ei.prototype.has=Jo,ei.prototype.set=Qo;function nn(v){var S=-1,z=v==null?0:v.length;for(this.__data__=new ei;++S<z;)this.add(v[S])}function ds(v){return this.__data__.set(v,n),this}function gs(v){return this.__data__.has(v)}nn.prototype.add=nn.prototype.push=ds,nn.prototype.has=gs;function Dr(v){var S=this.__data__=new Ir(v);this.size=S.size}function Yo(){this.__data__=new Ir,this.size=0}function Xo(v){var S=this.__data__,z=S.delete(v);return this.size=S.size,z}function Zo(v){return this.__data__.get(v)}function ea(v){return this.__data__.has(v)}function ys(v,S){var z=this.__data__;if(z instanceof Ir){var Y=z.__data__;if(!rt||Y.length<r-1)return Y.push([v,S]),this.size=++z.size,this;z=this.__data__=new ei(Y)}return z.set(v,S),this.size=z.size,this}Dr.prototype.clear=Yo,Dr.prototype.delete=Xo,Dr.prototype.get=Zo,Dr.prototype.has=ea,Dr.prototype.set=ys;function vs(v,S){var z=an(v),Y=!z&&Ts(v),Fe=!z&&!Y&&Dn(v),me=!z&&!Y&&!Fe&&Ns(v),et=z||Y||Fe||me,Nt=et?St(v.length,String):[],Re=Nt.length;for(var We in v)(S||Ue.call(v,We))&&!(et&&(We=="length"||Fe&&(We=="offset"||We=="parent")||me&&(We=="buffer"||We=="byteLength"||We=="byteOffset")||xs(We,Re)))&&Nt.push(We);return Nt}function Di(v,S){for(var z=v.length;z--;)if(Rs(v[z][0],S))return z;return-1}function Nn(v,S,z){var Y=S(v);return an(v)?Y:De(Y,z(v))}function Li(v){return v==null?v===void 0?ve:he:Yt&&Yt in Object(v)?Es(v):ia(v)}function $n(v){return ji(v)&&Li(v)==g}function Mi(v,S,z,Y,Fe){return v===S?!0:v==null||S==null||!ji(v)&&!ji(S)?v!==v&&S!==S:ms(v,S,z,Y,Mi,Fe)}function ms(v,S,z,Y,Fe,me){var et=an(v),Nt=an(S),Re=et?b:Fr(v),We=Nt?b:Fr(S);Re=Re==g?le:Re,We=We==g?le:We;var bt=Re==le,ar=We==le,$t=Re==We;if($t&&Dn(v)){if(!Dn(S))return!1;et=!0,bt=!1}if($t&&!bt)return me||(me=new Dr),et||Ns(v)?sn(v,S,z,Y,Fe,me):ra(v,S,Re,z,Y,Fe,me);if(!(z&a)){var tt=bt&&Ue.call(v,"__wrapped__"),Xt=ar&&Ue.call(S,"__wrapped__");if(tt||Xt){var Lr=tt?v.value():v,xr=Xt?S.value():S;return me||(me=new Dr),Fe(Lr,xr,z,Y,me)}}return $t?(me||(me=new Dr),_s(v,S,z,Y,Fe,me)):!1}function ta(v){if(!Cs(v)||Ps(v))return!1;var S=cn(v)?Kt:Ke;return S.test(ti(v))}function ws(v){return ji(v)&&As(v.length)&&!!Ie[Li(v)]}function bs(v){if(!Os(v))return $i(v);var S=[];for(var z in Object(v))Ue.call(v,z)&&z!="constructor"&&S.push(z);return S}function sn(v,S,z,Y,Fe,me){var et=z&a,Nt=v.length,Re=S.length;if(Nt!=Re&&!(et&&Re>Nt))return!1;var We=me.get(v);if(We&&me.get(S))return We==S;var bt=-1,ar=!0,$t=z&h?new nn:void 0;for(me.set(v,S),me.set(S,v);++bt<Nt;){var tt=v[bt],Xt=S[bt];if(Y)var Lr=et?Y(Xt,tt,bt,S,v,me):Y(tt,Xt,bt,v,S,me);if(Lr!==void 0){if(Lr)continue;ar=!1;break}if($t){if(!Pe(S,function(xr,Wr){if(!ot($t,Wr)&&(tt===xr||Fe(tt,xr,z,Y,me)))return $t.push(Wr)})){ar=!1;break}}else if(!(tt===Xt||Fe(tt,Xt,z,Y,me))){ar=!1;break}}return me.delete(v),me.delete(S),ar}function ra(v,S,z,Y,Fe,me,et){switch(z){case Ce:if(v.byteLength!=S.byteLength||v.byteOffset!=S.byteOffset)return!1;v=v.buffer,S=S.buffer;case ue:return!(v.byteLength!=S.byteLength||!me(new Qt(v),new Qt(S)));case E:case O:case ie:return Rs(+v,+S);case C:return v.name==S.name&&v.message==S.message;case de:case k:return v==S+"";case V:var Nt=Ye;case L:var Re=Y&a;if(Nt||(Nt=at),v.size!=S.size&&!Re)return!1;var We=et.get(v);if(We)return We==S;Y|=h,et.set(v,S);var bt=sn(Nt(v),Nt(S),Y,Fe,me,et);return et.delete(v),bt;case G:if(yt)return yt.call(v)==yt.call(S)}return!1}function _s(v,S,z,Y,Fe,me){var et=z&a,Nt=on(v),Re=Nt.length,We=on(S),bt=We.length;if(Re!=bt&&!et)return!1;for(var ar=Re;ar--;){var $t=Nt[ar];if(!(et?$t in S:Ue.call(S,$t)))return!1}var tt=me.get(v);if(tt&&me.get(S))return tt==S;var Xt=!0;me.set(v,S),me.set(S,v);for(var Lr=et;++ar<Re;){$t=Nt[ar];var xr=v[$t],Wr=S[$t];if(Y)var Ln=et?Y(Wr,xr,$t,S,v,me):Y(xr,Wr,$t,v,S,me);if(!(Ln===void 0?xr===Wr||Fe(xr,Wr,z,Y,me):Ln)){Xt=!1;break}Lr||(Lr=$t=="constructor")}if(Xt&&!Lr){var Ui=v.constructor,qt=S.constructor;Ui!=qt&&"constructor"in v&&"constructor"in S&&!(typeof Ui=="function"&&Ui instanceof Ui&&typeof qt=="function"&&qt instanceof qt)&&(Xt=!1)}return me.delete(v),me.delete(S),Xt}function on(v){return Nn(v,oa,Is)}function wi(v,S){var z=v.__data__;return Ss(S)?z[typeof S=="string"?"string":"hash"]:z.map}function yr(v,S){var z=Me(v,S);return ta(z)?z:void 0}function Es(v){var S=Ue.call(v,Yt),z=v[Yt];try{v[Yt]=void 0;var Y=!0}catch{}var Fe=Lt.call(v);return Y&&(S?v[Yt]=z:delete v[Yt]),Fe}var Is=Zr?function(v){return v==null?[]:(v=Object(v),Ne(Zr(v),function(S){return or.call(v,S)}))}:Ve,Fr=Li;(lt&&Fr(new lt(new ArrayBuffer(1)))!=Ce||rt&&Fr(new rt)!=V||ft&&Fr(ft.resolve())!=fe||pt&&Fr(new pt)!=L||ct&&Fr(new ct)!=ne)&&(Fr=function(v){var S=Li(v),z=S==le?v.constructor:void 0,Y=z?ti(z):"";if(Y)switch(Y){case Ot:return Ce;case Rt:return V;case dt:return fe;case Tt:return L;case gt:return ne}return S});function xs(v,S){return S=S??f,!!S&&(typeof v=="number"||Br.test(v))&&v>-1&&v%1==0&&v<S}function Ss(v){var S=typeof v;return S=="string"||S=="number"||S=="symbol"||S=="boolean"?v!=="__proto__":v===null}function Ps(v){return!!Pt&&Pt in v}function Os(v){var S=v&&v.constructor,z=typeof S=="function"&&S.prototype||$e;return v===z}function ia(v){return Lt.call(v)}function ti(v){if(v!=null){try{return ht.call(v)}catch{}try{return v+""}catch{}}return""}function Rs(v,S){return v===S||v!==v&&S!==S}var Ts=$n(function(){return arguments}())?$n:function(v){return ji(v)&&Ue.call(v,"callee")&&!or.call(v,"callee")},an=Array.isArray;function na(v){return v!=null&&As(v.length)&&!cn(v)}var Dn=mi||He;function sa(v,S){return Mi(v,S)}function cn(v){if(!Cs(v))return!1;var S=Li(v);return S==q||S==A||S==y||S==pe}function As(v){return typeof v=="number"&&v>-1&&v%1==0&&v<=f}function Cs(v){var S=typeof v;return v!=null&&(S=="object"||S=="function")}function ji(v){return v!=null&&typeof v=="object"}var Ns=_e?mt(_e):ws;function oa(v){return na(v)?vs(v):bs(v)}function Ve(){return[]}function He(){return!1}s.exports=sa})($o,$o.exports);var C1=$o.exports;const N1=Af(C1);var $1={};function D1(s,t){if(s.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var a=0;a<s.length;a++){var h=s.charAt(a),f=h.charCodeAt(0);if(r[f]!==255)throw new TypeError(h+" is ambiguous");r[f]=a}var g=s.length,b=s.charAt(0),y=Math.log(g)/Math.log(256),E=Math.log(256)/Math.log(g);function O(A){if(A instanceof Uint8Array||(ArrayBuffer.isView(A)?A=new Uint8Array(A.buffer,A.byteOffset,A.byteLength):Array.isArray(A)&&(A=Uint8Array.from(A))),!(A instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(A.length===0)return"";for(var V=0,ie=0,he=0,le=A.length;he!==le&&A[he]===0;)he++,V++;for(var fe=(le-he)*E+1>>>0,pe=new Uint8Array(fe);he!==le;){for(var de=A[he],L=0,k=fe-1;(de!==0||L<ie)&&k!==-1;k--,L++)de+=256*pe[k]>>>0,pe[k]=de%g>>>0,de=de/g>>>0;if(de!==0)throw new Error("Non-zero carry");ie=L,he++}for(var G=fe-ie;G!==fe&&pe[G]===0;)G++;for(var ve=b.repeat(V);G<fe;++G)ve+=s.charAt(pe[G]);return ve}function C(A){if(typeof A!="string")throw new TypeError("Expected String");if(A.length===0)return new Uint8Array;var V=0;if(A[V]!==" "){for(var ie=0,he=0;A[V]===b;)ie++,V++;for(var le=(A.length-V)*y+1>>>0,fe=new Uint8Array(le);A[V];){var pe=r[A.charCodeAt(V)];if(pe===255)return;for(var de=0,L=le-1;(pe!==0||de<he)&&L!==-1;L--,de++)pe+=g*fe[L]>>>0,fe[L]=pe%256>>>0,pe=pe/256>>>0;if(pe!==0)throw new Error("Non-zero carry");he=de,V++}if(A[V]!==" "){for(var k=le-he;k!==le&&fe[k]===0;)k++;for(var G=new Uint8Array(ie+(le-k)),ve=ie;k!==le;)G[ve++]=fe[k++];return G}}}function q(A){var V=C(A);if(V)return V;throw new Error(`Non-${t} character`)}return{encode:O,decodeUnsafe:C,decode:q}}var L1=D1,M1=L1;const op=s=>{if(s instanceof Uint8Array&&s.constructor.name==="Uint8Array")return s;if(s instanceof ArrayBuffer)return new Uint8Array(s);if(ArrayBuffer.isView(s))return new Uint8Array(s.buffer,s.byteOffset,s.byteLength);throw new Error("Unknown type, must be binary type")},j1=s=>new TextEncoder().encode(s),U1=s=>new TextDecoder().decode(s);class q1{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class z1{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return ap(this,t)}}let k1=class{constructor(t){this.decoders=t}or(t){return ap(this,t)}decode(t){const r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const ap=(s,t)=>new k1({...s.decoders||{[s.prefix]:s},...t.decoders||{[t.prefix]:t}});class H1{constructor(t,r,n,a){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=a,this.encoder=new q1(t,r,n),this.decoder=new z1(t,r,a)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Uo=({name:s,prefix:t,encode:r,decode:n})=>new H1(s,t,r,n),ps=({prefix:s,name:t,alphabet:r})=>{const{encode:n,decode:a}=M1(r,t);return Uo({prefix:s,name:t,encode:n,decode:h=>op(a(h))})},K1=(s,t,r,n)=>{const a={};for(let E=0;E<t.length;++E)a[t[E]]=E;let h=s.length;for(;s[h-1]==="=";)--h;const f=new Uint8Array(h*r/8|0);let g=0,b=0,y=0;for(let E=0;E<h;++E){const O=a[s[E]];if(O===void 0)throw new SyntaxError(`Non-${n} character`);b=b<<r|O,g+=r,g>=8&&(g-=8,f[y++]=255&b>>g)}if(g>=r||255&b<<8-g)throw new SyntaxError("Unexpected end of data");return f},B1=(s,t,r)=>{const n=t[t.length-1]==="=",a=(1<<r)-1;let h="",f=0,g=0;for(let b=0;b<s.length;++b)for(g=g<<8|s[b],f+=8;f>r;)f-=r,h+=t[a&g>>f];if(f&&(h+=t[a&g<<r-f]),n)for(;h.length*r&7;)h+="=";return h},Ft=({name:s,prefix:t,bitsPerChar:r,alphabet:n})=>Uo({prefix:t,name:s,encode(a){return B1(a,n,r)},decode(a){return K1(a,n,r,s)}}),V1=Uo({prefix:"\0",name:"identity",encode:s=>U1(s),decode:s=>j1(s)});var F1=Object.freeze({__proto__:null,identity:V1});const W1=Ft({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var G1=Object.freeze({__proto__:null,base2:W1});const J1=Ft({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Q1=Object.freeze({__proto__:null,base8:J1});const Y1=ps({prefix:"9",name:"base10",alphabet:"0123456789"});var X1=Object.freeze({__proto__:null,base10:Y1});const Z1=Ft({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),eE=Ft({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var tE=Object.freeze({__proto__:null,base16:Z1,base16upper:eE});const rE=Ft({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),iE=Ft({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),nE=Ft({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),sE=Ft({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),oE=Ft({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),aE=Ft({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),cE=Ft({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),uE=Ft({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),hE=Ft({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var lE=Object.freeze({__proto__:null,base32:rE,base32upper:iE,base32pad:nE,base32padupper:sE,base32hex:oE,base32hexupper:aE,base32hexpad:cE,base32hexpadupper:uE,base32z:hE});const fE=ps({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),pE=ps({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var dE=Object.freeze({__proto__:null,base36:fE,base36upper:pE});const gE=ps({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),yE=ps({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var vE=Object.freeze({__proto__:null,base58btc:gE,base58flickr:yE});const mE=Ft({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),wE=Ft({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),bE=Ft({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),_E=Ft({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var EE=Object.freeze({__proto__:null,base64:mE,base64pad:wE,base64url:bE,base64urlpad:_E});const cp=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),IE=cp.reduce((s,t,r)=>(s[r]=t,s),[]),xE=cp.reduce((s,t,r)=>(s[t.codePointAt(0)]=r,s),[]);function SE(s){return s.reduce((t,r)=>(t+=IE[r],t),"")}function PE(s){const t=[];for(const r of s){const n=xE[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}const OE=Uo({prefix:"🚀",name:"base256emoji",encode:SE,decode:PE});var RE=Object.freeze({__proto__:null,base256emoji:OE}),TE=up,Vl=128,AE=127,CE=~AE,NE=Math.pow(2,31);function up(s,t,r){t=t||[],r=r||0;for(var n=r;s>=NE;)t[r++]=s&255|Vl,s/=128;for(;s&CE;)t[r++]=s&255|Vl,s>>>=7;return t[r]=s|0,up.bytes=r-n+1,t}var $E=Dc,DE=128,Fl=127;function Dc(s,n){var r=0,n=n||0,a=0,h=n,f,g=s.length;do{if(h>=g)throw Dc.bytes=0,new RangeError("Could not decode varint");f=s[h++],r+=a<28?(f&Fl)<<a:(f&Fl)*Math.pow(2,a),a+=7}while(f>=DE);return Dc.bytes=h-n,r}var LE=Math.pow(2,7),ME=Math.pow(2,14),jE=Math.pow(2,21),UE=Math.pow(2,28),qE=Math.pow(2,35),zE=Math.pow(2,42),kE=Math.pow(2,49),HE=Math.pow(2,56),KE=Math.pow(2,63),BE=function(s){return s<LE?1:s<ME?2:s<jE?3:s<UE?4:s<qE?5:s<zE?6:s<kE?7:s<HE?8:s<KE?9:10},VE={encode:TE,decode:$E,encodingLength:BE},hp=VE;const Wl=(s,t,r=0)=>(hp.encode(s,t,r),t),Gl=s=>hp.encodingLength(s),Lc=(s,t)=>{const r=t.byteLength,n=Gl(s),a=n+Gl(r),h=new Uint8Array(a+r);return Wl(s,h,0),Wl(r,h,n),h.set(t,a),new FE(s,r,t,h)};class FE{constructor(t,r,n,a){this.code=t,this.size=r,this.digest=n,this.bytes=a}}const lp=({name:s,code:t,encode:r})=>new WE(s,t,r);class WE{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?Lc(this.code,r):r.then(n=>Lc(this.code,n))}else throw Error("Unknown type, must be binary type")}}const fp=s=>async t=>new Uint8Array(await crypto.subtle.digest(s,t)),GE=lp({name:"sha2-256",code:18,encode:fp("SHA-256")}),JE=lp({name:"sha2-512",code:19,encode:fp("SHA-512")});var QE=Object.freeze({__proto__:null,sha256:GE,sha512:JE});const pp=0,YE="identity",dp=op,XE=s=>Lc(pp,dp(s)),ZE={code:pp,name:YE,encode:dp,digest:XE};var eI=Object.freeze({__proto__:null,identity:ZE});new TextEncoder,new TextDecoder;const Jl={...F1,...G1,...Q1,...X1,...tE,...lE,...dE,...vE,...EE,...RE};({...QE,...eI});function gp(s){return globalThis.Buffer!=null?new Uint8Array(s.buffer,s.byteOffset,s.byteLength):s}function tI(s=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?gp(globalThis.Buffer.allocUnsafe(s)):new Uint8Array(s)}function yp(s,t,r,n){return{name:s,prefix:t,encoder:{name:s,prefix:t,encode:r},decoder:{decode:n}}}const Ql=yp("utf8","u",s=>"u"+new TextDecoder("utf8").decode(s),s=>new TextEncoder().encode(s.substring(1))),wc=yp("ascii","a",s=>{let t="a";for(let r=0;r<s.length;r++)t+=String.fromCharCode(s[r]);return t},s=>{s=s.substring(1);const t=tI(s.length);for(let r=0;r<s.length;r++)t[r]=s.charCodeAt(r);return t}),rI={utf8:Ql,"utf-8":Ql,hex:Jl.base16,latin1:wc,ascii:wc,binary:wc,...Jl};function iI(s,t="utf8"){const r=rI[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?gp(globalThis.Buffer.from(s,"utf-8")):r.decoder.decode(`${r.prefix}${s}`)}const vp="wc",nI=2,eu="core",Ai=`${vp}@2:${eu}:`,sI={name:eu,logger:"error"},oI={database:":memory:"},aI="crypto",Yl="client_ed25519_seed",cI=re.ONE_DAY,uI="keychain",hI="0.3",lI="messages",fI="0.3",pI=re.SIX_HOURS,dI="publisher",mp="irn",gI="error",wp="wss://relay.walletconnect.com",Xl="wss://relay.walletconnect.org",yI="relayer",Jt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},vI="_subscription",pi={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},mI=re.ONE_SECOND,wI="2.10.6",bI=1e4,_I="0.3",EI="WALLETCONNECT_CLIENT_ID",zr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},II="subscription",xI="0.3",SI=re.FIVE_SECONDS*1e3,PI="pairing",OI="0.3",Zn={wc_pairingDelete:{req:{ttl:re.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:re.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:re.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:re.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:re.ONE_DAY,prompt:!1,tag:0},res:{ttl:re.ONE_DAY,prompt:!1,tag:0}}},ss={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Yr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},RI="history",TI="0.3",AI="expirer",Nr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},CI="0.3",bc="verify-api",In="https://verify.walletconnect.com",Mc="https://verify.walletconnect.org",NI=[In,Mc];class $I{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=uI,this.version=hI,this.initialized=!1,this.storagePrefix=Ai,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,a)=>{this.isInitialized(),this.keychain.set(n,a),await this.persist()},this.get=n=>{this.isInitialized();const a=this.keychain.get(n);if(typeof a>"u"){const{message:h}=J("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(h)}return a},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=t,this.logger=Ae.generateChildLogger(r,this.name)}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,Uf(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?qf(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=J("NOT_INITIALIZED",this.name);throw new Error(t)}}}class DI{constructor(t,r,n){this.core=t,this.logger=r,this.name=aI,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),h=jl(a);return Xf(h.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=qw();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const h=await this.getClientSeed(),f=jl(h),g=Cc();return await u1(g,a,cI,f)},this.generateSharedKey=(a,h,f)=>{this.isInitialized();const g=this.getPrivateKey(a),b=zw(g,h);return this.setSymKey(b,f)},this.setSymKey=async(a,h)=>{this.isInitialized();const f=h||kw(a);return await this.keychain.set(f,a),f},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,h,f)=>{this.isInitialized();const g=jf(f),b=Qi(h);if(ll(g)){const C=g.senderPublicKey,q=g.receiverPublicKey;a=await this.generateSharedKey(C,q)}const y=this.getSymKey(a),{type:E,senderPublicKey:O}=g;return Kw({type:E,symKey:y,message:b,senderPublicKey:O})},this.decode=async(a,h,f)=>{this.isInitialized();const g=Fw(h,f);if(ll(g)){const b=g.receiverPublicKey,y=g.senderPublicKey;a=await this.generateSharedKey(b,y)}try{const b=this.getSymKey(a),y=Bw({symKey:b,encoded:h});return fs(y)}catch(b){this.logger.error(`Failed to decode message from topic: '${a}', clientId: '${await this.getClientId()}'`),this.logger.error(b)}},this.getPayloadType=a=>{const h=Ao(a);return us(h.type)},this.getPayloadSenderPublicKey=a=>{const h=Ao(a);return h.senderPublicKey?sr(h.senderPublicKey,nr):void 0},this.core=t,this.logger=Ae.generateChildLogger(r,this.name),this.keychain=n||new $I(this.core,this.logger)}get context(){return Ae.getLoggerContext(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Yl)}catch{t=Cc(),await this.keychain.set(Yl,t)}return iI(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=J("NOT_INITIALIZED",this.name);throw new Error(t)}}}class LI extends k_{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=lI,this.version=fI,this.initialized=!1,this.storagePrefix=Ai,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,a)=>{this.isInitialized();const h=xn(a);let f=this.messages.get(n);return typeof f>"u"&&(f={}),typeof f[h]<"u"||(f[h]=a,this.messages.set(n,f),await this.persist()),h},this.get=n=>{this.isInitialized();let a=this.messages.get(n);return typeof a>"u"&&(a={}),a},this.has=(n,a)=>{this.isInitialized();const h=this.get(n),f=xn(a);return typeof h[f]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Ae.generateChildLogger(t,this.name),this.core=r}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,Uf(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?qf(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=J("NOT_INITIALIZED",this.name);throw new Error(t)}}}class MI extends H_{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new $r.EventEmitter,this.name=dI,this.queue=new Map,this.publishTimeout=re.toMiliseconds(re.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,a,h)=>{var f;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:a,opts:h}});try{const g=(h==null?void 0:h.ttl)||pI,b=Nc(h),y=(h==null?void 0:h.prompt)||!1,E=(h==null?void 0:h.tag)||0,O=(h==null?void 0:h.id)||ip().toString(),C={topic:n,message:a,opts:{ttl:g,relay:b,prompt:y,tag:E,id:O}},q=setTimeout(()=>this.queue.set(O,C),this.publishTimeout);try{await await cs(this.rpcPublish(n,a,g,b,y,E,O),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(O),this.relayer.events.emit(Jt.publish,C)}catch(A){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(f=h==null?void 0:h.internal)!=null&&f.throwOnFailedPublish)throw this.removeRequestFromQueue(O),A;return}finally{clearTimeout(q)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:a,opts:h}})}catch(g){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(g),g}},this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.relayer=t,this.logger=Ae.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Ae.getLoggerContext(this.logger)}rpcPublish(t,r,n,a,h,f,g){var b,y,E,O;const C={method:So(a.protocol).publish,params:{topic:t,message:r,ttl:n,prompt:h,tag:f},id:g};return ir((b=C.params)==null?void 0:b.prompt)&&((y=C.params)==null||delete y.prompt),ir((E=C.params)==null?void 0:E.tag)&&((O=C.params)==null||delete O.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:C}),this.relayer.request(C)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:n,opts:a}=t;await this.publish(r,n,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(Cn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Jt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Jt.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class jI{constructor(){this.map=new Map,this.set=(t,r)=>{const n=this.get(t);this.exists(t,r)||this.map.set(t,[...n,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const n=this.get(t);if(!this.exists(t,r))return;const a=n.filter(h=>h!==r);if(!a.length){this.map.delete(t);return}this.map.set(t,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var UI=Object.defineProperty,qI=Object.defineProperties,zI=Object.getOwnPropertyDescriptors,Zl=Object.getOwnPropertySymbols,kI=Object.prototype.hasOwnProperty,HI=Object.prototype.propertyIsEnumerable,ef=(s,t,r)=>t in s?UI(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,es=(s,t)=>{for(var r in t||(t={}))kI.call(t,r)&&ef(s,r,t[r]);if(Zl)for(var r of Zl(t))HI.call(t,r)&&ef(s,r,t[r]);return s},_c=(s,t)=>qI(s,zI(t));class KI extends V_{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new jI,this.events=new $r.EventEmitter,this.name=II,this.version=xI,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ai,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:a}});try{const h=Nc(a),f={topic:n,relay:h};this.pending.set(n,f);const g=await this.rpcSubscribe(n,h);return this.onSubscribe(g,f),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:a}}),g}catch(h){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(h),h}},this.unsubscribe=async(n,a)=>{await this.restartToComplete(),this.isInitialized(),typeof(a==null?void 0:a.id)<"u"?await this.unsubscribeById(n,a.id,a):await this.unsubscribeByTopic(n,a)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((a,h)=>{const f=new re.Watch;f.start(this.pendingSubscriptionWatchLabel);const g=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(g),f.stop(this.pendingSubscriptionWatchLabel),a(!0)),f.elapsed(this.pendingSubscriptionWatchLabel)>=SI&&(clearInterval(g),f.stop(this.pendingSubscriptionWatchLabel),h(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Ae.generateChildLogger(r,this.name),this.clientId=""}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let n=!1;try{n=this.getSubscription(t).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const n=this.topicMap.get(t);await Promise.all(n.map(async a=>await this.unsubscribeById(t,a,r)))}async unsubscribeById(t,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}});try{const a=Nc(n);await this.rpcUnsubscribe(t,r,a);const h=It("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,h),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(t,r){const n={method:So(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await cs(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Jt.connection_stalled)}return xn(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,n={method:So(r.protocol).batchSubscribe,params:{topics:t.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await cs(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Jt.connection_stalled)}}rpcUnsubscribe(t,r,n){const a={method:So(n.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(t,r){this.setSubscription(t,_c(es({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,es({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,n),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,es({},r)),this.topicMap.set(r.topic,t),this.events.emit(zr.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:n}=J("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const n=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(n.topic,t),this.events.emit(zr.deleted,_c(es({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(zr.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(zr.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);Xr(r)&&this.onBatchSubscribe(r.map((n,a)=>_c(es({},t[a]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(Cn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Jt.connect,async()=>{await this.onConnect()}),this.relayer.on(Jt.disconnect,()=>{this.onDisconnect()}),this.events.on(zr.created,async t=>{const r=zr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(zr.deleted,async t=>{const r=zr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=J("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var BI=Object.defineProperty,tf=Object.getOwnPropertySymbols,VI=Object.prototype.hasOwnProperty,FI=Object.prototype.propertyIsEnumerable,rf=(s,t,r)=>t in s?BI(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,WI=(s,t)=>{for(var r in t||(t={}))VI.call(t,r)&&rf(s,r,t[r]);if(tf)for(var r of tf(t))FI.call(t,r)&&rf(s,r,t[r]);return s};class GI extends K_{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new $r.EventEmitter,this.name=yI,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Jt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Jt.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(pi.payload,this.onPayloadHandler),this.provider.on(pi.connect,this.onConnectHandler),this.provider.on(pi.disconnect,this.onDisconnectHandler),this.provider.on(pi.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Ae.generateChildLogger(t.logger,this.name):Ae.pino(Ae.getDefaultLoggerOptions({level:t.logger||gI})),this.messages=new LI(this.logger,t.core),this.subscriber=new KI(this,this.logger),this.publisher=new MI(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||wp,this.projectId=t.projectId,this.bundleId=Xw(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Xl}...`),await this.restartTransport(Xl)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},bI)}get context(){return Ae.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,n){this.isInitialized(),await this.publisher.publish(t,r,n),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var n;this.isInitialized();let a=((n=this.subscriber.topicMap.get(t))==null?void 0:n[0])||"";if(a)return a;let h;const f=g=>{g.topic===t&&(this.subscriber.off(zr.created,f),h())};return await Promise.all([new Promise(g=>{h=g,this.subscriber.on(zr.created,f)}),new Promise(async g=>{a=await this.subscriber.subscribe(t,r),g()})]),a}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await cs(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(zr.resubscribed,()=>{r()})}),new Promise(async(r,n)=>{try{await cs(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(a){n(a);return}r()})])}catch(r){this.logger.error(r);const n=r;if(!this.isConnectionStalled(n.message))throw r;this.provider.events.emit(pi.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await El())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new yi(new A1(nb({sdkVersion:wI,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:n}=t;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(t){const{topic:r,message:n}=t;if(!n||n.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const a=this.messages.has(r,n);return a&&this.logger.debug(`Ignoring duplicate message: ${n}`),a}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Zc(t)){if(!t.method.endsWith(vI))return;const r=t.params,{topic:n,message:a,publishedAt:h}=r.data,f={topic:n,message:a,publishedAt:h};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(WI({type:"event",event:r.id},f)),this.events.emit(r.id,f),await this.acknowledgePayload(t),await this.onMessageEvent(f)}else jo(t)&&this.events.emit(Jt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Jt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=Xc(t.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(pi.payload,this.onPayloadHandler),this.provider.off(pi.connect,this.onConnectHandler),this.provider.off(pi.disconnect,this.onDisconnectHandler),this.provider.off(pi.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Jt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let t=await El();Qb(async r=>{this.initialized&&t!==r&&(t=r,r?await this.restartTransport().catch(n=>this.logger.error(n)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(n=>this.logger.error(n))))})}onProviderDisconnect(){this.events.emit(Jt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(t=>this.logger.error(t))},re.toMiliseconds(mI)))}isInitialized(){if(!this.initialized){const{message:t}=J("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var JI=Object.defineProperty,nf=Object.getOwnPropertySymbols,QI=Object.prototype.hasOwnProperty,YI=Object.prototype.propertyIsEnumerable,sf=(s,t,r)=>t in s?JI(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,of=(s,t)=>{for(var r in t||(t={}))QI.call(t,r)&&sf(s,r,t[r]);if(nf)for(var r of nf(t))YI.call(t,r)&&sf(s,r,t[r]);return s};class qo extends B_{constructor(t,r,n,a=Ai,h=void 0){super(t,r,n,a),this.core=t,this.logger=r,this.name=n,this.map=new Map,this.version=_I,this.cached=[],this.initialized=!1,this.storagePrefix=Ai,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(f=>{this.getKey&&f!==null&&!ir(f)?this.map.set(this.getKey(f),f):Ob(f)?this.map.set(f.id,f):Rb(f)&&this.map.set(f.topic,f)}),this.cached=[],this.initialized=!0)},this.set=async(f,g)=>{this.isInitialized(),this.map.has(f)?await this.update(f,g):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:f,value:g}),this.map.set(f,g),await this.persist())},this.get=f=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:f}),this.getData(f)),this.getAll=f=>(this.isInitialized(),f?this.values.filter(g=>Object.keys(f).every(b=>N1(g[b],f[b]))):this.values),this.update=async(f,g)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:f,update:g});const b=of(of({},this.getData(f)),g);this.map.set(f,b),await this.persist()},this.delete=async(f,g)=>{this.isInitialized(),this.map.has(f)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:f,reason:g}),this.map.delete(f),await this.persist())},this.logger=Ae.generateChildLogger(r,this.name),this.storagePrefix=a,this.getKey=h}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:n}=J("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=J("NOT_INITIALIZED",this.name);throw new Error(t)}}}class XI{constructor(t,r){this.core=t,this.logger=r,this.name=PI,this.version=OI,this.events=new Hc,this.initialized=!1,this.storagePrefix=Ai,this.ignoredPayloadTypes=[Yi],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=Cc(),a=await this.core.crypto.setSymKey(n),h=kr(re.FIVE_MINUTES),f={protocol:mp},g={topic:a,expiry:h,relay:f,active:!1},b=vb({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:n,relay:f});return await this.pairings.set(a,g),await this.core.relayer.subscribe(a),this.core.expirer.set(a,h),{topic:a,uri:b}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:a,symKey:h,relay:f}=vl(n.uri);let g;if(this.pairings.keys.includes(a)&&(g=this.pairings.get(a),g.active))throw new Error(`Pairing already exists: ${a}. Please try again with a new connection URI.`);const b=kr(re.FIVE_MINUTES),y={topic:a,relay:f,expiry:b,active:!1};return await this.pairings.set(a,y),this.core.expirer.set(a,b),n.activatePairing&&await this.activate({topic:a}),this.events.emit(ss.create,y),this.core.crypto.keychain.has(a)||(await this.core.crypto.setSymKey(h,a),await this.core.relayer.subscribe(a,{relay:f})),y},this.activate=async({topic:n})=>{this.isInitialized();const a=kr(re.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:a}),this.core.expirer.set(n,a)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:a}=n;if(this.pairings.keys.includes(a)){const h=await this.sendRequest(a,"wc_pairingPing",{}),{done:f,resolve:g,reject:b}=En();this.events.once(Dt("pairing_ping",h),({error:y})=>{y?b(y):g()}),await f()}},this.updateExpiry=async({topic:n,expiry:a})=>{this.isInitialized(),await this.pairings.update(n,{expiry:a})},this.updateMetadata=async({topic:n,metadata:a})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:a}=n;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",It("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(n,a,h)=>{const f=Pn(a,h),g=await this.core.crypto.encode(n,f),b=Zn[a].req;return this.core.history.set(n,f),this.core.relayer.publish(n,g,b),f.id},this.sendResult=async(n,a,h)=>{const f=Xc(n,h),g=await this.core.crypto.encode(a,f),b=await this.core.history.get(a,n),y=Zn[b.request.method].res;await this.core.relayer.publish(a,g,y),await this.core.history.resolve(f)},this.sendError=async(n,a,h)=>{const f=Mo(n,h),g=await this.core.crypto.encode(a,f),b=await this.core.history.get(a,n),y=Zn[b.request.method]?Zn[b.request.method].res:Zn.unregistered_method.res;await this.core.relayer.publish(a,g,y),await this.core.history.resolve(f)},this.deletePairing=async(n,a)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,It("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),a?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(a=>Ti(a.expiry));await Promise.all(n.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=n=>{const{topic:a,payload:h}=n;switch(h.method){case"wc_pairingPing":return this.onPairingPingRequest(a,h);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,h);default:return this.onUnknownRpcMethodRequest(a,h)}},this.onRelayEventResponse=async n=>{const{topic:a,payload:h}=n,f=(await this.core.history.get(a,h.id)).request.method;switch(f){case"wc_pairingPing":return this.onPairingPingResponse(a,h);default:return this.onUnknownRpcMethodResponse(f)}},this.onPairingPingRequest=async(n,a)=>{const{id:h}=a;try{this.isValidPing({topic:n}),await this.sendResult(h,n,!0),this.events.emit(ss.ping,{id:h,topic:n})}catch(f){await this.sendError(h,n,f),this.logger.error(f)}},this.onPairingPingResponse=(n,a)=>{const{id:h}=a;setTimeout(()=>{gi(a)?this.events.emit(Dt("pairing_ping",h),{}):Hr(a)&&this.events.emit(Dt("pairing_ping",h),{error:a.error})},500)},this.onPairingDeleteRequest=async(n,a)=>{const{id:h}=a;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(ss.delete,{id:h,topic:n})}catch(f){await this.sendError(h,n,f),this.logger.error(f)}},this.onUnknownRpcMethodRequest=async(n,a)=>{const{id:h,method:f}=a;try{if(this.registeredMethods.includes(f))return;const g=It("WC_METHOD_UNSUPPORTED",f);await this.sendError(h,n,g),this.logger.error(g)}catch(g){await this.sendError(h,n,g),this.logger.error(g)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(It("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{var a;if(!dr(n)){const{message:f}=J("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(f)}if(!Pb(n.uri)){const{message:f}=J("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(f)}const h=vl(n.uri);if(!((a=h==null?void 0:h.relay)!=null&&a.protocol)){const{message:f}=J("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(f)}if(!(h!=null&&h.symKey)){const{message:f}=J("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(f)}},this.isValidPing=async n=>{if(!dr(n)){const{message:h}=J("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(h)}const{topic:a}=n;await this.isValidPairingTopic(a)},this.isValidDisconnect=async n=>{if(!dr(n)){const{message:h}=J("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(h)}const{topic:a}=n;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async n=>{if(!Ht(n,!1)){const{message:a}=J("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(a)}if(!this.pairings.keys.includes(n)){const{message:a}=J("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(a)}if(Ti(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:a}=J("EXPIRED",`pairing topic: ${n}`);throw new Error(a)}},this.core=t,this.logger=Ae.generateChildLogger(r,this.name),this.pairings=new qo(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Ae.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=J("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Jt.message,async t=>{const{topic:r,message:n}=t;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const a=await this.core.crypto.decode(r,n);try{Zc(a)?(this.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):jo(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.core.history.delete(r,a.id))}catch(h){this.logger.error(h)}})}registerExpirerEvents(){this.core.expirer.on(Nr.expired,async t=>{const{topic:r}=kf(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(ss.expire,{topic:r}))})}}class ZI extends z_{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new $r.EventEmitter,this.name=RI,this.version=TI,this.cached=[],this.initialized=!1,this.storagePrefix=Ai,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,a,h)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:a,chainId:h}),this.records.has(a.id))return;const f={id:a.id,topic:n,request:{method:a.method,params:a.params||null},chainId:h,expiry:kr(re.THIRTY_DAYS)};this.records.set(f.id,f),this.events.emit(Yr.created,f)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const a=await this.getRecord(n.id);typeof a.response>"u"&&(a.response=Hr(n)?{error:n.error}:{result:n.result},this.records.set(a.id,a),this.events.emit(Yr.updated,a))},this.get=async(n,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:a}),await this.getRecord(a)),this.delete=(n,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(h=>{if(h.topic===n){if(typeof a<"u"&&h.id!==a)return;this.records.delete(h.id),this.events.emit(Yr.deleted,h)}})},this.exists=async(n,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===n:!1),this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.logger=Ae.generateChildLogger(r,this.name)}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:Pn(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(n)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:n}=J("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Yr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Yr.created,t=>{const r=Yr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Yr.updated,t=>{const r=Yr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Yr.deleted,t=>{const r=Yr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.core.heartbeat.on(Cn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{re.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=J("NOT_INITIALIZED",this.name);throw new Error(t)}}}class ex extends F_{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new $r.EventEmitter,this.name=AI,this.version=CI,this.cached=[],this.initialized=!1,this.storagePrefix=Ai,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const a=this.formatTarget(n);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(n,a)=>{this.isInitialized();const h=this.formatTarget(n),f={target:h,expiry:a};this.expirations.set(h,f),this.checkExpiry(h,f),this.events.emit(Nr.created,{target:h,expiration:f})},this.get=n=>{this.isInitialized();const a=this.formatTarget(n);return this.getExpiration(a)},this.del=n=>{if(this.isInitialized(),this.has(n)){const a=this.formatTarget(n),h=this.getExpiration(a);this.expirations.delete(a),this.events.emit(Nr.deleted,{target:a,expiration:h})}},this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.logger=Ae.generateChildLogger(r,this.name)}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return sb(t);if(typeof t=="number")return ob(t);const{message:r}=J("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Nr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:n}=J("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(t,r){const{expiry:n}=r;re.toMiliseconds(n)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Nr.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(Cn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Nr.created,t=>{const r=Nr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Nr.expired,t=>{const r=Nr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Nr.deleted,t=>{const r=Nr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=J("NOT_INITIALIZED",this.name);throw new Error(t)}}}class tx extends W_{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=bc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async n=>{if(this.verifyDisabled||Rn()||!Tn())return;const a=this.getVerifyUrl(n==null?void 0:n.verifyUrl);this.verifyUrl!==a&&this.removeIframe(),this.verifyUrl=a;try{await this.createIframe()}catch(h){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(h)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Mc;try{await this.createIframe()}catch(h){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(h),this.verifyDisabled=!0}}},this.register=async n=>{this.initialized?this.sendPost(n.attestationId):(this.addToQueue(n.attestationId),await this.init())},this.resolve=async n=>{if(this.isDevEnv)return"";const a=this.getVerifyUrl(n==null?void 0:n.verifyUrl);let h;try{h=await this.fetchAttestation(n.attestationId,a)}catch(f){this.logger.info(`failed to resolve attestation: ${n.attestationId} from url: ${a}`),this.logger.info(f),h=await this.fetchAttestation(n.attestationId,Mc)}return h},this.fetchAttestation=async(n,a)=>{this.logger.info(`resolving attestation: ${n} from url: ${a}`);const h=this.startAbortTimer(re.ONE_SECOND*2),f=await fetch(`${a}/attestation/${n}`,{signal:this.abortController.signal});return clearTimeout(h),f.status===200?await f.json():void 0},this.addToQueue=n=>{this.queue.push(n)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(n=>this.sendPost(n)),this.queue=[])},this.sendPost=n=>{var a;try{if(!this.iframe)return;(a=this.iframe.contentWindow)==null||a.postMessage(n,"*"),this.logger.info(`postMessage sent: ${n} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let n;const a=h=>{h.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",a),n())};await Promise.race([new Promise(h=>{if(document.getElementById(bc))return h();window.addEventListener("message",a);const f=document.createElement("iframe");f.id=bc,f.src=`${this.verifyUrl}/${this.projectId}`,f.style.display="none",document.body.append(f),this.iframe=f,n=h}),new Promise((h,f)=>setTimeout(()=>{window.removeEventListener("message",a),f("verify iframe load timeout")},re.toMiliseconds(re.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=n=>{let a=n||In;return NI.includes(a)||(this.logger.info(`verify url: ${a}, not included in trusted list, assigning default: ${In}`),a=In),a},this.logger=Ae.generateChildLogger(r,this.name),this.verifyUrl=In,this.abortController=new AbortController,this.isDevEnv=Fc()&&$1.IS_VITEST}get context(){return Ae.getLoggerContext(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),re.toMiliseconds(t))}}var rx=Object.defineProperty,af=Object.getOwnPropertySymbols,ix=Object.prototype.hasOwnProperty,nx=Object.prototype.propertyIsEnumerable,cf=(s,t,r)=>t in s?rx(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,uf=(s,t)=>{for(var r in t||(t={}))ix.call(t,r)&&cf(s,r,t[r]);if(af)for(var r of af(t))nx.call(t,r)&&cf(s,r,t[r]);return s};class tu extends q_{constructor(t){super(t),this.protocol=vp,this.version=nI,this.name=eu,this.events=new $r.EventEmitter,this.initialized=!1,this.on=(n,a)=>this.events.on(n,a),this.once=(n,a)=>this.events.once(n,a),this.off=(n,a)=>this.events.off(n,a),this.removeListener=(n,a)=>this.events.removeListener(n,a),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||wp,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ae.pino(Ae.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||sI.logger}));this.logger=Ae.generateChildLogger(r,this.name),this.heartbeat=new Cn.HeartBeat,this.crypto=new DI(this,this.logger,t==null?void 0:t.keychain),this.history=new ZI(this,this.logger),this.expirer=new ex(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new A_(uf(uf({},oI),t==null?void 0:t.storageOptions)),this.relayer=new GI({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new XI(this,this.logger),this.verify=new tx(this.projectId||"",this.logger)}static async init(t){const r=new tu(t);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(EI,n),r}get context(){return Ae.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const sx=tu,bp="wc",_p=2,Ep="client",ru=`${bp}@${_p}:${Ep}:`,Ec={name:Ep,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},hf="WALLETCONNECT_DEEPLINK_CHOICE",ox="proposal",Ip="Proposal expired",ax="session",Eo=re.SEVEN_DAYS,cx="engine",ts={wc_sessionPropose:{req:{ttl:re.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:re.ONE_DAY,prompt:!1,tag:1104},res:{ttl:re.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:re.ONE_DAY,prompt:!1,tag:1106},res:{ttl:re.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:re.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:re.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:re.ONE_DAY,prompt:!1,tag:1112},res:{ttl:re.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:re.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:re.THIRTY_SECONDS,prompt:!1,tag:1115}}},Ic={min:re.FIVE_MINUTES,max:re.SEVEN_DAYS},di={idle:"IDLE",active:"ACTIVE"},ux="request",hx=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var lx=Object.defineProperty,fx=Object.defineProperties,px=Object.getOwnPropertyDescriptors,lf=Object.getOwnPropertySymbols,dx=Object.prototype.hasOwnProperty,gx=Object.prototype.propertyIsEnumerable,ff=(s,t,r)=>t in s?lx(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,fr=(s,t)=>{for(var r in t||(t={}))dx.call(t,r)&&ff(s,r,t[r]);if(lf)for(var r of lf(t))gx.call(t,r)&&ff(s,r,t[r]);return s},rs=(s,t)=>fx(s,px(t));class yx extends J_{constructor(t){super(t),this.name=cx,this.events=new Hc,this.initialized=!1,this.ignoredPayloadTypes=[Yi],this.requestQueue={state:di.idle,queue:[]},this.sessionRequestQueue={state:di.idle,queue:[]},this.requestQueueDelay=re.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(ts)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},re.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const n=rs(fr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:a,requiredNamespaces:h,optionalNamespaces:f,sessionProperties:g,relays:b}=n;let y=a,E,O=!1;if(y&&(O=this.client.core.pairing.pairings.get(y).active),!y||!O){const{topic:fe,uri:pe}=await this.client.core.pairing.create();y=fe,E=pe}const C=await this.client.core.crypto.generateKeyPair(),q=fr({requiredNamespaces:h,optionalNamespaces:f,relays:b??[{protocol:mp}],proposer:{publicKey:C,metadata:this.client.metadata}},g&&{sessionProperties:g}),{reject:A,resolve:V,done:ie}=En(re.FIVE_MINUTES,Ip);if(this.events.once(Dt("session_connect"),async({error:fe,session:pe})=>{if(fe)A(fe);else if(pe){pe.self.publicKey=C;const de=rs(fr({},pe),{requiredNamespaces:pe.requiredNamespaces,optionalNamespaces:pe.optionalNamespaces});await this.client.session.set(pe.topic,de),await this.setExpiry(pe.topic,pe.expiry),y&&await this.client.core.pairing.updateMetadata({topic:y,metadata:pe.peer.metadata}),V(de)}}),!y){const{message:fe}=J("NO_MATCHING_KEY",`connect() pairing topic: ${y}`);throw new Error(fe)}const he=await this.sendRequest({topic:y,method:"wc_sessionPropose",params:q}),le=kr(re.FIVE_MINUTES);return await this.setProposal(he,fr({id:he,expiry:le},q)),{uri:E,approval:ie}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:n,relayProtocol:a,namespaces:h,sessionProperties:f}=r,g=this.client.proposal.get(n);let{pairingTopic:b,proposer:y,requiredNamespaces:E,optionalNamespaces:O}=g;b=b||"",Sn(E)||(E=_b(h,"approve()"));const C=await this.client.core.crypto.generateKeyPair(),q=y.publicKey,A=await this.client.core.crypto.generateSharedKey(C,q);b&&n&&(await this.client.core.pairing.updateMetadata({topic:b,metadata:y.metadata}),await this.sendResult({id:n,topic:b,result:{relay:{protocol:a??"irn"},responderPublicKey:C}}),await this.client.proposal.delete(n,It("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:b}));const V=fr({relay:{protocol:a??"irn"},namespaces:h,requiredNamespaces:E,optionalNamespaces:O,pairingTopic:b,controller:{publicKey:C,metadata:this.client.metadata},expiry:kr(Eo)},f&&{sessionProperties:f});await this.client.core.relayer.subscribe(A),await this.sendRequest({topic:A,method:"wc_sessionSettle",params:V,throwOnFailedPublish:!0});const ie=rs(fr({},V),{topic:A,pairingTopic:b,acknowledged:!1,self:V.controller,peer:{publicKey:y.publicKey,metadata:y.metadata},controller:C});return await this.client.session.set(A,ie),await this.setExpiry(A,kr(Eo)),{topic:A,acknowledged:()=>new Promise(he=>setTimeout(()=>he(this.client.session.get(A)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:n,reason:a}=r,{pairingTopic:h}=this.client.proposal.get(n);h&&(await this.sendError(n,h,a),await this.client.proposal.delete(n,It("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:n,namespaces:a}=r,h=await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:a}}),{done:f,resolve:g,reject:b}=En();return this.events.once(Dt("session_update",h),({error:y})=>{y?b(y):g()}),await this.client.session.update(n,{namespaces:a}),{acknowledged:f}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:n}=r,a=await this.sendRequest({topic:n,method:"wc_sessionExtend",params:{}}),{done:h,resolve:f,reject:g}=En();return this.events.once(Dt("session_extend",a),({error:b})=>{b?g(b):f()}),await this.setExpiry(n,kr(Eo)),{acknowledged:h}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:n,request:a,topic:h,expiry:f}=r,g=Yc(),{done:b,resolve:y,reject:E}=En(f,"Request expired. Please try again.");return this.events.once(Dt("session_request",g),({error:O,result:C})=>{O?E(O):y(C)}),await Promise.all([new Promise(async O=>{await this.sendRequest({clientRpcId:g,topic:h,method:"wc_sessionRequest",params:{request:a,chainId:n},expiry:f,throwOnFailedPublish:!0}).catch(C=>E(C)),this.client.events.emit("session_request_sent",{topic:h,request:a,chainId:n,id:g}),O()}),new Promise(async O=>{const C=await cb(this.client.core.storage,hf);ab({id:g,topic:h,wcDeepLink:C}),O()}),b()]).then(O=>O[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:a}=r,{id:h}=a;gi(a)?await this.sendResult({id:h,topic:n,result:a.result,throwOnFailedPublish:!0}):Hr(a)&&await this.sendError(h,n,a.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:n}=r;if(this.client.session.keys.includes(n)){const a=await this.sendRequest({topic:n,method:"wc_sessionPing",params:{}}),{done:h,resolve:f,reject:g}=En();this.events.once(Dt("session_ping",a),({error:b})=>{b?g(b):f()}),await h()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:n,event:a,chainId:h}=r;await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:a,chainId:h}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:n}=r;this.client.session.keys.includes(n)?(await this.sendRequest({topic:n,method:"wc_sessionDelete",params:It("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(n=>xb(n,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const n=this.client.core.pairing.pairings.get(r.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(h=>{var f,g;return((f=h.peerMetadata)==null?void 0:f.url)&&((g=h.peerMetadata)==null?void 0:g.url)===r.peer.metadata.url&&h.topic&&h.topic!==n.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(h=>this.client.core.pairing.disconnect({topic:h.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(r,n)=>{const{self:a}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,It("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),n||this.client.core.expirer.del(r),this.client.core.storage.removeItem(hf).catch(h=>this.client.logger.warn(h))},this.deleteProposal=async(r,n)=>{await Promise.all([this.client.proposal.delete(r,It("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,n,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),a?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(h=>h.id!==r),a&&(this.sessionRequestQueue.state=di.idle)},this.setExpiry=async(r,n)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:n}),this.client.core.expirer.set(r,n)},this.setProposal=async(r,n)=>{await this.client.proposal.set(r,n),this.client.core.expirer.set(r,n.expiry)},this.setPendingSessionRequest=async r=>{const n=ts.wc_sessionRequest.req.ttl,{id:a,topic:h,params:f,verifyContext:g}=r;await this.client.pendingRequest.set(a,{id:a,topic:h,params:f,verifyContext:g}),n&&this.client.core.expirer.set(a,kr(n))},this.sendRequest=async r=>{const{topic:n,method:a,params:h,expiry:f,relayRpcId:g,clientRpcId:b,throwOnFailedPublish:y}=r,E=Pn(a,h,b);if(Tn()&&hx.includes(a)){const q=xn(JSON.stringify(E));this.client.core.verify.register({attestationId:q})}const O=await this.client.core.crypto.encode(n,E),C=ts[a].req;return f&&(C.ttl=f),g&&(C.id=g),this.client.core.history.set(n,E),y?(C.internal=rs(fr({},C.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,O,C)):this.client.core.relayer.publish(n,O,C).catch(q=>this.client.logger.error(q)),E.id},this.sendResult=async r=>{const{id:n,topic:a,result:h,throwOnFailedPublish:f}=r,g=Xc(n,h),b=await this.client.core.crypto.encode(a,g),y=await this.client.core.history.get(a,n),E=ts[y.request.method].res;f?(E.internal=rs(fr({},E.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(a,b,E)):this.client.core.relayer.publish(a,b,E).catch(O=>this.client.logger.error(O)),await this.client.core.history.resolve(g)},this.sendError=async(r,n,a)=>{const h=Mo(r,a),f=await this.client.core.crypto.encode(n,h),g=await this.client.core.history.get(n,r),b=ts[g.request.method].res;this.client.core.relayer.publish(n,f,b),await this.client.core.history.resolve(h)},this.cleanup=async()=>{const r=[],n=[];this.client.session.getAll().forEach(a=>{Ti(a.expiry)&&r.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{Ti(a.expiry)&&n.push(a.id)}),await Promise.all([...r.map(a=>this.deleteSession(a)),...n.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===di.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=di.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(n=>setTimeout(n,300))}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=di.idle},this.processRequest=r=>{const{topic:n,payload:a}=r,h=a.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeRequest(n,a);case"wc_sessionSettle":return this.onSessionSettleRequest(n,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,a);case"wc_sessionExtend":return this.onSessionExtendRequest(n,a);case"wc_sessionPing":return this.onSessionPingRequest(n,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,a);case"wc_sessionRequest":return this.onSessionRequest(n,a);case"wc_sessionEvent":return this.onSessionEventRequest(n,a);default:return this.client.logger.info(`Unsupported request method ${h}`)}},this.onRelayEventResponse=async r=>{const{topic:n,payload:a}=r,h=(await this.client.core.history.get(n,a.id)).request.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeResponse(n,a);case"wc_sessionSettle":return this.onSessionSettleResponse(n,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,a);case"wc_sessionExtend":return this.onSessionExtendResponse(n,a);case"wc_sessionPing":return this.onSessionPingResponse(n,a);case"wc_sessionRequest":return this.onSessionRequestResponse(n,a);default:return this.client.logger.info(`Unsupported response method ${h}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:n}=r,{message:a}=J("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.onSessionProposeRequest=async(r,n)=>{const{params:a,id:h}=n;try{this.isValidConnect(fr({},n.params));const f=kr(re.FIVE_MINUTES),g=fr({id:h,pairingTopic:r,expiry:f},a);await this.setProposal(h,g);const b=xn(JSON.stringify(n)),y=await this.getVerifyContext(b,g.proposer.metadata);this.client.events.emit("session_proposal",{id:h,params:g,verifyContext:y})}catch(f){await this.sendError(h,r,f),this.client.logger.error(f)}},this.onSessionProposeResponse=async(r,n)=>{const{id:a}=n;if(gi(n)){const{result:h}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:h});const f=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:f});const g=f.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:g});const b=h.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:b});const y=await this.client.core.crypto.generateSharedKey(g,b);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:y});const E=await this.client.core.relayer.subscribe(y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:E}),await this.client.core.pairing.activate({topic:r})}else Hr(n)&&(await this.client.proposal.delete(a,It("USER_DISCONNECTED")),this.events.emit(Dt("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(r,n)=>{const{id:a,params:h}=n;try{this.isValidSessionSettleRequest(h);const{relay:f,controller:g,expiry:b,namespaces:y,requiredNamespaces:E,optionalNamespaces:O,sessionProperties:C,pairingTopic:q}=n.params,A=fr({topic:r,relay:f,expiry:b,namespaces:y,acknowledged:!0,pairingTopic:q,requiredNamespaces:E,optionalNamespaces:O,controller:g.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:g.publicKey,metadata:g.metadata}},C&&{sessionProperties:C});await this.sendResult({id:n.id,topic:r,result:!0}),this.events.emit(Dt("session_connect"),{session:A}),this.cleanupDuplicatePairings(A)}catch(f){await this.sendError(a,r,f),this.client.logger.error(f)}},this.onSessionSettleResponse=async(r,n)=>{const{id:a}=n;gi(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Dt("session_approve",a),{})):Hr(n)&&(await this.client.session.delete(r,It("USER_DISCONNECTED")),this.events.emit(Dt("session_approve",a),{error:n.error}))},this.onSessionUpdateRequest=async(r,n)=>{const{params:a,id:h}=n;try{const f=`${r}_session_update`,g=wo.get(f);if(g&&this.isRequestOutOfSync(g,h)){this.client.logger.info(`Discarding out of sync request - ${h}`);return}this.isValidUpdate(fr({topic:r},a)),await this.client.session.update(r,{namespaces:a.namespaces}),await this.sendResult({id:h,topic:r,result:!0}),this.client.events.emit("session_update",{id:h,topic:r,params:a}),wo.set(f,h)}catch(f){await this.sendError(h,r,f),this.client.logger.error(f)}},this.isRequestOutOfSync=(r,n)=>parseInt(n.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,n)=>{const{id:a}=n;gi(n)?this.events.emit(Dt("session_update",a),{}):Hr(n)&&this.events.emit(Dt("session_update",a),{error:n.error})},this.onSessionExtendRequest=async(r,n)=>{const{id:a}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,kr(Eo)),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_extend",{id:a,topic:r})}catch(h){await this.sendError(a,r,h),this.client.logger.error(h)}},this.onSessionExtendResponse=(r,n)=>{const{id:a}=n;gi(n)?this.events.emit(Dt("session_extend",a),{}):Hr(n)&&this.events.emit(Dt("session_extend",a),{error:n.error})},this.onSessionPingRequest=async(r,n)=>{const{id:a}=n;try{this.isValidPing({topic:r}),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_ping",{id:a,topic:r})}catch(h){await this.sendError(a,r,h),this.client.logger.error(h)}},this.onSessionPingResponse=(r,n)=>{const{id:a}=n;setTimeout(()=>{gi(n)?this.events.emit(Dt("session_ping",a),{}):Hr(n)&&this.events.emit(Dt("session_ping",a),{error:n.error})},500)},this.onSessionDeleteRequest=async(r,n)=>{const{id:a}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),await Promise.all([new Promise(h=>{this.client.core.relayer.once(Jt.publish,async()=>{h(await this.deleteSession(r))})}),this.sendResult({id:a,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:a,topic:r})}catch(h){this.client.logger.error(h)}},this.onSessionRequest=async(r,n)=>{const{id:a,params:h}=n;try{this.isValidRequest(fr({topic:r},h));const f=xn(JSON.stringify(Pn("wc_sessionRequest",h,a))),g=this.client.session.get(r),b=await this.getVerifyContext(f,g.peer.metadata),y={id:a,topic:r,params:h,verifyContext:b};await this.setPendingSessionRequest(y),this.addSessionRequestToSessionRequestQueue(y),this.processSessionRequestQueue()}catch(f){await this.sendError(a,r,f),this.client.logger.error(f)}},this.onSessionRequestResponse=(r,n)=>{const{id:a}=n;gi(n)?this.events.emit(Dt("session_request",a),{result:n.result}):Hr(n)&&this.events.emit(Dt("session_request",a),{error:n.error})},this.onSessionEventRequest=async(r,n)=>{const{id:a,params:h}=n;try{const f=`${r}_session_event_${h.event.name}`,g=wo.get(f);if(g&&this.isRequestOutOfSync(g,a)){this.client.logger.info(`Discarding out of sync request - ${a}`);return}this.isValidEmit(fr({topic:r},h)),this.client.events.emit("session_event",{id:a,topic:r,params:h}),wo.set(f,a)}catch(f){await this.sendError(a,r,f),this.client.logger.error(f)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=di.idle,this.processSessionRequestQueue()},re.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===di.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=di.active,this.client.events.emit("session_request",r)}catch(n){this.client.logger.error(n)}},this.onPairingCreated=r=>{if(r.active)return;const n=this.client.proposal.getAll().find(a=>a.pairingTopic===r.topic);n&&this.onSessionProposeRequest(r.topic,Pn("wc_sessionPropose",{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties},n.id))},this.isValidConnect=async r=>{if(!dr(r)){const{message:b}=J("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(b)}const{pairingTopic:n,requiredNamespaces:a,optionalNamespaces:h,sessionProperties:f,relays:g}=r;if(ir(n)||await this.isValidPairingTopic(n),!Mb(g,!0)){const{message:b}=J("MISSING_OR_INVALID",`connect() relays: ${g}`);throw new Error(b)}!ir(a)&&Sn(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!ir(h)&&Sn(h)!==0&&this.validateNamespaces(h,"optionalNamespaces"),ir(f)||this.validateSessionProps(f,"sessionProperties")},this.validateNamespaces=(r,n)=>{const a=Lb(r,"connect()",n);if(a)throw new Error(a.message)},this.isValidApprove=async r=>{if(!dr(r))throw new Error(J("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:a,relayProtocol:h,sessionProperties:f}=r;await this.isValidProposalId(n);const g=this.client.proposal.get(n),b=Po(a,"approve()");if(b)throw new Error(b.message);const y=bl(g.requiredNamespaces,a,"approve()");if(y)throw new Error(y.message);if(!Ht(h,!0)){const{message:E}=J("MISSING_OR_INVALID",`approve() relayProtocol: ${h}`);throw new Error(E)}ir(f)||this.validateSessionProps(f,"sessionProperties")},this.isValidReject=async r=>{if(!dr(r)){const{message:h}=J("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(h)}const{id:n,reason:a}=r;if(await this.isValidProposalId(n),!Ub(a)){const{message:h}=J("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(h)}},this.isValidSessionSettleRequest=r=>{if(!dr(r)){const{message:y}=J("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(y)}const{relay:n,controller:a,namespaces:h,expiry:f}=r;if(!Kf(n)){const{message:y}=J("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(y)}const g=Tb(a,"onSessionSettleRequest()");if(g)throw new Error(g.message);const b=Po(h,"onSessionSettleRequest()");if(b)throw new Error(b.message);if(Ti(f)){const{message:y}=J("EXPIRED","onSessionSettleRequest()");throw new Error(y)}},this.isValidUpdate=async r=>{if(!dr(r)){const{message:b}=J("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(b)}const{topic:n,namespaces:a}=r;await this.isValidSessionTopic(n);const h=this.client.session.get(n),f=Po(a,"update()");if(f)throw new Error(f.message);const g=bl(h.requiredNamespaces,a,"update()");if(g)throw new Error(g.message)},this.isValidExtend=async r=>{if(!dr(r)){const{message:a}=J("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(a)}const{topic:n}=r;await this.isValidSessionTopic(n)},this.isValidRequest=async r=>{if(!dr(r)){const{message:b}=J("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(b)}const{topic:n,request:a,chainId:h,expiry:f}=r;await this.isValidSessionTopic(n);const{namespaces:g}=this.client.session.get(n);if(!wl(g,h)){const{message:b}=J("MISSING_OR_INVALID",`request() chainId: ${h}`);throw new Error(b)}if(!qb(a)){const{message:b}=J("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(b)}if(!Hb(g,h,a.method)){const{message:b}=J("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(b)}if(f&&!Fb(f,Ic)){const{message:b}=J("MISSING_OR_INVALID",`request() expiry: ${f}. Expiry must be a number (in seconds) between ${Ic.min} and ${Ic.max}`);throw new Error(b)}},this.isValidRespond=async r=>{if(!dr(r)){const{message:h}=J("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(h)}const{topic:n,response:a}=r;if(await this.isValidSessionTopic(n),!zb(a)){const{message:h}=J("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(h)}},this.isValidPing=async r=>{if(!dr(r)){const{message:a}=J("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(a)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async r=>{if(!dr(r)){const{message:g}=J("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(g)}const{topic:n,event:a,chainId:h}=r;await this.isValidSessionTopic(n);const{namespaces:f}=this.client.session.get(n);if(!wl(f,h)){const{message:g}=J("MISSING_OR_INVALID",`emit() chainId: ${h}`);throw new Error(g)}if(!kb(a)){const{message:g}=J("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(g)}if(!Kb(f,h,a.name)){const{message:g}=J("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(g)}},this.isValidDisconnect=async r=>{if(!dr(r)){const{message:a}=J("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(a)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(r,n)=>{const a={verified:{verifyUrl:n.verifyUrl||In,validation:"UNKNOWN",origin:n.url||""}};try{const h=await this.client.core.verify.resolve({attestationId:r,verifyUrl:n.verifyUrl});h&&(a.verified.origin=h.origin,a.verified.isScam=h.isScam,a.verified.validation=h.origin===new URL(n.url).origin?"VALID":"INVALID")}catch(h){this.client.logger.info(h)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(r,n)=>{Object.values(r).forEach(a=>{if(!Ht(a,!1)){const{message:h}=J("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(h)}})}}async isInitialized(){if(!this.initialized){const{message:t}=J("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Jt.message,async t=>{const{topic:r,message:n}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const a=await this.client.core.crypto.decode(r,n);try{Zc(a)?(this.client.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):jo(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.client.core.history.delete(r,a.id)):this.onRelayEventUnknownPayload({topic:r,payload:a})}catch(h){this.client.logger.error(h)}})}registerExpirerEvents(){this.client.core.expirer.on(Nr.expired,async t=>{const{topic:r,id:n}=kf(t.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,J("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(ss.create,t=>this.onPairingCreated(t))}isValidPairingTopic(t){if(!Ht(t,!1)){const{message:r}=J("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=J("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(Ti(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=J("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!Ht(t,!1)){const{message:r}=J("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=J("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(Ti(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=J("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(Ht(t,!1)){const{message:r}=J("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=J("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!jb(t)){const{message:r}=J("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=J("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(Ti(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=J("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class vx extends qo{constructor(t,r){super(t,r,ox,ru),this.core=t,this.logger=r}}class mx extends qo{constructor(t,r){super(t,r,ax,ru),this.core=t,this.logger=r}}class wx extends qo{constructor(t,r){super(t,r,ux,ru,n=>n.id),this.core=t,this.logger=r}}let bx=class xp extends G_{constructor(t){super(t),this.protocol=bp,this.version=_p,this.name=Ec.name,this.events=new $r.EventEmitter,this.on=(n,a)=>this.events.on(n,a),this.once=(n,a)=>this.events.once(n,a),this.off=(n,a)=>this.events.off(n,a),this.removeListener=(n,a)=>this.events.removeListener(n,a),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(a){throw this.logger.error(a.message),a}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(a){throw this.logger.error(a.message),a}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(a){throw this.logger.error(a.message),a}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(a){throw this.logger.error(a.message),a}},this.update=async n=>{try{return await this.engine.update(n)}catch(a){throw this.logger.error(a.message),a}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(a){throw this.logger.error(a.message),a}},this.request=async n=>{try{return await this.engine.request(n)}catch(a){throw this.logger.error(a.message),a}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(a){throw this.logger.error(a.message),a}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(a){throw this.logger.error(a.message),a}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(a){throw this.logger.error(a.message),a}},this.find=n=>{try{return this.engine.find(n)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=(t==null?void 0:t.name)||Ec.name,this.metadata=(t==null?void 0:t.metadata)||eb();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ae.pino(Ae.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||Ec.logger}));this.core=(t==null?void 0:t.core)||new sx(t),this.logger=Ae.generateChildLogger(r,this.name),this.session=new mx(this.core,this.logger),this.proposal=new vx(this.core,this.logger),this.pendingRequest=new wx(this.core,this.logger),this.engine=new yx(this)}static async init(t){const r=new xp(t);return await r.initialize(),r}get context(){return Ae.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var jc={exports:{}};(function(s,t){var r=typeof self<"u"?self:Kr,n=function(){function h(){this.fetch=!1,this.DOMException=r.DOMException}return h.prototype=r,new h}();(function(h){(function(f){var g={searchParams:"URLSearchParams"in h,iterable:"Symbol"in h&&"iterator"in Symbol,blob:"FileReader"in h&&"Blob"in h&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in h,arrayBuffer:"ArrayBuffer"in h};function b(m){return m&&DataView.prototype.isPrototypeOf(m)}if(g.arrayBuffer)var y=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],E=ArrayBuffer.isView||function(m){return m&&y.indexOf(Object.prototype.toString.call(m))>-1};function O(m){if(typeof m!="string"&&(m=String(m)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(m))throw new TypeError("Invalid character in header field name");return m.toLowerCase()}function C(m){return typeof m!="string"&&(m=String(m)),m}function q(m){var x={next:function(){var X=m.shift();return{done:X===void 0,value:X}}};return g.iterable&&(x[Symbol.iterator]=function(){return x}),x}function A(m){this.map={},m instanceof A?m.forEach(function(x,X){this.append(X,x)},this):Array.isArray(m)?m.forEach(function(x){this.append(x[0],x[1])},this):m&&Object.getOwnPropertyNames(m).forEach(function(x){this.append(x,m[x])},this)}A.prototype.append=function(m,x){m=O(m),x=C(x);var X=this.map[m];this.map[m]=X?X+", "+x:x},A.prototype.delete=function(m){delete this.map[O(m)]},A.prototype.get=function(m){return m=O(m),this.has(m)?this.map[m]:null},A.prototype.has=function(m){return this.map.hasOwnProperty(O(m))},A.prototype.set=function(m,x){this.map[O(m)]=C(x)},A.prototype.forEach=function(m,x){for(var X in this.map)this.map.hasOwnProperty(X)&&m.call(x,this.map[X],X,this)},A.prototype.keys=function(){var m=[];return this.forEach(function(x,X){m.push(X)}),q(m)},A.prototype.values=function(){var m=[];return this.forEach(function(x){m.push(x)}),q(m)},A.prototype.entries=function(){var m=[];return this.forEach(function(x,X){m.push([X,x])}),q(m)},g.iterable&&(A.prototype[Symbol.iterator]=A.prototype.entries);function V(m){if(m.bodyUsed)return Promise.reject(new TypeError("Already read"));m.bodyUsed=!0}function ie(m){return new Promise(function(x,X){m.onload=function(){x(m.result)},m.onerror=function(){X(m.error)}})}function he(m){var x=new FileReader,X=ie(x);return x.readAsArrayBuffer(m),X}function le(m){var x=new FileReader,X=ie(x);return x.readAsText(m),X}function fe(m){for(var x=new Uint8Array(m),X=new Array(x.length),ce=0;ce<x.length;ce++)X[ce]=String.fromCharCode(x[ce]);return X.join("")}function pe(m){if(m.slice)return m.slice(0);var x=new Uint8Array(m.byteLength);return x.set(new Uint8Array(m)),x.buffer}function de(){return this.bodyUsed=!1,this._initBody=function(m){this._bodyInit=m,m?typeof m=="string"?this._bodyText=m:g.blob&&Blob.prototype.isPrototypeOf(m)?this._bodyBlob=m:g.formData&&FormData.prototype.isPrototypeOf(m)?this._bodyFormData=m:g.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)?this._bodyText=m.toString():g.arrayBuffer&&g.blob&&b(m)?(this._bodyArrayBuffer=pe(m.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):g.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(m)||E(m))?this._bodyArrayBuffer=pe(m):this._bodyText=m=Object.prototype.toString.call(m):this._bodyText="",this.headers.get("content-type")||(typeof m=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):g.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},g.blob&&(this.blob=function(){var m=V(this);if(m)return m;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?V(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(he)}),this.text=function(){var m=V(this);if(m)return m;if(this._bodyBlob)return le(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(fe(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},g.formData&&(this.formData=function(){return this.text().then(ve)}),this.json=function(){return this.text().then(JSON.parse)},this}var L=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function k(m){var x=m.toUpperCase();return L.indexOf(x)>-1?x:m}function G(m,x){x=x||{};var X=x.body;if(m instanceof G){if(m.bodyUsed)throw new TypeError("Already read");this.url=m.url,this.credentials=m.credentials,x.headers||(this.headers=new A(m.headers)),this.method=m.method,this.mode=m.mode,this.signal=m.signal,!X&&m._bodyInit!=null&&(X=m._bodyInit,m.bodyUsed=!0)}else this.url=String(m);if(this.credentials=x.credentials||this.credentials||"same-origin",(x.headers||!this.headers)&&(this.headers=new A(x.headers)),this.method=k(x.method||this.method||"GET"),this.mode=x.mode||this.mode||null,this.signal=x.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&X)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(X)}G.prototype.clone=function(){return new G(this,{body:this._bodyInit})};function ve(m){var x=new FormData;return m.trim().split("&").forEach(function(X){if(X){var ce=X.split("="),F=ce.shift().replace(/\+/g," "),H=ce.join("=").replace(/\+/g," ");x.append(decodeURIComponent(F),decodeURIComponent(H))}}),x}function ne(m){var x=new A,X=m.replace(/\r?\n[\t ]+/g," ");return X.split(/\r?\n/).forEach(function(ce){var F=ce.split(":"),H=F.shift().trim();if(H){var B=F.join(":").trim();x.append(H,B)}}),x}de.call(G.prototype);function ue(m,x){x||(x={}),this.type="default",this.status=x.status===void 0?200:x.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in x?x.statusText:"OK",this.headers=new A(x.headers),this.url=x.url||"",this._initBody(m)}de.call(ue.prototype),ue.prototype.clone=function(){return new ue(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new A(this.headers),url:this.url})},ue.error=function(){var m=new ue(null,{status:0,statusText:""});return m.type="error",m};var Ce=[301,302,303,307,308];ue.redirect=function(m,x){if(Ce.indexOf(x)===-1)throw new RangeError("Invalid status code");return new ue(null,{status:x,headers:{location:m}})},f.DOMException=h.DOMException;try{new f.DOMException}catch{f.DOMException=function(x,X){this.message=x,this.name=X;var ce=Error(x);this.stack=ce.stack},f.DOMException.prototype=Object.create(Error.prototype),f.DOMException.prototype.constructor=f.DOMException}function ze(m,x){return new Promise(function(X,ce){var F=new G(m,x);if(F.signal&&F.signal.aborted)return ce(new f.DOMException("Aborted","AbortError"));var H=new XMLHttpRequest;function B(){H.abort()}H.onload=function(){var W={status:H.status,statusText:H.statusText,headers:ne(H.getAllResponseHeaders()||"")};W.url="responseURL"in H?H.responseURL:W.headers.get("X-Request-URL");var Je="response"in H?H.response:H.responseText;X(new ue(Je,W))},H.onerror=function(){ce(new TypeError("Network request failed"))},H.ontimeout=function(){ce(new TypeError("Network request failed"))},H.onabort=function(){ce(new f.DOMException("Aborted","AbortError"))},H.open(F.method,F.url,!0),F.credentials==="include"?H.withCredentials=!0:F.credentials==="omit"&&(H.withCredentials=!1),"responseType"in H&&g.blob&&(H.responseType="blob"),F.headers.forEach(function(W,Je){H.setRequestHeader(Je,W)}),F.signal&&(F.signal.addEventListener("abort",B),H.onreadystatechange=function(){H.readyState===4&&F.signal.removeEventListener("abort",B)}),H.send(typeof F._bodyInit>"u"?null:F._bodyInit)})}return ze.polyfill=!0,h.fetch||(h.fetch=ze,h.Headers=A,h.Request=G,h.Response=ue),f.Headers=A,f.Request=G,f.Response=ue,f.fetch=ze,Object.defineProperty(f,"__esModule",{value:!0}),f})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var a=n;t=a.fetch,t.default=a.fetch,t.fetch=a.fetch,t.Headers=a.Headers,t.Request=a.Request,t.Response=a.Response,s.exports=t})(jc,jc.exports);var _x=jc.exports;const pf=Af(_x),Ex={Accept:"application/json","Content-Type":"application/json"},Ix="POST",df={headers:Ex,method:Ix},gf=10;class Ni{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new $r.EventEmitter,this.isAvailable=!1,this.registering=!1,!kl(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t,r){this.isAvailable||await this.register();try{const n=Qi(t),h=await(await pf(this.url,Object.assign(Object.assign({},df),{body:n}))).json();this.onPayload({data:h})}catch(n){this.onError(t.id,n)}}async register(t=this.url){if(!kl(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,a)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),a(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return a(new Error("HTTP connection is missing or invalid"));n()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const r=Qi({id:1,jsonrpc:"2.0",method:"test",params:[]});await pf(t,Object.assign(Object.assign({},df),{body:r}))}this.onOpen()}catch(r){const n=this.parseError(r);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?fs(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const n=this.parseError(r),a=n.message||n.toString(),h=Mo(t,a);this.events.emit("payload",h)}parseError(t,r=this.url){return tp(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>gf&&this.events.setMaxListeners(gf)}}const yf="error",xx="wss://relay.walletconnect.com",Sx="wc",Px="universal_provider",vf=`${Sx}@2:${Px}:`,Ox="https://rpc.walletconnect.com/v1/",vi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var is=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Uc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(s,t){(function(){var r,n="4.17.21",a=200,h="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",f="Expected a function",g="Invalid `variable` option passed into `_.template`",b="__lodash_hash_undefined__",y=500,E="__lodash_placeholder__",O=1,C=2,q=4,A=1,V=2,ie=1,he=2,le=4,fe=8,pe=16,de=32,L=64,k=128,G=256,ve=512,ne=30,ue="...",Ce=800,ze=16,m=1,x=2,X=3,ce=1/0,F=9007199254740991,H=17976931348623157e292,B=NaN,W=4294967295,Je=W-1,Ke=W>>>1,Br=[["ary",k],["bind",ie],["bindKey",he],["curry",fe],["curryRight",pe],["flip",ve],["partial",de],["partialRight",L],["rearg",G]],Ie="[object Arguments]",xt="[object Array]",D="[object AsyncFunction]",$="[object Boolean]",T="[object Date]",u="[object DOMException]",I="[object Error]",ee="[object Function]",ge="[object GeneratorFunction]",_e="[object Map]",Ne="[object Number]",De="[object Null]",Pe="[object Object]",St="[object Promise]",mt="[object Proxy]",ot="[object RegExp]",Me="[object Set]",Ye="[object String]",Xe="[object Symbol]",at="[object Undefined]",ke="[object WeakMap]",Ze="[object WeakSet]",$e="[object ArrayBuffer]",Be="[object DataView]",ht="[object Float32Array]",Ue="[object Float64Array]",Pt="[object Int8Array]",Lt="[object Int16Array]",Kt="[object Int32Array]",Bt="[object Uint8Array]",Ut="[object Uint8ClampedArray]",Qt="[object Uint16Array]",or="[object Uint32Array]",Vr=/\b__p \+= '';/g,Yt=/\b(__p \+=) '' \+/g,Zr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,mi=/&(?:amp|lt|gt|quot|#39);/g,$i=/[&<>"']/g,lt=RegExp(mi.source),rt=RegExp($i.source),ft=/<%-([\s\S]+?)%>/g,pt=/<%([\s\S]+?)%>/g,ct=/<%=([\s\S]+?)%>/g,it=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ot=/^\w*$/,Rt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,dt=/[\\^$.*+?()[\]{}|]/g,Tt=RegExp(dt.source),gt=/^\s+/,wt=/\s/,yt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Qe=/\{\n\/\* \[wrapped with (.+)\] \*/,At=/,? & /,Ct=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,zo=/[()=,{}\[\]\/\s]/,ko=/\\(\\)?/g,Ho=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ir=/\w*$/,Ko=/^[-+]0x[0-9a-f]+$/i,Bo=/^0b[01]+$/i,Vo=/^\[object .+?Constructor\]$/,Fo=/^0o[0-7]+$/i,Wo=/^(?:0|[1-9]\d*)$/,ei=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,tn=/($^)/,Go=/['\n\r\u2028\u2029\\]/g,rn="\\ud800-\\udfff",Jo="\\u0300-\\u036f",Qo="\\ufe20-\\ufe2f",nn="\\u20d0-\\u20ff",ds=Jo+Qo+nn,gs="\\u2700-\\u27bf",Dr="a-z\\xdf-\\xf6\\xf8-\\xff",Yo="\\xac\\xb1\\xd7\\xf7",Xo="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Zo="\\u2000-\\u206f",ea=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ys="A-Z\\xc0-\\xd6\\xd8-\\xde",vs="\\ufe0e\\ufe0f",Di=Yo+Xo+Zo+ea,Nn="['’]",Li="["+rn+"]",$n="["+Di+"]",Mi="["+ds+"]",ms="\\d+",ta="["+gs+"]",ws="["+Dr+"]",bs="[^"+rn+Di+ms+gs+Dr+ys+"]",sn="\\ud83c[\\udffb-\\udfff]",ra="(?:"+Mi+"|"+sn+")",_s="[^"+rn+"]",on="(?:\\ud83c[\\udde6-\\uddff]){2}",wi="[\\ud800-\\udbff][\\udc00-\\udfff]",yr="["+ys+"]",Es="\\u200d",Is="(?:"+ws+"|"+bs+")",Fr="(?:"+yr+"|"+bs+")",xs="(?:"+Nn+"(?:d|ll|m|re|s|t|ve))?",Ss="(?:"+Nn+"(?:D|LL|M|RE|S|T|VE))?",Ps=ra+"?",Os="["+vs+"]?",ia="(?:"+Es+"(?:"+[_s,on,wi].join("|")+")"+Os+Ps+")*",ti="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Rs="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ts=Os+Ps+ia,an="(?:"+[ta,on,wi].join("|")+")"+Ts,na="(?:"+[_s+Mi+"?",Mi,on,wi,Li].join("|")+")",Dn=RegExp(Nn,"g"),sa=RegExp(Mi,"g"),cn=RegExp(sn+"(?="+sn+")|"+na+Ts,"g"),As=RegExp([yr+"?"+ws+"+"+xs+"(?="+[$n,yr,"$"].join("|")+")",Fr+"+"+Ss+"(?="+[$n,yr+Is,"$"].join("|")+")",yr+"?"+Is+"+"+xs,yr+"+"+Ss,Rs,ti,ms,an].join("|"),"g"),Cs=RegExp("["+Es+rn+ds+vs+"]"),ji=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ns=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],oa=-1,Ve={};Ve[ht]=Ve[Ue]=Ve[Pt]=Ve[Lt]=Ve[Kt]=Ve[Bt]=Ve[Ut]=Ve[Qt]=Ve[or]=!0,Ve[Ie]=Ve[xt]=Ve[$e]=Ve[$]=Ve[Be]=Ve[T]=Ve[I]=Ve[ee]=Ve[_e]=Ve[Ne]=Ve[Pe]=Ve[ot]=Ve[Me]=Ve[Ye]=Ve[ke]=!1;var He={};He[Ie]=He[xt]=He[$e]=He[Be]=He[$]=He[T]=He[ht]=He[Ue]=He[Pt]=He[Lt]=He[Kt]=He[_e]=He[Ne]=He[Pe]=He[ot]=He[Me]=He[Ye]=He[Xe]=He[Bt]=He[Ut]=He[Qt]=He[or]=!0,He[I]=He[ee]=He[ke]=!1;var v={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},S={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},z={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Y={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Fe=parseFloat,me=parseInt,et=typeof is=="object"&&is&&is.Object===Object&&is,Nt=typeof self=="object"&&self&&self.Object===Object&&self,Re=et||Nt||Function("return this")(),We=t&&!t.nodeType&&t,bt=We&&!0&&s&&!s.nodeType&&s,ar=bt&&bt.exports===We,$t=ar&&et.process,tt=function(){try{var P=bt&&bt.require&&bt.require("util").types;return P||$t&&$t.binding&&$t.binding("util")}catch{}}(),Xt=tt&&tt.isArrayBuffer,Lr=tt&&tt.isDate,xr=tt&&tt.isMap,Wr=tt&&tt.isRegExp,Ln=tt&&tt.isSet,Ui=tt&&tt.isTypedArray;function qt(P,M,N){switch(N.length){case 0:return P.call(M);case 1:return P.call(M,N[0]);case 2:return P.call(M,N[0],N[1]);case 3:return P.call(M,N[0],N[1],N[2])}return P.apply(M,N)}function Op(P,M,N,Z){for(var ye=-1,Le=P==null?0:P.length;++ye<Le;){var Mt=P[ye];M(Z,Mt,N(Mt),P)}return Z}function Sr(P,M){for(var N=-1,Z=P==null?0:P.length;++N<Z&&M(P[N],N,P)!==!1;);return P}function Rp(P,M){for(var N=P==null?0:P.length;N--&&M(P[N],N,P)!==!1;);return P}function su(P,M){for(var N=-1,Z=P==null?0:P.length;++N<Z;)if(!M(P[N],N,P))return!1;return!0}function bi(P,M){for(var N=-1,Z=P==null?0:P.length,ye=0,Le=[];++N<Z;){var Mt=P[N];M(Mt,N,P)&&(Le[ye++]=Mt)}return Le}function $s(P,M){var N=P==null?0:P.length;return!!N&&un(P,M,0)>-1}function aa(P,M,N){for(var Z=-1,ye=P==null?0:P.length;++Z<ye;)if(N(M,P[Z]))return!0;return!1}function nt(P,M){for(var N=-1,Z=P==null?0:P.length,ye=Array(Z);++N<Z;)ye[N]=M(P[N],N,P);return ye}function _i(P,M){for(var N=-1,Z=M.length,ye=P.length;++N<Z;)P[ye+N]=M[N];return P}function ca(P,M,N,Z){var ye=-1,Le=P==null?0:P.length;for(Z&&Le&&(N=P[++ye]);++ye<Le;)N=M(N,P[ye],ye,P);return N}function Tp(P,M,N,Z){var ye=P==null?0:P.length;for(Z&&ye&&(N=P[--ye]);ye--;)N=M(N,P[ye],ye,P);return N}function ua(P,M){for(var N=-1,Z=P==null?0:P.length;++N<Z;)if(M(P[N],N,P))return!0;return!1}var Ap=ha("length");function Cp(P){return P.split("")}function Np(P){return P.match(Ct)||[]}function ou(P,M,N){var Z;return N(P,function(ye,Le,Mt){if(M(ye,Le,Mt))return Z=Le,!1}),Z}function Ds(P,M,N,Z){for(var ye=P.length,Le=N+(Z?1:-1);Z?Le--:++Le<ye;)if(M(P[Le],Le,P))return Le;return-1}function un(P,M,N){return M===M?Bp(P,M,N):Ds(P,au,N)}function $p(P,M,N,Z){for(var ye=N-1,Le=P.length;++ye<Le;)if(Z(P[ye],M))return ye;return-1}function au(P){return P!==P}function cu(P,M){var N=P==null?0:P.length;return N?fa(P,M)/N:B}function ha(P){return function(M){return M==null?r:M[P]}}function la(P){return function(M){return P==null?r:P[M]}}function uu(P,M,N,Z,ye){return ye(P,function(Le,Mt,Ge){N=Z?(Z=!1,Le):M(N,Le,Mt,Ge)}),N}function Dp(P,M){var N=P.length;for(P.sort(M);N--;)P[N]=P[N].value;return P}function fa(P,M){for(var N,Z=-1,ye=P.length;++Z<ye;){var Le=M(P[Z]);Le!==r&&(N=N===r?Le:N+Le)}return N}function pa(P,M){for(var N=-1,Z=Array(P);++N<P;)Z[N]=M(N);return Z}function Lp(P,M){return nt(M,function(N){return[N,P[N]]})}function hu(P){return P&&P.slice(0,du(P)+1).replace(gt,"")}function vr(P){return function(M){return P(M)}}function da(P,M){return nt(M,function(N){return P[N]})}function Mn(P,M){return P.has(M)}function lu(P,M){for(var N=-1,Z=P.length;++N<Z&&un(M,P[N],0)>-1;);return N}function fu(P,M){for(var N=P.length;N--&&un(M,P[N],0)>-1;);return N}function Mp(P,M){for(var N=P.length,Z=0;N--;)P[N]===M&&++Z;return Z}var jp=la(v),Up=la(S);function qp(P){return"\\"+Y[P]}function zp(P,M){return P==null?r:P[M]}function hn(P){return Cs.test(P)}function kp(P){return ji.test(P)}function Hp(P){for(var M,N=[];!(M=P.next()).done;)N.push(M.value);return N}function ga(P){var M=-1,N=Array(P.size);return P.forEach(function(Z,ye){N[++M]=[ye,Z]}),N}function pu(P,M){return function(N){return P(M(N))}}function Ei(P,M){for(var N=-1,Z=P.length,ye=0,Le=[];++N<Z;){var Mt=P[N];(Mt===M||Mt===E)&&(P[N]=E,Le[ye++]=N)}return Le}function Ls(P){var M=-1,N=Array(P.size);return P.forEach(function(Z){N[++M]=Z}),N}function Kp(P){var M=-1,N=Array(P.size);return P.forEach(function(Z){N[++M]=[Z,Z]}),N}function Bp(P,M,N){for(var Z=N-1,ye=P.length;++Z<ye;)if(P[Z]===M)return Z;return-1}function Vp(P,M,N){for(var Z=N+1;Z--;)if(P[Z]===M)return Z;return Z}function ln(P){return hn(P)?Wp(P):Ap(P)}function Mr(P){return hn(P)?Gp(P):Cp(P)}function du(P){for(var M=P.length;M--&&wt.test(P.charAt(M)););return M}var Fp=la(z);function Wp(P){for(var M=cn.lastIndex=0;cn.test(P);)++M;return M}function Gp(P){return P.match(cn)||[]}function Jp(P){return P.match(As)||[]}var Qp=function P(M){M=M==null?Re:fn.defaults(Re.Object(),M,fn.pick(Re,Ns));var N=M.Array,Z=M.Date,ye=M.Error,Le=M.Function,Mt=M.Math,Ge=M.Object,ya=M.RegExp,Yp=M.String,Pr=M.TypeError,Ms=N.prototype,Xp=Le.prototype,pn=Ge.prototype,js=M["__core-js_shared__"],Us=Xp.toString,qe=pn.hasOwnProperty,Zp=0,gu=function(){var e=/[^.]+$/.exec(js&&js.keys&&js.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),qs=pn.toString,ed=Us.call(Ge),td=Re._,rd=ya("^"+Us.call(qe).replace(dt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),zs=ar?M.Buffer:r,Ii=M.Symbol,ks=M.Uint8Array,yu=zs?zs.allocUnsafe:r,Hs=pu(Ge.getPrototypeOf,Ge),vu=Ge.create,mu=pn.propertyIsEnumerable,Ks=Ms.splice,wu=Ii?Ii.isConcatSpreadable:r,jn=Ii?Ii.iterator:r,qi=Ii?Ii.toStringTag:r,Bs=function(){try{var e=Bi(Ge,"defineProperty");return e({},"",{}),e}catch{}}(),id=M.clearTimeout!==Re.clearTimeout&&M.clearTimeout,nd=Z&&Z.now!==Re.Date.now&&Z.now,sd=M.setTimeout!==Re.setTimeout&&M.setTimeout,Vs=Mt.ceil,Fs=Mt.floor,va=Ge.getOwnPropertySymbols,od=zs?zs.isBuffer:r,bu=M.isFinite,ad=Ms.join,cd=pu(Ge.keys,Ge),jt=Mt.max,Wt=Mt.min,ud=Z.now,hd=M.parseInt,_u=Mt.random,ld=Ms.reverse,ma=Bi(M,"DataView"),Un=Bi(M,"Map"),wa=Bi(M,"Promise"),dn=Bi(M,"Set"),qn=Bi(M,"WeakMap"),zn=Bi(Ge,"create"),Ws=qn&&new qn,gn={},fd=Vi(ma),pd=Vi(Un),dd=Vi(wa),gd=Vi(dn),yd=Vi(qn),Gs=Ii?Ii.prototype:r,kn=Gs?Gs.valueOf:r,Eu=Gs?Gs.toString:r;function p(e){if(vt(e)&&!we(e)&&!(e instanceof Oe)){if(e instanceof Or)return e;if(qe.call(e,"__wrapped__"))return Ih(e)}return new Or(e)}var yn=function(){function e(){}return function(i){if(!ut(i))return{};if(vu)return vu(i);e.prototype=i;var o=new e;return e.prototype=r,o}}();function Js(){}function Or(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}p.templateSettings={escape:ft,evaluate:pt,interpolate:ct,variable:"",imports:{_:p}},p.prototype=Js.prototype,p.prototype.constructor=p,Or.prototype=yn(Js.prototype),Or.prototype.constructor=Or;function Oe(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=W,this.__views__=[]}function vd(){var e=new Oe(this.__wrapped__);return e.__actions__=cr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=cr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=cr(this.__views__),e}function md(){if(this.__filtered__){var e=new Oe(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function wd(){var e=this.__wrapped__.value(),i=this.__dir__,o=we(e),c=i<0,l=o?e.length:0,d=Cg(0,l,this.__views__),w=d.start,_=d.end,R=_-w,j=c?_:w-1,U=this.__iteratees__,K=U.length,Q=0,te=Wt(R,this.__takeCount__);if(!o||!c&&l==R&&te==R)return Fu(e,this.__actions__);var oe=[];e:for(;R--&&Q<te;){j+=i;for(var Ee=-1,ae=e[j];++Ee<K;){var Se=U[Ee],Te=Se.iteratee,br=Se.type,tr=Te(ae);if(br==x)ae=tr;else if(!tr){if(br==m)continue e;break e}}oe[Q++]=ae}return oe}Oe.prototype=yn(Js.prototype),Oe.prototype.constructor=Oe;function zi(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function bd(){this.__data__=zn?zn(null):{},this.size=0}function _d(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function Ed(e){var i=this.__data__;if(zn){var o=i[e];return o===b?r:o}return qe.call(i,e)?i[e]:r}function Id(e){var i=this.__data__;return zn?i[e]!==r:qe.call(i,e)}function xd(e,i){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=zn&&i===r?b:i,this}zi.prototype.clear=bd,zi.prototype.delete=_d,zi.prototype.get=Ed,zi.prototype.has=Id,zi.prototype.set=xd;function ri(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function Sd(){this.__data__=[],this.size=0}function Pd(e){var i=this.__data__,o=Qs(i,e);if(o<0)return!1;var c=i.length-1;return o==c?i.pop():Ks.call(i,o,1),--this.size,!0}function Od(e){var i=this.__data__,o=Qs(i,e);return o<0?r:i[o][1]}function Rd(e){return Qs(this.__data__,e)>-1}function Td(e,i){var o=this.__data__,c=Qs(o,e);return c<0?(++this.size,o.push([e,i])):o[c][1]=i,this}ri.prototype.clear=Sd,ri.prototype.delete=Pd,ri.prototype.get=Od,ri.prototype.has=Rd,ri.prototype.set=Td;function ii(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function Ad(){this.size=0,this.__data__={hash:new zi,map:new(Un||ri),string:new zi}}function Cd(e){var i=co(this,e).delete(e);return this.size-=i?1:0,i}function Nd(e){return co(this,e).get(e)}function $d(e){return co(this,e).has(e)}function Dd(e,i){var o=co(this,e),c=o.size;return o.set(e,i),this.size+=o.size==c?0:1,this}ii.prototype.clear=Ad,ii.prototype.delete=Cd,ii.prototype.get=Nd,ii.prototype.has=$d,ii.prototype.set=Dd;function ki(e){var i=-1,o=e==null?0:e.length;for(this.__data__=new ii;++i<o;)this.add(e[i])}function Ld(e){return this.__data__.set(e,b),this}function Md(e){return this.__data__.has(e)}ki.prototype.add=ki.prototype.push=Ld,ki.prototype.has=Md;function jr(e){var i=this.__data__=new ri(e);this.size=i.size}function jd(){this.__data__=new ri,this.size=0}function Ud(e){var i=this.__data__,o=i.delete(e);return this.size=i.size,o}function qd(e){return this.__data__.get(e)}function zd(e){return this.__data__.has(e)}function kd(e,i){var o=this.__data__;if(o instanceof ri){var c=o.__data__;if(!Un||c.length<a-1)return c.push([e,i]),this.size=++o.size,this;o=this.__data__=new ii(c)}return o.set(e,i),this.size=o.size,this}jr.prototype.clear=jd,jr.prototype.delete=Ud,jr.prototype.get=qd,jr.prototype.has=zd,jr.prototype.set=kd;function Iu(e,i){var o=we(e),c=!o&&Fi(e),l=!o&&!c&&Ri(e),d=!o&&!c&&!l&&bn(e),w=o||c||l||d,_=w?pa(e.length,Yp):[],R=_.length;for(var j in e)(i||qe.call(e,j))&&!(w&&(j=="length"||l&&(j=="offset"||j=="parent")||d&&(j=="buffer"||j=="byteLength"||j=="byteOffset")||ai(j,R)))&&_.push(j);return _}function xu(e){var i=e.length;return i?e[Aa(0,i-1)]:r}function Hd(e,i){return uo(cr(e),Hi(i,0,e.length))}function Kd(e){return uo(cr(e))}function ba(e,i,o){(o!==r&&!Ur(e[i],o)||o===r&&!(i in e))&&ni(e,i,o)}function Hn(e,i,o){var c=e[i];(!(qe.call(e,i)&&Ur(c,o))||o===r&&!(i in e))&&ni(e,i,o)}function Qs(e,i){for(var o=e.length;o--;)if(Ur(e[o][0],i))return o;return-1}function Bd(e,i,o,c){return xi(e,function(l,d,w){i(c,l,o(l),w)}),c}function Su(e,i){return e&&Jr(i,zt(i),e)}function Vd(e,i){return e&&Jr(i,hr(i),e)}function ni(e,i,o){i=="__proto__"&&Bs?Bs(e,i,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[i]=o}function _a(e,i){for(var o=-1,c=i.length,l=N(c),d=e==null;++o<c;)l[o]=d?r:tc(e,i[o]);return l}function Hi(e,i,o){return e===e&&(o!==r&&(e=e<=o?e:o),i!==r&&(e=e>=i?e:i)),e}function Rr(e,i,o,c,l,d){var w,_=i&O,R=i&C,j=i&q;if(o&&(w=l?o(e,c,l,d):o(e)),w!==r)return w;if(!ut(e))return e;var U=we(e);if(U){if(w=$g(e),!_)return cr(e,w)}else{var K=Gt(e),Q=K==ee||K==ge;if(Ri(e))return Ju(e,_);if(K==Pe||K==Ie||Q&&!l){if(w=R||Q?{}:dh(e),!_)return R?Eg(e,Vd(w,e)):_g(e,Su(w,e))}else{if(!He[K])return l?e:{};w=Dg(e,K,_)}}d||(d=new jr);var te=d.get(e);if(te)return te;d.set(e,w),Kh(e)?e.forEach(function(ae){w.add(Rr(ae,i,o,ae,e,d))}):kh(e)&&e.forEach(function(ae,Se){w.set(Se,Rr(ae,i,o,Se,e,d))});var oe=j?R?ka:za:R?hr:zt,Ee=U?r:oe(e);return Sr(Ee||e,function(ae,Se){Ee&&(Se=ae,ae=e[Se]),Hn(w,Se,Rr(ae,i,o,Se,e,d))}),w}function Fd(e){var i=zt(e);return function(o){return Pu(o,e,i)}}function Pu(e,i,o){var c=o.length;if(e==null)return!c;for(e=Ge(e);c--;){var l=o[c],d=i[l],w=e[l];if(w===r&&!(l in e)||!d(w))return!1}return!0}function Ou(e,i,o){if(typeof e!="function")throw new Pr(f);return Jn(function(){e.apply(r,o)},i)}function Kn(e,i,o,c){var l=-1,d=$s,w=!0,_=e.length,R=[],j=i.length;if(!_)return R;o&&(i=nt(i,vr(o))),c?(d=aa,w=!1):i.length>=a&&(d=Mn,w=!1,i=new ki(i));e:for(;++l<_;){var U=e[l],K=o==null?U:o(U);if(U=c||U!==0?U:0,w&&K===K){for(var Q=j;Q--;)if(i[Q]===K)continue e;R.push(U)}else d(i,K,c)||R.push(U)}return R}var xi=eh(Gr),Ru=eh(Ia,!0);function Wd(e,i){var o=!0;return xi(e,function(c,l,d){return o=!!i(c,l,d),o}),o}function Ys(e,i,o){for(var c=-1,l=e.length;++c<l;){var d=e[c],w=i(d);if(w!=null&&(_===r?w===w&&!wr(w):o(w,_)))var _=w,R=d}return R}function Gd(e,i,o,c){var l=e.length;for(o=be(o),o<0&&(o=-o>l?0:l+o),c=c===r||c>l?l:be(c),c<0&&(c+=l),c=o>c?0:Vh(c);o<c;)e[o++]=i;return e}function Tu(e,i){var o=[];return xi(e,function(c,l,d){i(c,l,d)&&o.push(c)}),o}function Vt(e,i,o,c,l){var d=-1,w=e.length;for(o||(o=Mg),l||(l=[]);++d<w;){var _=e[d];i>0&&o(_)?i>1?Vt(_,i-1,o,c,l):_i(l,_):c||(l[l.length]=_)}return l}var Ea=th(),Au=th(!0);function Gr(e,i){return e&&Ea(e,i,zt)}function Ia(e,i){return e&&Au(e,i,zt)}function Xs(e,i){return bi(i,function(o){return ci(e[o])})}function Ki(e,i){i=Pi(i,e);for(var o=0,c=i.length;e!=null&&o<c;)e=e[Qr(i[o++])];return o&&o==c?e:r}function Cu(e,i,o){var c=i(e);return we(e)?c:_i(c,o(e))}function Zt(e){return e==null?e===r?at:De:qi&&qi in Ge(e)?Ag(e):Kg(e)}function xa(e,i){return e>i}function Jd(e,i){return e!=null&&qe.call(e,i)}function Qd(e,i){return e!=null&&i in Ge(e)}function Yd(e,i,o){return e>=Wt(i,o)&&e<jt(i,o)}function Sa(e,i,o){for(var c=o?aa:$s,l=e[0].length,d=e.length,w=d,_=N(d),R=1/0,j=[];w--;){var U=e[w];w&&i&&(U=nt(U,vr(i))),R=Wt(U.length,R),_[w]=!o&&(i||l>=120&&U.length>=120)?new ki(w&&U):r}U=e[0];var K=-1,Q=_[0];e:for(;++K<l&&j.length<R;){var te=U[K],oe=i?i(te):te;if(te=o||te!==0?te:0,!(Q?Mn(Q,oe):c(j,oe,o))){for(w=d;--w;){var Ee=_[w];if(!(Ee?Mn(Ee,oe):c(e[w],oe,o)))continue e}Q&&Q.push(oe),j.push(te)}}return j}function Xd(e,i,o,c){return Gr(e,function(l,d,w){i(c,o(l),d,w)}),c}function Bn(e,i,o){i=Pi(i,e),e=mh(e,i);var c=e==null?e:e[Qr(Ar(i))];return c==null?r:qt(c,e,o)}function Nu(e){return vt(e)&&Zt(e)==Ie}function Zd(e){return vt(e)&&Zt(e)==$e}function eg(e){return vt(e)&&Zt(e)==T}function Vn(e,i,o,c,l){return e===i?!0:e==null||i==null||!vt(e)&&!vt(i)?e!==e&&i!==i:tg(e,i,o,c,Vn,l)}function tg(e,i,o,c,l,d){var w=we(e),_=we(i),R=w?xt:Gt(e),j=_?xt:Gt(i);R=R==Ie?Pe:R,j=j==Ie?Pe:j;var U=R==Pe,K=j==Pe,Q=R==j;if(Q&&Ri(e)){if(!Ri(i))return!1;w=!0,U=!1}if(Q&&!U)return d||(d=new jr),w||bn(e)?lh(e,i,o,c,l,d):Rg(e,i,R,o,c,l,d);if(!(o&A)){var te=U&&qe.call(e,"__wrapped__"),oe=K&&qe.call(i,"__wrapped__");if(te||oe){var Ee=te?e.value():e,ae=oe?i.value():i;return d||(d=new jr),l(Ee,ae,o,c,d)}}return Q?(d||(d=new jr),Tg(e,i,o,c,l,d)):!1}function rg(e){return vt(e)&&Gt(e)==_e}function Pa(e,i,o,c){var l=o.length,d=l,w=!c;if(e==null)return!d;for(e=Ge(e);l--;){var _=o[l];if(w&&_[2]?_[1]!==e[_[0]]:!(_[0]in e))return!1}for(;++l<d;){_=o[l];var R=_[0],j=e[R],U=_[1];if(w&&_[2]){if(j===r&&!(R in e))return!1}else{var K=new jr;if(c)var Q=c(j,U,R,e,i,K);if(!(Q===r?Vn(U,j,A|V,c,K):Q))return!1}}return!0}function $u(e){if(!ut(e)||Ug(e))return!1;var i=ci(e)?rd:Vo;return i.test(Vi(e))}function ig(e){return vt(e)&&Zt(e)==ot}function ng(e){return vt(e)&&Gt(e)==Me}function sg(e){return vt(e)&&yo(e.length)&&!!Ve[Zt(e)]}function Du(e){return typeof e=="function"?e:e==null?lr:typeof e=="object"?we(e)?ju(e[0],e[1]):Mu(e):rl(e)}function Oa(e){if(!Gn(e))return cd(e);var i=[];for(var o in Ge(e))qe.call(e,o)&&o!="constructor"&&i.push(o);return i}function og(e){if(!ut(e))return Hg(e);var i=Gn(e),o=[];for(var c in e)c=="constructor"&&(i||!qe.call(e,c))||o.push(c);return o}function Ra(e,i){return e<i}function Lu(e,i){var o=-1,c=ur(e)?N(e.length):[];return xi(e,function(l,d,w){c[++o]=i(l,d,w)}),c}function Mu(e){var i=Ka(e);return i.length==1&&i[0][2]?yh(i[0][0],i[0][1]):function(o){return o===e||Pa(o,e,i)}}function ju(e,i){return Va(e)&&gh(i)?yh(Qr(e),i):function(o){var c=tc(o,e);return c===r&&c===i?rc(o,e):Vn(i,c,A|V)}}function Zs(e,i,o,c,l){e!==i&&Ea(i,function(d,w){if(l||(l=new jr),ut(d))ag(e,i,w,o,Zs,c,l);else{var _=c?c(Wa(e,w),d,w+"",e,i,l):r;_===r&&(_=d),ba(e,w,_)}},hr)}function ag(e,i,o,c,l,d,w){var _=Wa(e,o),R=Wa(i,o),j=w.get(R);if(j){ba(e,o,j);return}var U=d?d(_,R,o+"",e,i,w):r,K=U===r;if(K){var Q=we(R),te=!Q&&Ri(R),oe=!Q&&!te&&bn(R);U=R,Q||te||oe?we(_)?U=_:_t(_)?U=cr(_):te?(K=!1,U=Ju(R,!0)):oe?(K=!1,U=Qu(R,!0)):U=[]:Qn(R)||Fi(R)?(U=_,Fi(_)?U=Fh(_):(!ut(_)||ci(_))&&(U=dh(R))):K=!1}K&&(w.set(R,U),l(U,R,c,d,w),w.delete(R)),ba(e,o,U)}function Uu(e,i){var o=e.length;if(o)return i+=i<0?o:0,ai(i,o)?e[i]:r}function qu(e,i,o){i.length?i=nt(i,function(d){return we(d)?function(w){return Ki(w,d.length===1?d[0]:d)}:d}):i=[lr];var c=-1;i=nt(i,vr(se()));var l=Lu(e,function(d,w,_){var R=nt(i,function(j){return j(d)});return{criteria:R,index:++c,value:d}});return Dp(l,function(d,w){return bg(d,w,o)})}function cg(e,i){return zu(e,i,function(o,c){return rc(e,c)})}function zu(e,i,o){for(var c=-1,l=i.length,d={};++c<l;){var w=i[c],_=Ki(e,w);o(_,w)&&Fn(d,Pi(w,e),_)}return d}function ug(e){return function(i){return Ki(i,e)}}function Ta(e,i,o,c){var l=c?$p:un,d=-1,w=i.length,_=e;for(e===i&&(i=cr(i)),o&&(_=nt(e,vr(o)));++d<w;)for(var R=0,j=i[d],U=o?o(j):j;(R=l(_,U,R,c))>-1;)_!==e&&Ks.call(_,R,1),Ks.call(e,R,1);return e}function ku(e,i){for(var o=e?i.length:0,c=o-1;o--;){var l=i[o];if(o==c||l!==d){var d=l;ai(l)?Ks.call(e,l,1):$a(e,l)}}return e}function Aa(e,i){return e+Fs(_u()*(i-e+1))}function hg(e,i,o,c){for(var l=-1,d=jt(Vs((i-e)/(o||1)),0),w=N(d);d--;)w[c?d:++l]=e,e+=o;return w}function Ca(e,i){var o="";if(!e||i<1||i>F)return o;do i%2&&(o+=e),i=Fs(i/2),i&&(e+=e);while(i);return o}function xe(e,i){return Ga(vh(e,i,lr),e+"")}function lg(e){return xu(_n(e))}function fg(e,i){var o=_n(e);return uo(o,Hi(i,0,o.length))}function Fn(e,i,o,c){if(!ut(e))return e;i=Pi(i,e);for(var l=-1,d=i.length,w=d-1,_=e;_!=null&&++l<d;){var R=Qr(i[l]),j=o;if(R==="__proto__"||R==="constructor"||R==="prototype")return e;if(l!=w){var U=_[R];j=c?c(U,R,_):r,j===r&&(j=ut(U)?U:ai(i[l+1])?[]:{})}Hn(_,R,j),_=_[R]}return e}var Hu=Ws?function(e,i){return Ws.set(e,i),e}:lr,pg=Bs?function(e,i){return Bs(e,"toString",{configurable:!0,enumerable:!1,value:nc(i),writable:!0})}:lr;function dg(e){return uo(_n(e))}function Tr(e,i,o){var c=-1,l=e.length;i<0&&(i=-i>l?0:l+i),o=o>l?l:o,o<0&&(o+=l),l=i>o?0:o-i>>>0,i>>>=0;for(var d=N(l);++c<l;)d[c]=e[c+i];return d}function gg(e,i){var o;return xi(e,function(c,l,d){return o=i(c,l,d),!o}),!!o}function eo(e,i,o){var c=0,l=e==null?c:e.length;if(typeof i=="number"&&i===i&&l<=Ke){for(;c<l;){var d=c+l>>>1,w=e[d];w!==null&&!wr(w)&&(o?w<=i:w<i)?c=d+1:l=d}return l}return Na(e,i,lr,o)}function Na(e,i,o,c){var l=0,d=e==null?0:e.length;if(d===0)return 0;i=o(i);for(var w=i!==i,_=i===null,R=wr(i),j=i===r;l<d;){var U=Fs((l+d)/2),K=o(e[U]),Q=K!==r,te=K===null,oe=K===K,Ee=wr(K);if(w)var ae=c||oe;else j?ae=oe&&(c||Q):_?ae=oe&&Q&&(c||!te):R?ae=oe&&Q&&!te&&(c||!Ee):te||Ee?ae=!1:ae=c?K<=i:K<i;ae?l=U+1:d=U}return Wt(d,Je)}function Ku(e,i){for(var o=-1,c=e.length,l=0,d=[];++o<c;){var w=e[o],_=i?i(w):w;if(!o||!Ur(_,R)){var R=_;d[l++]=w===0?0:w}}return d}function Bu(e){return typeof e=="number"?e:wr(e)?B:+e}function mr(e){if(typeof e=="string")return e;if(we(e))return nt(e,mr)+"";if(wr(e))return Eu?Eu.call(e):"";var i=e+"";return i=="0"&&1/e==-ce?"-0":i}function Si(e,i,o){var c=-1,l=$s,d=e.length,w=!0,_=[],R=_;if(o)w=!1,l=aa;else if(d>=a){var j=i?null:Pg(e);if(j)return Ls(j);w=!1,l=Mn,R=new ki}else R=i?[]:_;e:for(;++c<d;){var U=e[c],K=i?i(U):U;if(U=o||U!==0?U:0,w&&K===K){for(var Q=R.length;Q--;)if(R[Q]===K)continue e;i&&R.push(K),_.push(U)}else l(R,K,o)||(R!==_&&R.push(K),_.push(U))}return _}function $a(e,i){return i=Pi(i,e),e=mh(e,i),e==null||delete e[Qr(Ar(i))]}function Vu(e,i,o,c){return Fn(e,i,o(Ki(e,i)),c)}function to(e,i,o,c){for(var l=e.length,d=c?l:-1;(c?d--:++d<l)&&i(e[d],d,e););return o?Tr(e,c?0:d,c?d+1:l):Tr(e,c?d+1:0,c?l:d)}function Fu(e,i){var o=e;return o instanceof Oe&&(o=o.value()),ca(i,function(c,l){return l.func.apply(l.thisArg,_i([c],l.args))},o)}function Da(e,i,o){var c=e.length;if(c<2)return c?Si(e[0]):[];for(var l=-1,d=N(c);++l<c;)for(var w=e[l],_=-1;++_<c;)_!=l&&(d[l]=Kn(d[l]||w,e[_],i,o));return Si(Vt(d,1),i,o)}function Wu(e,i,o){for(var c=-1,l=e.length,d=i.length,w={};++c<l;){var _=c<d?i[c]:r;o(w,e[c],_)}return w}function La(e){return _t(e)?e:[]}function Ma(e){return typeof e=="function"?e:lr}function Pi(e,i){return we(e)?e:Va(e,i)?[e]:Eh(je(e))}var yg=xe;function Oi(e,i,o){var c=e.length;return o=o===r?c:o,!i&&o>=c?e:Tr(e,i,o)}var Gu=id||function(e){return Re.clearTimeout(e)};function Ju(e,i){if(i)return e.slice();var o=e.length,c=yu?yu(o):new e.constructor(o);return e.copy(c),c}function ja(e){var i=new e.constructor(e.byteLength);return new ks(i).set(new ks(e)),i}function vg(e,i){var o=i?ja(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}function mg(e){var i=new e.constructor(e.source,Ir.exec(e));return i.lastIndex=e.lastIndex,i}function wg(e){return kn?Ge(kn.call(e)):{}}function Qu(e,i){var o=i?ja(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}function Yu(e,i){if(e!==i){var o=e!==r,c=e===null,l=e===e,d=wr(e),w=i!==r,_=i===null,R=i===i,j=wr(i);if(!_&&!j&&!d&&e>i||d&&w&&R&&!_&&!j||c&&w&&R||!o&&R||!l)return 1;if(!c&&!d&&!j&&e<i||j&&o&&l&&!c&&!d||_&&o&&l||!w&&l||!R)return-1}return 0}function bg(e,i,o){for(var c=-1,l=e.criteria,d=i.criteria,w=l.length,_=o.length;++c<w;){var R=Yu(l[c],d[c]);if(R){if(c>=_)return R;var j=o[c];return R*(j=="desc"?-1:1)}}return e.index-i.index}function Xu(e,i,o,c){for(var l=-1,d=e.length,w=o.length,_=-1,R=i.length,j=jt(d-w,0),U=N(R+j),K=!c;++_<R;)U[_]=i[_];for(;++l<w;)(K||l<d)&&(U[o[l]]=e[l]);for(;j--;)U[_++]=e[l++];return U}function Zu(e,i,o,c){for(var l=-1,d=e.length,w=-1,_=o.length,R=-1,j=i.length,U=jt(d-_,0),K=N(U+j),Q=!c;++l<U;)K[l]=e[l];for(var te=l;++R<j;)K[te+R]=i[R];for(;++w<_;)(Q||l<d)&&(K[te+o[w]]=e[l++]);return K}function cr(e,i){var o=-1,c=e.length;for(i||(i=N(c));++o<c;)i[o]=e[o];return i}function Jr(e,i,o,c){var l=!o;o||(o={});for(var d=-1,w=i.length;++d<w;){var _=i[d],R=c?c(o[_],e[_],_,o,e):r;R===r&&(R=e[_]),l?ni(o,_,R):Hn(o,_,R)}return o}function _g(e,i){return Jr(e,Ba(e),i)}function Eg(e,i){return Jr(e,fh(e),i)}function ro(e,i){return function(o,c){var l=we(o)?Op:Bd,d=i?i():{};return l(o,e,se(c,2),d)}}function vn(e){return xe(function(i,o){var c=-1,l=o.length,d=l>1?o[l-1]:r,w=l>2?o[2]:r;for(d=e.length>3&&typeof d=="function"?(l--,d):r,w&&er(o[0],o[1],w)&&(d=l<3?r:d,l=1),i=Ge(i);++c<l;){var _=o[c];_&&e(i,_,c,d)}return i})}function eh(e,i){return function(o,c){if(o==null)return o;if(!ur(o))return e(o,c);for(var l=o.length,d=i?l:-1,w=Ge(o);(i?d--:++d<l)&&c(w[d],d,w)!==!1;);return o}}function th(e){return function(i,o,c){for(var l=-1,d=Ge(i),w=c(i),_=w.length;_--;){var R=w[e?_:++l];if(o(d[R],R,d)===!1)break}return i}}function Ig(e,i,o){var c=i&ie,l=Wn(e);function d(){var w=this&&this!==Re&&this instanceof d?l:e;return w.apply(c?o:this,arguments)}return d}function rh(e){return function(i){i=je(i);var o=hn(i)?Mr(i):r,c=o?o[0]:i.charAt(0),l=o?Oi(o,1).join(""):i.slice(1);return c[e]()+l}}function mn(e){return function(i){return ca(el(Zh(i).replace(Dn,"")),e,"")}}function Wn(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var o=yn(e.prototype),c=e.apply(o,i);return ut(c)?c:o}}function xg(e,i,o){var c=Wn(e);function l(){for(var d=arguments.length,w=N(d),_=d,R=wn(l);_--;)w[_]=arguments[_];var j=d<3&&w[0]!==R&&w[d-1]!==R?[]:Ei(w,R);if(d-=j.length,d<o)return ah(e,i,io,l.placeholder,r,w,j,r,r,o-d);var U=this&&this!==Re&&this instanceof l?c:e;return qt(U,this,w)}return l}function ih(e){return function(i,o,c){var l=Ge(i);if(!ur(i)){var d=se(o,3);i=zt(i),o=function(_){return d(l[_],_,l)}}var w=e(i,o,c);return w>-1?l[d?i[w]:w]:r}}function nh(e){return oi(function(i){var o=i.length,c=o,l=Or.prototype.thru;for(e&&i.reverse();c--;){var d=i[c];if(typeof d!="function")throw new Pr(f);if(l&&!w&&ao(d)=="wrapper")var w=new Or([],!0)}for(c=w?c:o;++c<o;){d=i[c];var _=ao(d),R=_=="wrapper"?Ha(d):r;R&&Fa(R[0])&&R[1]==(k|fe|de|G)&&!R[4].length&&R[9]==1?w=w[ao(R[0])].apply(w,R[3]):w=d.length==1&&Fa(d)?w[_]():w.thru(d)}return function(){var j=arguments,U=j[0];if(w&&j.length==1&&we(U))return w.plant(U).value();for(var K=0,Q=o?i[K].apply(this,j):U;++K<o;)Q=i[K].call(this,Q);return Q}})}function io(e,i,o,c,l,d,w,_,R,j){var U=i&k,K=i&ie,Q=i&he,te=i&(fe|pe),oe=i&ve,Ee=Q?r:Wn(e);function ae(){for(var Se=arguments.length,Te=N(Se),br=Se;br--;)Te[br]=arguments[br];if(te)var tr=wn(ae),_r=Mp(Te,tr);if(c&&(Te=Xu(Te,c,l,te)),d&&(Te=Zu(Te,d,w,te)),Se-=_r,te&&Se<j){var Et=Ei(Te,tr);return ah(e,i,io,ae.placeholder,o,Te,Et,_,R,j-Se)}var qr=K?o:this,hi=Q?qr[e]:e;return Se=Te.length,_?Te=Bg(Te,_):oe&&Se>1&&Te.reverse(),U&&R<Se&&(Te.length=R),this&&this!==Re&&this instanceof ae&&(hi=Ee||Wn(hi)),hi.apply(qr,Te)}return ae}function sh(e,i){return function(o,c){return Xd(o,e,i(c),{})}}function no(e,i){return function(o,c){var l;if(o===r&&c===r)return i;if(o!==r&&(l=o),c!==r){if(l===r)return c;typeof o=="string"||typeof c=="string"?(o=mr(o),c=mr(c)):(o=Bu(o),c=Bu(c)),l=e(o,c)}return l}}function Ua(e){return oi(function(i){return i=nt(i,vr(se())),xe(function(o){var c=this;return e(i,function(l){return qt(l,c,o)})})})}function so(e,i){i=i===r?" ":mr(i);var o=i.length;if(o<2)return o?Ca(i,e):i;var c=Ca(i,Vs(e/ln(i)));return hn(i)?Oi(Mr(c),0,e).join(""):c.slice(0,e)}function Sg(e,i,o,c){var l=i&ie,d=Wn(e);function w(){for(var _=-1,R=arguments.length,j=-1,U=c.length,K=N(U+R),Q=this&&this!==Re&&this instanceof w?d:e;++j<U;)K[j]=c[j];for(;R--;)K[j++]=arguments[++_];return qt(Q,l?o:this,K)}return w}function oh(e){return function(i,o,c){return c&&typeof c!="number"&&er(i,o,c)&&(o=c=r),i=ui(i),o===r?(o=i,i=0):o=ui(o),c=c===r?i<o?1:-1:ui(c),hg(i,o,c,e)}}function oo(e){return function(i,o){return typeof i=="string"&&typeof o=="string"||(i=Cr(i),o=Cr(o)),e(i,o)}}function ah(e,i,o,c,l,d,w,_,R,j){var U=i&fe,K=U?w:r,Q=U?r:w,te=U?d:r,oe=U?r:d;i|=U?de:L,i&=~(U?L:de),i&le||(i&=~(ie|he));var Ee=[e,i,l,te,K,oe,Q,_,R,j],ae=o.apply(r,Ee);return Fa(e)&&wh(ae,Ee),ae.placeholder=c,bh(ae,e,i)}function qa(e){var i=Mt[e];return function(o,c){if(o=Cr(o),c=c==null?0:Wt(be(c),292),c&&bu(o)){var l=(je(o)+"e").split("e"),d=i(l[0]+"e"+(+l[1]+c));return l=(je(d)+"e").split("e"),+(l[0]+"e"+(+l[1]-c))}return i(o)}}var Pg=dn&&1/Ls(new dn([,-0]))[1]==ce?function(e){return new dn(e)}:ac;function ch(e){return function(i){var o=Gt(i);return o==_e?ga(i):o==Me?Kp(i):Lp(i,e(i))}}function si(e,i,o,c,l,d,w,_){var R=i&he;if(!R&&typeof e!="function")throw new Pr(f);var j=c?c.length:0;if(j||(i&=~(de|L),c=l=r),w=w===r?w:jt(be(w),0),_=_===r?_:be(_),j-=l?l.length:0,i&L){var U=c,K=l;c=l=r}var Q=R?r:Ha(e),te=[e,i,o,c,l,U,K,d,w,_];if(Q&&kg(te,Q),e=te[0],i=te[1],o=te[2],c=te[3],l=te[4],_=te[9]=te[9]===r?R?0:e.length:jt(te[9]-j,0),!_&&i&(fe|pe)&&(i&=~(fe|pe)),!i||i==ie)var oe=Ig(e,i,o);else i==fe||i==pe?oe=xg(e,i,_):(i==de||i==(ie|de))&&!l.length?oe=Sg(e,i,o,c):oe=io.apply(r,te);var Ee=Q?Hu:wh;return bh(Ee(oe,te),e,i)}function uh(e,i,o,c){return e===r||Ur(e,pn[o])&&!qe.call(c,o)?i:e}function hh(e,i,o,c,l,d){return ut(e)&&ut(i)&&(d.set(i,e),Zs(e,i,r,hh,d),d.delete(i)),e}function Og(e){return Qn(e)?r:e}function lh(e,i,o,c,l,d){var w=o&A,_=e.length,R=i.length;if(_!=R&&!(w&&R>_))return!1;var j=d.get(e),U=d.get(i);if(j&&U)return j==i&&U==e;var K=-1,Q=!0,te=o&V?new ki:r;for(d.set(e,i),d.set(i,e);++K<_;){var oe=e[K],Ee=i[K];if(c)var ae=w?c(Ee,oe,K,i,e,d):c(oe,Ee,K,e,i,d);if(ae!==r){if(ae)continue;Q=!1;break}if(te){if(!ua(i,function(Se,Te){if(!Mn(te,Te)&&(oe===Se||l(oe,Se,o,c,d)))return te.push(Te)})){Q=!1;break}}else if(!(oe===Ee||l(oe,Ee,o,c,d))){Q=!1;break}}return d.delete(e),d.delete(i),Q}function Rg(e,i,o,c,l,d,w){switch(o){case Be:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case $e:return!(e.byteLength!=i.byteLength||!d(new ks(e),new ks(i)));case $:case T:case Ne:return Ur(+e,+i);case I:return e.name==i.name&&e.message==i.message;case ot:case Ye:return e==i+"";case _e:var _=ga;case Me:var R=c&A;if(_||(_=Ls),e.size!=i.size&&!R)return!1;var j=w.get(e);if(j)return j==i;c|=V,w.set(e,i);var U=lh(_(e),_(i),c,l,d,w);return w.delete(e),U;case Xe:if(kn)return kn.call(e)==kn.call(i)}return!1}function Tg(e,i,o,c,l,d){var w=o&A,_=za(e),R=_.length,j=za(i),U=j.length;if(R!=U&&!w)return!1;for(var K=R;K--;){var Q=_[K];if(!(w?Q in i:qe.call(i,Q)))return!1}var te=d.get(e),oe=d.get(i);if(te&&oe)return te==i&&oe==e;var Ee=!0;d.set(e,i),d.set(i,e);for(var ae=w;++K<R;){Q=_[K];var Se=e[Q],Te=i[Q];if(c)var br=w?c(Te,Se,Q,i,e,d):c(Se,Te,Q,e,i,d);if(!(br===r?Se===Te||l(Se,Te,o,c,d):br)){Ee=!1;break}ae||(ae=Q=="constructor")}if(Ee&&!ae){var tr=e.constructor,_r=i.constructor;tr!=_r&&"constructor"in e&&"constructor"in i&&!(typeof tr=="function"&&tr instanceof tr&&typeof _r=="function"&&_r instanceof _r)&&(Ee=!1)}return d.delete(e),d.delete(i),Ee}function oi(e){return Ga(vh(e,r,Ph),e+"")}function za(e){return Cu(e,zt,Ba)}function ka(e){return Cu(e,hr,fh)}var Ha=Ws?function(e){return Ws.get(e)}:ac;function ao(e){for(var i=e.name+"",o=gn[i],c=qe.call(gn,i)?o.length:0;c--;){var l=o[c],d=l.func;if(d==null||d==e)return l.name}return i}function wn(e){var i=qe.call(p,"placeholder")?p:e;return i.placeholder}function se(){var e=p.iteratee||sc;return e=e===sc?Du:e,arguments.length?e(arguments[0],arguments[1]):e}function co(e,i){var o=e.__data__;return jg(i)?o[typeof i=="string"?"string":"hash"]:o.map}function Ka(e){for(var i=zt(e),o=i.length;o--;){var c=i[o],l=e[c];i[o]=[c,l,gh(l)]}return i}function Bi(e,i){var o=zp(e,i);return $u(o)?o:r}function Ag(e){var i=qe.call(e,qi),o=e[qi];try{e[qi]=r;var c=!0}catch{}var l=qs.call(e);return c&&(i?e[qi]=o:delete e[qi]),l}var Ba=va?function(e){return e==null?[]:(e=Ge(e),bi(va(e),function(i){return mu.call(e,i)}))}:cc,fh=va?function(e){for(var i=[];e;)_i(i,Ba(e)),e=Hs(e);return i}:cc,Gt=Zt;(ma&&Gt(new ma(new ArrayBuffer(1)))!=Be||Un&&Gt(new Un)!=_e||wa&&Gt(wa.resolve())!=St||dn&&Gt(new dn)!=Me||qn&&Gt(new qn)!=ke)&&(Gt=function(e){var i=Zt(e),o=i==Pe?e.constructor:r,c=o?Vi(o):"";if(c)switch(c){case fd:return Be;case pd:return _e;case dd:return St;case gd:return Me;case yd:return ke}return i});function Cg(e,i,o){for(var c=-1,l=o.length;++c<l;){var d=o[c],w=d.size;switch(d.type){case"drop":e+=w;break;case"dropRight":i-=w;break;case"take":i=Wt(i,e+w);break;case"takeRight":e=jt(e,i-w);break}}return{start:e,end:i}}function Ng(e){var i=e.match(Qe);return i?i[1].split(At):[]}function ph(e,i,o){i=Pi(i,e);for(var c=-1,l=i.length,d=!1;++c<l;){var w=Qr(i[c]);if(!(d=e!=null&&o(e,w)))break;e=e[w]}return d||++c!=l?d:(l=e==null?0:e.length,!!l&&yo(l)&&ai(w,l)&&(we(e)||Fi(e)))}function $g(e){var i=e.length,o=new e.constructor(i);return i&&typeof e[0]=="string"&&qe.call(e,"index")&&(o.index=e.index,o.input=e.input),o}function dh(e){return typeof e.constructor=="function"&&!Gn(e)?yn(Hs(e)):{}}function Dg(e,i,o){var c=e.constructor;switch(i){case $e:return ja(e);case $:case T:return new c(+e);case Be:return vg(e,o);case ht:case Ue:case Pt:case Lt:case Kt:case Bt:case Ut:case Qt:case or:return Qu(e,o);case _e:return new c;case Ne:case Ye:return new c(e);case ot:return mg(e);case Me:return new c;case Xe:return wg(e)}}function Lg(e,i){var o=i.length;if(!o)return e;var c=o-1;return i[c]=(o>1?"& ":"")+i[c],i=i.join(o>2?", ":" "),e.replace(yt,`{
/* [wrapped with `+i+`] */
`)}function Mg(e){return we(e)||Fi(e)||!!(wu&&e&&e[wu])}function ai(e,i){var o=typeof e;return i=i??F,!!i&&(o=="number"||o!="symbol"&&Wo.test(e))&&e>-1&&e%1==0&&e<i}function er(e,i,o){if(!ut(o))return!1;var c=typeof i;return(c=="number"?ur(o)&&ai(i,o.length):c=="string"&&i in o)?Ur(o[i],e):!1}function Va(e,i){if(we(e))return!1;var o=typeof e;return o=="number"||o=="symbol"||o=="boolean"||e==null||wr(e)?!0:Ot.test(e)||!it.test(e)||i!=null&&e in Ge(i)}function jg(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function Fa(e){var i=ao(e),o=p[i];if(typeof o!="function"||!(i in Oe.prototype))return!1;if(e===o)return!0;var c=Ha(o);return!!c&&e===c[0]}function Ug(e){return!!gu&&gu in e}var qg=js?ci:uc;function Gn(e){var i=e&&e.constructor,o=typeof i=="function"&&i.prototype||pn;return e===o}function gh(e){return e===e&&!ut(e)}function yh(e,i){return function(o){return o==null?!1:o[e]===i&&(i!==r||e in Ge(o))}}function zg(e){var i=po(e,function(c){return o.size===y&&o.clear(),c}),o=i.cache;return i}function kg(e,i){var o=e[1],c=i[1],l=o|c,d=l<(ie|he|k),w=c==k&&o==fe||c==k&&o==G&&e[7].length<=i[8]||c==(k|G)&&i[7].length<=i[8]&&o==fe;if(!(d||w))return e;c&ie&&(e[2]=i[2],l|=o&ie?0:le);var _=i[3];if(_){var R=e[3];e[3]=R?Xu(R,_,i[4]):_,e[4]=R?Ei(e[3],E):i[4]}return _=i[5],_&&(R=e[5],e[5]=R?Zu(R,_,i[6]):_,e[6]=R?Ei(e[5],E):i[6]),_=i[7],_&&(e[7]=_),c&k&&(e[8]=e[8]==null?i[8]:Wt(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=l,e}function Hg(e){var i=[];if(e!=null)for(var o in Ge(e))i.push(o);return i}function Kg(e){return qs.call(e)}function vh(e,i,o){return i=jt(i===r?e.length-1:i,0),function(){for(var c=arguments,l=-1,d=jt(c.length-i,0),w=N(d);++l<d;)w[l]=c[i+l];l=-1;for(var _=N(i+1);++l<i;)_[l]=c[l];return _[i]=o(w),qt(e,this,_)}}function mh(e,i){return i.length<2?e:Ki(e,Tr(i,0,-1))}function Bg(e,i){for(var o=e.length,c=Wt(i.length,o),l=cr(e);c--;){var d=i[c];e[c]=ai(d,o)?l[d]:r}return e}function Wa(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var wh=_h(Hu),Jn=sd||function(e,i){return Re.setTimeout(e,i)},Ga=_h(pg);function bh(e,i,o){var c=i+"";return Ga(e,Lg(c,Vg(Ng(c),o)))}function _h(e){var i=0,o=0;return function(){var c=ud(),l=ze-(c-o);if(o=c,l>0){if(++i>=Ce)return arguments[0]}else i=0;return e.apply(r,arguments)}}function uo(e,i){var o=-1,c=e.length,l=c-1;for(i=i===r?c:i;++o<i;){var d=Aa(o,l),w=e[d];e[d]=e[o],e[o]=w}return e.length=i,e}var Eh=zg(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(Rt,function(o,c,l,d){i.push(l?d.replace(ko,"$1"):c||o)}),i});function Qr(e){if(typeof e=="string"||wr(e))return e;var i=e+"";return i=="0"&&1/e==-ce?"-0":i}function Vi(e){if(e!=null){try{return Us.call(e)}catch{}try{return e+""}catch{}}return""}function Vg(e,i){return Sr(Br,function(o){var c="_."+o[0];i&o[1]&&!$s(e,c)&&e.push(c)}),e.sort()}function Ih(e){if(e instanceof Oe)return e.clone();var i=new Or(e.__wrapped__,e.__chain__);return i.__actions__=cr(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function Fg(e,i,o){(o?er(e,i,o):i===r)?i=1:i=jt(be(i),0);var c=e==null?0:e.length;if(!c||i<1)return[];for(var l=0,d=0,w=N(Vs(c/i));l<c;)w[d++]=Tr(e,l,l+=i);return w}function Wg(e){for(var i=-1,o=e==null?0:e.length,c=0,l=[];++i<o;){var d=e[i];d&&(l[c++]=d)}return l}function Gg(){var e=arguments.length;if(!e)return[];for(var i=N(e-1),o=arguments[0],c=e;c--;)i[c-1]=arguments[c];return _i(we(o)?cr(o):[o],Vt(i,1))}var Jg=xe(function(e,i){return _t(e)?Kn(e,Vt(i,1,_t,!0)):[]}),Qg=xe(function(e,i){var o=Ar(i);return _t(o)&&(o=r),_t(e)?Kn(e,Vt(i,1,_t,!0),se(o,2)):[]}),Yg=xe(function(e,i){var o=Ar(i);return _t(o)&&(o=r),_t(e)?Kn(e,Vt(i,1,_t,!0),r,o):[]});function Xg(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:be(i),Tr(e,i<0?0:i,c)):[]}function Zg(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:be(i),i=c-i,Tr(e,0,i<0?0:i)):[]}function ey(e,i){return e&&e.length?to(e,se(i,3),!0,!0):[]}function ty(e,i){return e&&e.length?to(e,se(i,3),!0):[]}function ry(e,i,o,c){var l=e==null?0:e.length;return l?(o&&typeof o!="number"&&er(e,i,o)&&(o=0,c=l),Gd(e,i,o,c)):[]}function xh(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=o==null?0:be(o);return l<0&&(l=jt(c+l,0)),Ds(e,se(i,3),l)}function Sh(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=c-1;return o!==r&&(l=be(o),l=o<0?jt(c+l,0):Wt(l,c-1)),Ds(e,se(i,3),l,!0)}function Ph(e){var i=e==null?0:e.length;return i?Vt(e,1):[]}function iy(e){var i=e==null?0:e.length;return i?Vt(e,ce):[]}function ny(e,i){var o=e==null?0:e.length;return o?(i=i===r?1:be(i),Vt(e,i)):[]}function sy(e){for(var i=-1,o=e==null?0:e.length,c={};++i<o;){var l=e[i];c[l[0]]=l[1]}return c}function Oh(e){return e&&e.length?e[0]:r}function oy(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=o==null?0:be(o);return l<0&&(l=jt(c+l,0)),un(e,i,l)}function ay(e){var i=e==null?0:e.length;return i?Tr(e,0,-1):[]}var cy=xe(function(e){var i=nt(e,La);return i.length&&i[0]===e[0]?Sa(i):[]}),uy=xe(function(e){var i=Ar(e),o=nt(e,La);return i===Ar(o)?i=r:o.pop(),o.length&&o[0]===e[0]?Sa(o,se(i,2)):[]}),hy=xe(function(e){var i=Ar(e),o=nt(e,La);return i=typeof i=="function"?i:r,i&&o.pop(),o.length&&o[0]===e[0]?Sa(o,r,i):[]});function ly(e,i){return e==null?"":ad.call(e,i)}function Ar(e){var i=e==null?0:e.length;return i?e[i-1]:r}function fy(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=c;return o!==r&&(l=be(o),l=l<0?jt(c+l,0):Wt(l,c-1)),i===i?Vp(e,i,l):Ds(e,au,l,!0)}function py(e,i){return e&&e.length?Uu(e,be(i)):r}var dy=xe(Rh);function Rh(e,i){return e&&e.length&&i&&i.length?Ta(e,i):e}function gy(e,i,o){return e&&e.length&&i&&i.length?Ta(e,i,se(o,2)):e}function yy(e,i,o){return e&&e.length&&i&&i.length?Ta(e,i,r,o):e}var vy=oi(function(e,i){var o=e==null?0:e.length,c=_a(e,i);return ku(e,nt(i,function(l){return ai(l,o)?+l:l}).sort(Yu)),c});function my(e,i){var o=[];if(!(e&&e.length))return o;var c=-1,l=[],d=e.length;for(i=se(i,3);++c<d;){var w=e[c];i(w,c,e)&&(o.push(w),l.push(c))}return ku(e,l),o}function Ja(e){return e==null?e:ld.call(e)}function wy(e,i,o){var c=e==null?0:e.length;return c?(o&&typeof o!="number"&&er(e,i,o)?(i=0,o=c):(i=i==null?0:be(i),o=o===r?c:be(o)),Tr(e,i,o)):[]}function by(e,i){return eo(e,i)}function _y(e,i,o){return Na(e,i,se(o,2))}function Ey(e,i){var o=e==null?0:e.length;if(o){var c=eo(e,i);if(c<o&&Ur(e[c],i))return c}return-1}function Iy(e,i){return eo(e,i,!0)}function xy(e,i,o){return Na(e,i,se(o,2),!0)}function Sy(e,i){var o=e==null?0:e.length;if(o){var c=eo(e,i,!0)-1;if(Ur(e[c],i))return c}return-1}function Py(e){return e&&e.length?Ku(e):[]}function Oy(e,i){return e&&e.length?Ku(e,se(i,2)):[]}function Ry(e){var i=e==null?0:e.length;return i?Tr(e,1,i):[]}function Ty(e,i,o){return e&&e.length?(i=o||i===r?1:be(i),Tr(e,0,i<0?0:i)):[]}function Ay(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:be(i),i=c-i,Tr(e,i<0?0:i,c)):[]}function Cy(e,i){return e&&e.length?to(e,se(i,3),!1,!0):[]}function Ny(e,i){return e&&e.length?to(e,se(i,3)):[]}var $y=xe(function(e){return Si(Vt(e,1,_t,!0))}),Dy=xe(function(e){var i=Ar(e);return _t(i)&&(i=r),Si(Vt(e,1,_t,!0),se(i,2))}),Ly=xe(function(e){var i=Ar(e);return i=typeof i=="function"?i:r,Si(Vt(e,1,_t,!0),r,i)});function My(e){return e&&e.length?Si(e):[]}function jy(e,i){return e&&e.length?Si(e,se(i,2)):[]}function Uy(e,i){return i=typeof i=="function"?i:r,e&&e.length?Si(e,r,i):[]}function Qa(e){if(!(e&&e.length))return[];var i=0;return e=bi(e,function(o){if(_t(o))return i=jt(o.length,i),!0}),pa(i,function(o){return nt(e,ha(o))})}function Th(e,i){if(!(e&&e.length))return[];var o=Qa(e);return i==null?o:nt(o,function(c){return qt(i,r,c)})}var qy=xe(function(e,i){return _t(e)?Kn(e,i):[]}),zy=xe(function(e){return Da(bi(e,_t))}),ky=xe(function(e){var i=Ar(e);return _t(i)&&(i=r),Da(bi(e,_t),se(i,2))}),Hy=xe(function(e){var i=Ar(e);return i=typeof i=="function"?i:r,Da(bi(e,_t),r,i)}),Ky=xe(Qa);function By(e,i){return Wu(e||[],i||[],Hn)}function Vy(e,i){return Wu(e||[],i||[],Fn)}var Fy=xe(function(e){var i=e.length,o=i>1?e[i-1]:r;return o=typeof o=="function"?(e.pop(),o):r,Th(e,o)});function Ah(e){var i=p(e);return i.__chain__=!0,i}function Wy(e,i){return i(e),e}function ho(e,i){return i(e)}var Gy=oi(function(e){var i=e.length,o=i?e[0]:0,c=this.__wrapped__,l=function(d){return _a(d,e)};return i>1||this.__actions__.length||!(c instanceof Oe)||!ai(o)?this.thru(l):(c=c.slice(o,+o+(i?1:0)),c.__actions__.push({func:ho,args:[l],thisArg:r}),new Or(c,this.__chain__).thru(function(d){return i&&!d.length&&d.push(r),d}))});function Jy(){return Ah(this)}function Qy(){return new Or(this.value(),this.__chain__)}function Yy(){this.__values__===r&&(this.__values__=Bh(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function Xy(){return this}function Zy(e){for(var i,o=this;o instanceof Js;){var c=Ih(o);c.__index__=0,c.__values__=r,i?l.__wrapped__=c:i=c;var l=c;o=o.__wrapped__}return l.__wrapped__=e,i}function ev(){var e=this.__wrapped__;if(e instanceof Oe){var i=e;return this.__actions__.length&&(i=new Oe(this)),i=i.reverse(),i.__actions__.push({func:ho,args:[Ja],thisArg:r}),new Or(i,this.__chain__)}return this.thru(Ja)}function tv(){return Fu(this.__wrapped__,this.__actions__)}var rv=ro(function(e,i,o){qe.call(e,o)?++e[o]:ni(e,o,1)});function iv(e,i,o){var c=we(e)?su:Wd;return o&&er(e,i,o)&&(i=r),c(e,se(i,3))}function nv(e,i){var o=we(e)?bi:Tu;return o(e,se(i,3))}var sv=ih(xh),ov=ih(Sh);function av(e,i){return Vt(lo(e,i),1)}function cv(e,i){return Vt(lo(e,i),ce)}function uv(e,i,o){return o=o===r?1:be(o),Vt(lo(e,i),o)}function Ch(e,i){var o=we(e)?Sr:xi;return o(e,se(i,3))}function Nh(e,i){var o=we(e)?Rp:Ru;return o(e,se(i,3))}var hv=ro(function(e,i,o){qe.call(e,o)?e[o].push(i):ni(e,o,[i])});function lv(e,i,o,c){e=ur(e)?e:_n(e),o=o&&!c?be(o):0;var l=e.length;return o<0&&(o=jt(l+o,0)),vo(e)?o<=l&&e.indexOf(i,o)>-1:!!l&&un(e,i,o)>-1}var fv=xe(function(e,i,o){var c=-1,l=typeof i=="function",d=ur(e)?N(e.length):[];return xi(e,function(w){d[++c]=l?qt(i,w,o):Bn(w,i,o)}),d}),pv=ro(function(e,i,o){ni(e,o,i)});function lo(e,i){var o=we(e)?nt:Lu;return o(e,se(i,3))}function dv(e,i,o,c){return e==null?[]:(we(i)||(i=i==null?[]:[i]),o=c?r:o,we(o)||(o=o==null?[]:[o]),qu(e,i,o))}var gv=ro(function(e,i,o){e[o?0:1].push(i)},function(){return[[],[]]});function yv(e,i,o){var c=we(e)?ca:uu,l=arguments.length<3;return c(e,se(i,4),o,l,xi)}function vv(e,i,o){var c=we(e)?Tp:uu,l=arguments.length<3;return c(e,se(i,4),o,l,Ru)}function mv(e,i){var o=we(e)?bi:Tu;return o(e,go(se(i,3)))}function wv(e){var i=we(e)?xu:lg;return i(e)}function bv(e,i,o){(o?er(e,i,o):i===r)?i=1:i=be(i);var c=we(e)?Hd:fg;return c(e,i)}function _v(e){var i=we(e)?Kd:dg;return i(e)}function Ev(e){if(e==null)return 0;if(ur(e))return vo(e)?ln(e):e.length;var i=Gt(e);return i==_e||i==Me?e.size:Oa(e).length}function Iv(e,i,o){var c=we(e)?ua:gg;return o&&er(e,i,o)&&(i=r),c(e,se(i,3))}var xv=xe(function(e,i){if(e==null)return[];var o=i.length;return o>1&&er(e,i[0],i[1])?i=[]:o>2&&er(i[0],i[1],i[2])&&(i=[i[0]]),qu(e,Vt(i,1),[])}),fo=nd||function(){return Re.Date.now()};function Sv(e,i){if(typeof i!="function")throw new Pr(f);return e=be(e),function(){if(--e<1)return i.apply(this,arguments)}}function $h(e,i,o){return i=o?r:i,i=e&&i==null?e.length:i,si(e,k,r,r,r,r,i)}function Dh(e,i){var o;if(typeof i!="function")throw new Pr(f);return e=be(e),function(){return--e>0&&(o=i.apply(this,arguments)),e<=1&&(i=r),o}}var Ya=xe(function(e,i,o){var c=ie;if(o.length){var l=Ei(o,wn(Ya));c|=de}return si(e,c,i,o,l)}),Lh=xe(function(e,i,o){var c=ie|he;if(o.length){var l=Ei(o,wn(Lh));c|=de}return si(i,c,e,o,l)});function Mh(e,i,o){i=o?r:i;var c=si(e,fe,r,r,r,r,r,i);return c.placeholder=Mh.placeholder,c}function jh(e,i,o){i=o?r:i;var c=si(e,pe,r,r,r,r,r,i);return c.placeholder=jh.placeholder,c}function Uh(e,i,o){var c,l,d,w,_,R,j=0,U=!1,K=!1,Q=!0;if(typeof e!="function")throw new Pr(f);i=Cr(i)||0,ut(o)&&(U=!!o.leading,K="maxWait"in o,d=K?jt(Cr(o.maxWait)||0,i):d,Q="trailing"in o?!!o.trailing:Q);function te(Et){var qr=c,hi=l;return c=l=r,j=Et,w=e.apply(hi,qr),w}function oe(Et){return j=Et,_=Jn(Se,i),U?te(Et):w}function Ee(Et){var qr=Et-R,hi=Et-j,il=i-qr;return K?Wt(il,d-hi):il}function ae(Et){var qr=Et-R,hi=Et-j;return R===r||qr>=i||qr<0||K&&hi>=d}function Se(){var Et=fo();if(ae(Et))return Te(Et);_=Jn(Se,Ee(Et))}function Te(Et){return _=r,Q&&c?te(Et):(c=l=r,w)}function br(){_!==r&&Gu(_),j=0,c=R=l=_=r}function tr(){return _===r?w:Te(fo())}function _r(){var Et=fo(),qr=ae(Et);if(c=arguments,l=this,R=Et,qr){if(_===r)return oe(R);if(K)return Gu(_),_=Jn(Se,i),te(R)}return _===r&&(_=Jn(Se,i)),w}return _r.cancel=br,_r.flush=tr,_r}var Pv=xe(function(e,i){return Ou(e,1,i)}),Ov=xe(function(e,i,o){return Ou(e,Cr(i)||0,o)});function Rv(e){return si(e,ve)}function po(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new Pr(f);var o=function(){var c=arguments,l=i?i.apply(this,c):c[0],d=o.cache;if(d.has(l))return d.get(l);var w=e.apply(this,c);return o.cache=d.set(l,w)||d,w};return o.cache=new(po.Cache||ii),o}po.Cache=ii;function go(e){if(typeof e!="function")throw new Pr(f);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function Tv(e){return Dh(2,e)}var Av=yg(function(e,i){i=i.length==1&&we(i[0])?nt(i[0],vr(se())):nt(Vt(i,1),vr(se()));var o=i.length;return xe(function(c){for(var l=-1,d=Wt(c.length,o);++l<d;)c[l]=i[l].call(this,c[l]);return qt(e,this,c)})}),Xa=xe(function(e,i){var o=Ei(i,wn(Xa));return si(e,de,r,i,o)}),qh=xe(function(e,i){var o=Ei(i,wn(qh));return si(e,L,r,i,o)}),Cv=oi(function(e,i){return si(e,G,r,r,r,i)});function Nv(e,i){if(typeof e!="function")throw new Pr(f);return i=i===r?i:be(i),xe(e,i)}function $v(e,i){if(typeof e!="function")throw new Pr(f);return i=i==null?0:jt(be(i),0),xe(function(o){var c=o[i],l=Oi(o,0,i);return c&&_i(l,c),qt(e,this,l)})}function Dv(e,i,o){var c=!0,l=!0;if(typeof e!="function")throw new Pr(f);return ut(o)&&(c="leading"in o?!!o.leading:c,l="trailing"in o?!!o.trailing:l),Uh(e,i,{leading:c,maxWait:i,trailing:l})}function Lv(e){return $h(e,1)}function Mv(e,i){return Xa(Ma(i),e)}function jv(){if(!arguments.length)return[];var e=arguments[0];return we(e)?e:[e]}function Uv(e){return Rr(e,q)}function qv(e,i){return i=typeof i=="function"?i:r,Rr(e,q,i)}function zv(e){return Rr(e,O|q)}function kv(e,i){return i=typeof i=="function"?i:r,Rr(e,O|q,i)}function Hv(e,i){return i==null||Pu(e,i,zt(i))}function Ur(e,i){return e===i||e!==e&&i!==i}var Kv=oo(xa),Bv=oo(function(e,i){return e>=i}),Fi=Nu(function(){return arguments}())?Nu:function(e){return vt(e)&&qe.call(e,"callee")&&!mu.call(e,"callee")},we=N.isArray,Vv=Xt?vr(Xt):Zd;function ur(e){return e!=null&&yo(e.length)&&!ci(e)}function _t(e){return vt(e)&&ur(e)}function Fv(e){return e===!0||e===!1||vt(e)&&Zt(e)==$}var Ri=od||uc,Wv=Lr?vr(Lr):eg;function Gv(e){return vt(e)&&e.nodeType===1&&!Qn(e)}function Jv(e){if(e==null)return!0;if(ur(e)&&(we(e)||typeof e=="string"||typeof e.splice=="function"||Ri(e)||bn(e)||Fi(e)))return!e.length;var i=Gt(e);if(i==_e||i==Me)return!e.size;if(Gn(e))return!Oa(e).length;for(var o in e)if(qe.call(e,o))return!1;return!0}function Qv(e,i){return Vn(e,i)}function Yv(e,i,o){o=typeof o=="function"?o:r;var c=o?o(e,i):r;return c===r?Vn(e,i,r,o):!!c}function Za(e){if(!vt(e))return!1;var i=Zt(e);return i==I||i==u||typeof e.message=="string"&&typeof e.name=="string"&&!Qn(e)}function Xv(e){return typeof e=="number"&&bu(e)}function ci(e){if(!ut(e))return!1;var i=Zt(e);return i==ee||i==ge||i==D||i==mt}function zh(e){return typeof e=="number"&&e==be(e)}function yo(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=F}function ut(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function vt(e){return e!=null&&typeof e=="object"}var kh=xr?vr(xr):rg;function Zv(e,i){return e===i||Pa(e,i,Ka(i))}function em(e,i,o){return o=typeof o=="function"?o:r,Pa(e,i,Ka(i),o)}function tm(e){return Hh(e)&&e!=+e}function rm(e){if(qg(e))throw new ye(h);return $u(e)}function im(e){return e===null}function nm(e){return e==null}function Hh(e){return typeof e=="number"||vt(e)&&Zt(e)==Ne}function Qn(e){if(!vt(e)||Zt(e)!=Pe)return!1;var i=Hs(e);if(i===null)return!0;var o=qe.call(i,"constructor")&&i.constructor;return typeof o=="function"&&o instanceof o&&Us.call(o)==ed}var ec=Wr?vr(Wr):ig;function sm(e){return zh(e)&&e>=-F&&e<=F}var Kh=Ln?vr(Ln):ng;function vo(e){return typeof e=="string"||!we(e)&&vt(e)&&Zt(e)==Ye}function wr(e){return typeof e=="symbol"||vt(e)&&Zt(e)==Xe}var bn=Ui?vr(Ui):sg;function om(e){return e===r}function am(e){return vt(e)&&Gt(e)==ke}function cm(e){return vt(e)&&Zt(e)==Ze}var um=oo(Ra),hm=oo(function(e,i){return e<=i});function Bh(e){if(!e)return[];if(ur(e))return vo(e)?Mr(e):cr(e);if(jn&&e[jn])return Hp(e[jn]());var i=Gt(e),o=i==_e?ga:i==Me?Ls:_n;return o(e)}function ui(e){if(!e)return e===0?e:0;if(e=Cr(e),e===ce||e===-ce){var i=e<0?-1:1;return i*H}return e===e?e:0}function be(e){var i=ui(e),o=i%1;return i===i?o?i-o:i:0}function Vh(e){return e?Hi(be(e),0,W):0}function Cr(e){if(typeof e=="number")return e;if(wr(e))return B;if(ut(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=ut(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=hu(e);var o=Bo.test(e);return o||Fo.test(e)?me(e.slice(2),o?2:8):Ko.test(e)?B:+e}function Fh(e){return Jr(e,hr(e))}function lm(e){return e?Hi(be(e),-F,F):e===0?e:0}function je(e){return e==null?"":mr(e)}var fm=vn(function(e,i){if(Gn(i)||ur(i)){Jr(i,zt(i),e);return}for(var o in i)qe.call(i,o)&&Hn(e,o,i[o])}),Wh=vn(function(e,i){Jr(i,hr(i),e)}),mo=vn(function(e,i,o,c){Jr(i,hr(i),e,c)}),pm=vn(function(e,i,o,c){Jr(i,zt(i),e,c)}),dm=oi(_a);function gm(e,i){var o=yn(e);return i==null?o:Su(o,i)}var ym=xe(function(e,i){e=Ge(e);var o=-1,c=i.length,l=c>2?i[2]:r;for(l&&er(i[0],i[1],l)&&(c=1);++o<c;)for(var d=i[o],w=hr(d),_=-1,R=w.length;++_<R;){var j=w[_],U=e[j];(U===r||Ur(U,pn[j])&&!qe.call(e,j))&&(e[j]=d[j])}return e}),vm=xe(function(e){return e.push(r,hh),qt(Gh,r,e)});function mm(e,i){return ou(e,se(i,3),Gr)}function wm(e,i){return ou(e,se(i,3),Ia)}function bm(e,i){return e==null?e:Ea(e,se(i,3),hr)}function _m(e,i){return e==null?e:Au(e,se(i,3),hr)}function Em(e,i){return e&&Gr(e,se(i,3))}function Im(e,i){return e&&Ia(e,se(i,3))}function xm(e){return e==null?[]:Xs(e,zt(e))}function Sm(e){return e==null?[]:Xs(e,hr(e))}function tc(e,i,o){var c=e==null?r:Ki(e,i);return c===r?o:c}function Pm(e,i){return e!=null&&ph(e,i,Jd)}function rc(e,i){return e!=null&&ph(e,i,Qd)}var Om=sh(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=qs.call(i)),e[i]=o},nc(lr)),Rm=sh(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=qs.call(i)),qe.call(e,i)?e[i].push(o):e[i]=[o]},se),Tm=xe(Bn);function zt(e){return ur(e)?Iu(e):Oa(e)}function hr(e){return ur(e)?Iu(e,!0):og(e)}function Am(e,i){var o={};return i=se(i,3),Gr(e,function(c,l,d){ni(o,i(c,l,d),c)}),o}function Cm(e,i){var o={};return i=se(i,3),Gr(e,function(c,l,d){ni(o,l,i(c,l,d))}),o}var Nm=vn(function(e,i,o){Zs(e,i,o)}),Gh=vn(function(e,i,o,c){Zs(e,i,o,c)}),$m=oi(function(e,i){var o={};if(e==null)return o;var c=!1;i=nt(i,function(d){return d=Pi(d,e),c||(c=d.length>1),d}),Jr(e,ka(e),o),c&&(o=Rr(o,O|C|q,Og));for(var l=i.length;l--;)$a(o,i[l]);return o});function Dm(e,i){return Jh(e,go(se(i)))}var Lm=oi(function(e,i){return e==null?{}:cg(e,i)});function Jh(e,i){if(e==null)return{};var o=nt(ka(e),function(c){return[c]});return i=se(i),zu(e,o,function(c,l){return i(c,l[0])})}function Mm(e,i,o){i=Pi(i,e);var c=-1,l=i.length;for(l||(l=1,e=r);++c<l;){var d=e==null?r:e[Qr(i[c])];d===r&&(c=l,d=o),e=ci(d)?d.call(e):d}return e}function jm(e,i,o){return e==null?e:Fn(e,i,o)}function Um(e,i,o,c){return c=typeof c=="function"?c:r,e==null?e:Fn(e,i,o,c)}var Qh=ch(zt),Yh=ch(hr);function qm(e,i,o){var c=we(e),l=c||Ri(e)||bn(e);if(i=se(i,4),o==null){var d=e&&e.constructor;l?o=c?new d:[]:ut(e)?o=ci(d)?yn(Hs(e)):{}:o={}}return(l?Sr:Gr)(e,function(w,_,R){return i(o,w,_,R)}),o}function zm(e,i){return e==null?!0:$a(e,i)}function km(e,i,o){return e==null?e:Vu(e,i,Ma(o))}function Hm(e,i,o,c){return c=typeof c=="function"?c:r,e==null?e:Vu(e,i,Ma(o),c)}function _n(e){return e==null?[]:da(e,zt(e))}function Km(e){return e==null?[]:da(e,hr(e))}function Bm(e,i,o){return o===r&&(o=i,i=r),o!==r&&(o=Cr(o),o=o===o?o:0),i!==r&&(i=Cr(i),i=i===i?i:0),Hi(Cr(e),i,o)}function Vm(e,i,o){return i=ui(i),o===r?(o=i,i=0):o=ui(o),e=Cr(e),Yd(e,i,o)}function Fm(e,i,o){if(o&&typeof o!="boolean"&&er(e,i,o)&&(i=o=r),o===r&&(typeof i=="boolean"?(o=i,i=r):typeof e=="boolean"&&(o=e,e=r)),e===r&&i===r?(e=0,i=1):(e=ui(e),i===r?(i=e,e=0):i=ui(i)),e>i){var c=e;e=i,i=c}if(o||e%1||i%1){var l=_u();return Wt(e+l*(i-e+Fe("1e-"+((l+"").length-1))),i)}return Aa(e,i)}var Wm=mn(function(e,i,o){return i=i.toLowerCase(),e+(o?Xh(i):i)});function Xh(e){return ic(je(e).toLowerCase())}function Zh(e){return e=je(e),e&&e.replace(ei,jp).replace(sa,"")}function Gm(e,i,o){e=je(e),i=mr(i);var c=e.length;o=o===r?c:Hi(be(o),0,c);var l=o;return o-=i.length,o>=0&&e.slice(o,l)==i}function Jm(e){return e=je(e),e&&rt.test(e)?e.replace($i,Up):e}function Qm(e){return e=je(e),e&&Tt.test(e)?e.replace(dt,"\\$&"):e}var Ym=mn(function(e,i,o){return e+(o?"-":"")+i.toLowerCase()}),Xm=mn(function(e,i,o){return e+(o?" ":"")+i.toLowerCase()}),Zm=rh("toLowerCase");function e0(e,i,o){e=je(e),i=be(i);var c=i?ln(e):0;if(!i||c>=i)return e;var l=(i-c)/2;return so(Fs(l),o)+e+so(Vs(l),o)}function t0(e,i,o){e=je(e),i=be(i);var c=i?ln(e):0;return i&&c<i?e+so(i-c,o):e}function r0(e,i,o){e=je(e),i=be(i);var c=i?ln(e):0;return i&&c<i?so(i-c,o)+e:e}function i0(e,i,o){return o||i==null?i=0:i&&(i=+i),hd(je(e).replace(gt,""),i||0)}function n0(e,i,o){return(o?er(e,i,o):i===r)?i=1:i=be(i),Ca(je(e),i)}function s0(){var e=arguments,i=je(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var o0=mn(function(e,i,o){return e+(o?"_":"")+i.toLowerCase()});function a0(e,i,o){return o&&typeof o!="number"&&er(e,i,o)&&(i=o=r),o=o===r?W:o>>>0,o?(e=je(e),e&&(typeof i=="string"||i!=null&&!ec(i))&&(i=mr(i),!i&&hn(e))?Oi(Mr(e),0,o):e.split(i,o)):[]}var c0=mn(function(e,i,o){return e+(o?" ":"")+ic(i)});function u0(e,i,o){return e=je(e),o=o==null?0:Hi(be(o),0,e.length),i=mr(i),e.slice(o,o+i.length)==i}function h0(e,i,o){var c=p.templateSettings;o&&er(e,i,o)&&(i=r),e=je(e),i=mo({},i,c,uh);var l=mo({},i.imports,c.imports,uh),d=zt(l),w=da(l,d),_,R,j=0,U=i.interpolate||tn,K="__p += '",Q=ya((i.escape||tn).source+"|"+U.source+"|"+(U===ct?Ho:tn).source+"|"+(i.evaluate||tn).source+"|$","g"),te="//# sourceURL="+(qe.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++oa+"]")+`
`;e.replace(Q,function(ae,Se,Te,br,tr,_r){return Te||(Te=br),K+=e.slice(j,_r).replace(Go,qp),Se&&(_=!0,K+=`' +
__e(`+Se+`) +
'`),tr&&(R=!0,K+=`';
`+tr+`;
__p += '`),Te&&(K+=`' +
((__t = (`+Te+`)) == null ? '' : __t) +
'`),j=_r+ae.length,ae}),K+=`';
`;var oe=qe.call(i,"variable")&&i.variable;if(!oe)K=`with (obj) {
`+K+`
}
`;else if(zo.test(oe))throw new ye(g);K=(R?K.replace(Vr,""):K).replace(Yt,"$1").replace(Zr,"$1;"),K="function("+(oe||"obj")+`) {
`+(oe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(_?", __e = _.escape":"")+(R?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+K+`return __p
}`;var Ee=tl(function(){return Le(d,te+"return "+K).apply(r,w)});if(Ee.source=K,Za(Ee))throw Ee;return Ee}function l0(e){return je(e).toLowerCase()}function f0(e){return je(e).toUpperCase()}function p0(e,i,o){if(e=je(e),e&&(o||i===r))return hu(e);if(!e||!(i=mr(i)))return e;var c=Mr(e),l=Mr(i),d=lu(c,l),w=fu(c,l)+1;return Oi(c,d,w).join("")}function d0(e,i,o){if(e=je(e),e&&(o||i===r))return e.slice(0,du(e)+1);if(!e||!(i=mr(i)))return e;var c=Mr(e),l=fu(c,Mr(i))+1;return Oi(c,0,l).join("")}function g0(e,i,o){if(e=je(e),e&&(o||i===r))return e.replace(gt,"");if(!e||!(i=mr(i)))return e;var c=Mr(e),l=lu(c,Mr(i));return Oi(c,l).join("")}function y0(e,i){var o=ne,c=ue;if(ut(i)){var l="separator"in i?i.separator:l;o="length"in i?be(i.length):o,c="omission"in i?mr(i.omission):c}e=je(e);var d=e.length;if(hn(e)){var w=Mr(e);d=w.length}if(o>=d)return e;var _=o-ln(c);if(_<1)return c;var R=w?Oi(w,0,_).join(""):e.slice(0,_);if(l===r)return R+c;if(w&&(_+=R.length-_),ec(l)){if(e.slice(_).search(l)){var j,U=R;for(l.global||(l=ya(l.source,je(Ir.exec(l))+"g")),l.lastIndex=0;j=l.exec(U);)var K=j.index;R=R.slice(0,K===r?_:K)}}else if(e.indexOf(mr(l),_)!=_){var Q=R.lastIndexOf(l);Q>-1&&(R=R.slice(0,Q))}return R+c}function v0(e){return e=je(e),e&&lt.test(e)?e.replace(mi,Fp):e}var m0=mn(function(e,i,o){return e+(o?" ":"")+i.toUpperCase()}),ic=rh("toUpperCase");function el(e,i,o){return e=je(e),i=o?r:i,i===r?kp(e)?Jp(e):Np(e):e.match(i)||[]}var tl=xe(function(e,i){try{return qt(e,r,i)}catch(o){return Za(o)?o:new ye(o)}}),w0=oi(function(e,i){return Sr(i,function(o){o=Qr(o),ni(e,o,Ya(e[o],e))}),e});function b0(e){var i=e==null?0:e.length,o=se();return e=i?nt(e,function(c){if(typeof c[1]!="function")throw new Pr(f);return[o(c[0]),c[1]]}):[],xe(function(c){for(var l=-1;++l<i;){var d=e[l];if(qt(d[0],this,c))return qt(d[1],this,c)}})}function _0(e){return Fd(Rr(e,O))}function nc(e){return function(){return e}}function E0(e,i){return e==null||e!==e?i:e}var I0=nh(),x0=nh(!0);function lr(e){return e}function sc(e){return Du(typeof e=="function"?e:Rr(e,O))}function S0(e){return Mu(Rr(e,O))}function P0(e,i){return ju(e,Rr(i,O))}var O0=xe(function(e,i){return function(o){return Bn(o,e,i)}}),R0=xe(function(e,i){return function(o){return Bn(e,o,i)}});function oc(e,i,o){var c=zt(i),l=Xs(i,c);o==null&&!(ut(i)&&(l.length||!c.length))&&(o=i,i=e,e=this,l=Xs(i,zt(i)));var d=!(ut(o)&&"chain"in o)||!!o.chain,w=ci(e);return Sr(l,function(_){var R=i[_];e[_]=R,w&&(e.prototype[_]=function(){var j=this.__chain__;if(d||j){var U=e(this.__wrapped__),K=U.__actions__=cr(this.__actions__);return K.push({func:R,args:arguments,thisArg:e}),U.__chain__=j,U}return R.apply(e,_i([this.value()],arguments))})}),e}function T0(){return Re._===this&&(Re._=td),this}function ac(){}function A0(e){return e=be(e),xe(function(i){return Uu(i,e)})}var C0=Ua(nt),N0=Ua(su),$0=Ua(ua);function rl(e){return Va(e)?ha(Qr(e)):ug(e)}function D0(e){return function(i){return e==null?r:Ki(e,i)}}var L0=oh(),M0=oh(!0);function cc(){return[]}function uc(){return!1}function j0(){return{}}function U0(){return""}function q0(){return!0}function z0(e,i){if(e=be(e),e<1||e>F)return[];var o=W,c=Wt(e,W);i=se(i),e-=W;for(var l=pa(c,i);++o<e;)i(o);return l}function k0(e){return we(e)?nt(e,Qr):wr(e)?[e]:cr(Eh(je(e)))}function H0(e){var i=++Zp;return je(e)+i}var K0=no(function(e,i){return e+i},0),B0=qa("ceil"),V0=no(function(e,i){return e/i},1),F0=qa("floor");function W0(e){return e&&e.length?Ys(e,lr,xa):r}function G0(e,i){return e&&e.length?Ys(e,se(i,2),xa):r}function J0(e){return cu(e,lr)}function Q0(e,i){return cu(e,se(i,2))}function Y0(e){return e&&e.length?Ys(e,lr,Ra):r}function X0(e,i){return e&&e.length?Ys(e,se(i,2),Ra):r}var Z0=no(function(e,i){return e*i},1),ew=qa("round"),tw=no(function(e,i){return e-i},0);function rw(e){return e&&e.length?fa(e,lr):0}function iw(e,i){return e&&e.length?fa(e,se(i,2)):0}return p.after=Sv,p.ary=$h,p.assign=fm,p.assignIn=Wh,p.assignInWith=mo,p.assignWith=pm,p.at=dm,p.before=Dh,p.bind=Ya,p.bindAll=w0,p.bindKey=Lh,p.castArray=jv,p.chain=Ah,p.chunk=Fg,p.compact=Wg,p.concat=Gg,p.cond=b0,p.conforms=_0,p.constant=nc,p.countBy=rv,p.create=gm,p.curry=Mh,p.curryRight=jh,p.debounce=Uh,p.defaults=ym,p.defaultsDeep=vm,p.defer=Pv,p.delay=Ov,p.difference=Jg,p.differenceBy=Qg,p.differenceWith=Yg,p.drop=Xg,p.dropRight=Zg,p.dropRightWhile=ey,p.dropWhile=ty,p.fill=ry,p.filter=nv,p.flatMap=av,p.flatMapDeep=cv,p.flatMapDepth=uv,p.flatten=Ph,p.flattenDeep=iy,p.flattenDepth=ny,p.flip=Rv,p.flow=I0,p.flowRight=x0,p.fromPairs=sy,p.functions=xm,p.functionsIn=Sm,p.groupBy=hv,p.initial=ay,p.intersection=cy,p.intersectionBy=uy,p.intersectionWith=hy,p.invert=Om,p.invertBy=Rm,p.invokeMap=fv,p.iteratee=sc,p.keyBy=pv,p.keys=zt,p.keysIn=hr,p.map=lo,p.mapKeys=Am,p.mapValues=Cm,p.matches=S0,p.matchesProperty=P0,p.memoize=po,p.merge=Nm,p.mergeWith=Gh,p.method=O0,p.methodOf=R0,p.mixin=oc,p.negate=go,p.nthArg=A0,p.omit=$m,p.omitBy=Dm,p.once=Tv,p.orderBy=dv,p.over=C0,p.overArgs=Av,p.overEvery=N0,p.overSome=$0,p.partial=Xa,p.partialRight=qh,p.partition=gv,p.pick=Lm,p.pickBy=Jh,p.property=rl,p.propertyOf=D0,p.pull=dy,p.pullAll=Rh,p.pullAllBy=gy,p.pullAllWith=yy,p.pullAt=vy,p.range=L0,p.rangeRight=M0,p.rearg=Cv,p.reject=mv,p.remove=my,p.rest=Nv,p.reverse=Ja,p.sampleSize=bv,p.set=jm,p.setWith=Um,p.shuffle=_v,p.slice=wy,p.sortBy=xv,p.sortedUniq=Py,p.sortedUniqBy=Oy,p.split=a0,p.spread=$v,p.tail=Ry,p.take=Ty,p.takeRight=Ay,p.takeRightWhile=Cy,p.takeWhile=Ny,p.tap=Wy,p.throttle=Dv,p.thru=ho,p.toArray=Bh,p.toPairs=Qh,p.toPairsIn=Yh,p.toPath=k0,p.toPlainObject=Fh,p.transform=qm,p.unary=Lv,p.union=$y,p.unionBy=Dy,p.unionWith=Ly,p.uniq=My,p.uniqBy=jy,p.uniqWith=Uy,p.unset=zm,p.unzip=Qa,p.unzipWith=Th,p.update=km,p.updateWith=Hm,p.values=_n,p.valuesIn=Km,p.without=qy,p.words=el,p.wrap=Mv,p.xor=zy,p.xorBy=ky,p.xorWith=Hy,p.zip=Ky,p.zipObject=By,p.zipObjectDeep=Vy,p.zipWith=Fy,p.entries=Qh,p.entriesIn=Yh,p.extend=Wh,p.extendWith=mo,oc(p,p),p.add=K0,p.attempt=tl,p.camelCase=Wm,p.capitalize=Xh,p.ceil=B0,p.clamp=Bm,p.clone=Uv,p.cloneDeep=zv,p.cloneDeepWith=kv,p.cloneWith=qv,p.conformsTo=Hv,p.deburr=Zh,p.defaultTo=E0,p.divide=V0,p.endsWith=Gm,p.eq=Ur,p.escape=Jm,p.escapeRegExp=Qm,p.every=iv,p.find=sv,p.findIndex=xh,p.findKey=mm,p.findLast=ov,p.findLastIndex=Sh,p.findLastKey=wm,p.floor=F0,p.forEach=Ch,p.forEachRight=Nh,p.forIn=bm,p.forInRight=_m,p.forOwn=Em,p.forOwnRight=Im,p.get=tc,p.gt=Kv,p.gte=Bv,p.has=Pm,p.hasIn=rc,p.head=Oh,p.identity=lr,p.includes=lv,p.indexOf=oy,p.inRange=Vm,p.invoke=Tm,p.isArguments=Fi,p.isArray=we,p.isArrayBuffer=Vv,p.isArrayLike=ur,p.isArrayLikeObject=_t,p.isBoolean=Fv,p.isBuffer=Ri,p.isDate=Wv,p.isElement=Gv,p.isEmpty=Jv,p.isEqual=Qv,p.isEqualWith=Yv,p.isError=Za,p.isFinite=Xv,p.isFunction=ci,p.isInteger=zh,p.isLength=yo,p.isMap=kh,p.isMatch=Zv,p.isMatchWith=em,p.isNaN=tm,p.isNative=rm,p.isNil=nm,p.isNull=im,p.isNumber=Hh,p.isObject=ut,p.isObjectLike=vt,p.isPlainObject=Qn,p.isRegExp=ec,p.isSafeInteger=sm,p.isSet=Kh,p.isString=vo,p.isSymbol=wr,p.isTypedArray=bn,p.isUndefined=om,p.isWeakMap=am,p.isWeakSet=cm,p.join=ly,p.kebabCase=Ym,p.last=Ar,p.lastIndexOf=fy,p.lowerCase=Xm,p.lowerFirst=Zm,p.lt=um,p.lte=hm,p.max=W0,p.maxBy=G0,p.mean=J0,p.meanBy=Q0,p.min=Y0,p.minBy=X0,p.stubArray=cc,p.stubFalse=uc,p.stubObject=j0,p.stubString=U0,p.stubTrue=q0,p.multiply=Z0,p.nth=py,p.noConflict=T0,p.noop=ac,p.now=fo,p.pad=e0,p.padEnd=t0,p.padStart=r0,p.parseInt=i0,p.random=Fm,p.reduce=yv,p.reduceRight=vv,p.repeat=n0,p.replace=s0,p.result=Mm,p.round=ew,p.runInContext=P,p.sample=wv,p.size=Ev,p.snakeCase=o0,p.some=Iv,p.sortedIndex=by,p.sortedIndexBy=_y,p.sortedIndexOf=Ey,p.sortedLastIndex=Iy,p.sortedLastIndexBy=xy,p.sortedLastIndexOf=Sy,p.startCase=c0,p.startsWith=u0,p.subtract=tw,p.sum=rw,p.sumBy=iw,p.template=h0,p.times=z0,p.toFinite=ui,p.toInteger=be,p.toLength=Vh,p.toLower=l0,p.toNumber=Cr,p.toSafeInteger=lm,p.toString=je,p.toUpper=f0,p.trim=p0,p.trimEnd=d0,p.trimStart=g0,p.truncate=y0,p.unescape=v0,p.uniqueId=H0,p.upperCase=m0,p.upperFirst=ic,p.each=Ch,p.eachRight=Nh,p.first=Oh,oc(p,function(){var e={};return Gr(p,function(i,o){qe.call(p.prototype,o)||(e[o]=i)}),e}(),{chain:!1}),p.VERSION=n,Sr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){p[e].placeholder=p}),Sr(["drop","take"],function(e,i){Oe.prototype[e]=function(o){o=o===r?1:jt(be(o),0);var c=this.__filtered__&&!i?new Oe(this):this.clone();return c.__filtered__?c.__takeCount__=Wt(o,c.__takeCount__):c.__views__.push({size:Wt(o,W),type:e+(c.__dir__<0?"Right":"")}),c},Oe.prototype[e+"Right"]=function(o){return this.reverse()[e](o).reverse()}}),Sr(["filter","map","takeWhile"],function(e,i){var o=i+1,c=o==m||o==X;Oe.prototype[e]=function(l){var d=this.clone();return d.__iteratees__.push({iteratee:se(l,3),type:o}),d.__filtered__=d.__filtered__||c,d}}),Sr(["head","last"],function(e,i){var o="take"+(i?"Right":"");Oe.prototype[e]=function(){return this[o](1).value()[0]}}),Sr(["initial","tail"],function(e,i){var o="drop"+(i?"":"Right");Oe.prototype[e]=function(){return this.__filtered__?new Oe(this):this[o](1)}}),Oe.prototype.compact=function(){return this.filter(lr)},Oe.prototype.find=function(e){return this.filter(e).head()},Oe.prototype.findLast=function(e){return this.reverse().find(e)},Oe.prototype.invokeMap=xe(function(e,i){return typeof e=="function"?new Oe(this):this.map(function(o){return Bn(o,e,i)})}),Oe.prototype.reject=function(e){return this.filter(go(se(e)))},Oe.prototype.slice=function(e,i){e=be(e);var o=this;return o.__filtered__&&(e>0||i<0)?new Oe(o):(e<0?o=o.takeRight(-e):e&&(o=o.drop(e)),i!==r&&(i=be(i),o=i<0?o.dropRight(-i):o.take(i-e)),o)},Oe.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Oe.prototype.toArray=function(){return this.take(W)},Gr(Oe.prototype,function(e,i){var o=/^(?:filter|find|map|reject)|While$/.test(i),c=/^(?:head|last)$/.test(i),l=p[c?"take"+(i=="last"?"Right":""):i],d=c||/^find/.test(i);l&&(p.prototype[i]=function(){var w=this.__wrapped__,_=c?[1]:arguments,R=w instanceof Oe,j=_[0],U=R||we(w),K=function(Se){var Te=l.apply(p,_i([Se],_));return c&&Q?Te[0]:Te};U&&o&&typeof j=="function"&&j.length!=1&&(R=U=!1);var Q=this.__chain__,te=!!this.__actions__.length,oe=d&&!Q,Ee=R&&!te;if(!d&&U){w=Ee?w:new Oe(this);var ae=e.apply(w,_);return ae.__actions__.push({func:ho,args:[K],thisArg:r}),new Or(ae,Q)}return oe&&Ee?e.apply(this,_):(ae=this.thru(K),oe?c?ae.value()[0]:ae.value():ae)})}),Sr(["pop","push","shift","sort","splice","unshift"],function(e){var i=Ms[e],o=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",c=/^(?:pop|shift)$/.test(e);p.prototype[e]=function(){var l=arguments;if(c&&!this.__chain__){var d=this.value();return i.apply(we(d)?d:[],l)}return this[o](function(w){return i.apply(we(w)?w:[],l)})}}),Gr(Oe.prototype,function(e,i){var o=p[i];if(o){var c=o.name+"";qe.call(gn,c)||(gn[c]=[]),gn[c].push({name:i,func:o})}}),gn[io(r,he).name]=[{name:"wrapper",func:r}],Oe.prototype.clone=vd,Oe.prototype.reverse=md,Oe.prototype.value=wd,p.prototype.at=Gy,p.prototype.chain=Jy,p.prototype.commit=Qy,p.prototype.next=Yy,p.prototype.plant=Zy,p.prototype.reverse=ev,p.prototype.toJSON=p.prototype.valueOf=p.prototype.value=tv,p.prototype.first=p.prototype.head,jn&&(p.prototype[jn]=Xy),p},fn=Qp();bt?((bt.exports=fn)._=fn,We._=fn):Re._=fn}).call(is)})(Uc,Uc.exports);var Rx=Object.defineProperty,Tx=Object.defineProperties,Ax=Object.getOwnPropertyDescriptors,mf=Object.getOwnPropertySymbols,Cx=Object.prototype.hasOwnProperty,Nx=Object.prototype.propertyIsEnumerable,wf=(s,t,r)=>t in s?Rx(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,Io=(s,t)=>{for(var r in t||(t={}))Cx.call(t,r)&&wf(s,r,t[r]);if(mf)for(var r of mf(t))Nx.call(t,r)&&wf(s,r,t[r]);return s},$x=(s,t)=>Tx(s,Ax(t));function Ci(s,t,r){var n;const a=Mw(s);return((n=t.rpcMap)==null?void 0:n[a.reference])||`${Ox}?chainId=${a.namespace}:${a.reference}&projectId=${r}`}function en(s){return s.includes(":")?s.split(":")[1]:s}function Sp(s){return s.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function Dx(s,t){const r=Object.keys(t.namespaces).filter(a=>a.includes(s));if(!r.length)return[];const n=[];return r.forEach(a=>{const h=t.namespaces[a].accounts;n.push(...h)}),n}function Lx(s={},t={}){const r=bf(s),n=bf(t);return Uc.exports.merge(r,n)}function bf(s){var t,r,n,a;const h={};if(!Sn(s))return h;for(const[f,g]of Object.entries(s)){const b=Wc(f)?[f]:g.chains,y=g.methods||[],E=g.events||[],O=g.rpcMap||{},C=ns(f);h[C]=$x(Io(Io({},h[C]),g),{chains:lc(b,(t=h[C])==null?void 0:t.chains),methods:lc(y,(r=h[C])==null?void 0:r.methods),events:lc(E,(n=h[C])==null?void 0:n.events),rpcMap:Io(Io({},O),(a=h[C])==null?void 0:a.rpcMap)})}return h}function Mx(s){return s.includes(":")?s.split(":")[2]:s}function jx(s){const t={};for(const[r,n]of Object.entries(s)){const a=n.methods||[],h=n.events||[],f=n.accounts||[],g=Wc(r)?[r]:n.chains?n.chains:Sp(n.accounts);t[r]={chains:g,methods:a,events:h,accounts:f}}return t}function xc(s){return typeof s=="number"?s:s.includes("0x")?parseInt(s,16):s.includes(":")?Number(s.split(":")[1]):Number(s)}const Pp={},st=s=>Pp[s],Sc=(s,t)=>{Pp[s]=t};class Ux{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(vi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const a=en(r);t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Ci(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new yi(new Ni(n,st("disableProviderPing")))}}class qx{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(parseInt(t),r),this.chainId=parseInt(t),this.events.emit(vi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const n=r||Ci(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new yi(new Ni(n,st("disableProviderPing")))}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const a=parseInt(en(r));t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r,n;let a=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";a=a.startsWith("0x")?a:`0x${a}`;const h=parseInt(a,16);if(this.isChainApproved(h))this.setDefaultChain(`${h}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:a}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${h}`);else throw new Error(`Failed to switch to chain 'eip155:${h}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class zx{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(vi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const a=en(r);t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Ci(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new yi(new Ni(n,st("disableProviderPing")))}}class kx{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(vi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const a=en(r);t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Ci(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new yi(new Ni(n,st("disableProviderPing")))}}class Hx{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(vi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const n=this.getCardanoRPCUrl(r),a=en(r);t[a]=this.createHttpProvider(a,n)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||this.getCardanoRPCUrl(t);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new yi(new Ni(n,st("disableProviderPing")))}}class Kx{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(vi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const a=en(r);t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Ci(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new yi(new Ni(n,st("disableProviderPing")))}}class Bx{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(vi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const a=en(r);t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Ci(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new yi(new Ni(n,st("disableProviderPing")))}}class Vx{constructor(t){this.name="near",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const n=r||Ci(`${this.name}:${t}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,n)}this.events.emit(vi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;t[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Ci(t,this.namespace);return typeof n>"u"?void 0:new yi(new Ni(n,st("disableProviderPing")))}}var Fx=Object.defineProperty,Wx=Object.defineProperties,Gx=Object.getOwnPropertyDescriptors,_f=Object.getOwnPropertySymbols,Jx=Object.prototype.hasOwnProperty,Qx=Object.prototype.propertyIsEnumerable,Ef=(s,t,r)=>t in s?Fx(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,xo=(s,t)=>{for(var r in t||(t={}))Jx.call(t,r)&&Ef(s,r,t[r]);if(_f)for(var r of _f(t))Qx.call(t,r)&&Ef(s,r,t[r]);return s},Pc=(s,t)=>Wx(s,Gx(t));class iu{constructor(t){this.events=new Hc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ae.pino(Ae.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||yf})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new iu(t);return await r.initialize(),r}async request(t,r){const[n,a]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:xo({},t),chainId:`${n}:${a}`,topic:this.session.topic})}sendAsync(t,r,n){this.request(t,n).then(a=>r(null,a)).catch(a=>r(a,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:It("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:a}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await a().then(h=>{this.session=h,this.namespaces||(this.namespaces=jx(h.namespaces),this.persist("namespaces",this.namespaces))}).catch(h=>{if(h.message!==Ip)throw h;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{if(!this.session)return;const[n,a]=this.validateChain(t);this.getProvider(n).setDefaultChain(a,r)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(Xr(r)){for(const n of r)t.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await bx.init({logger:this.providerOpts.logger||yf,relayUrl:this.providerOpts.relayUrl||xx,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>ns(r)))];Sc("client",this.client),Sc("events",this.events),Sc("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const n=Dx(r,this.session),a=Sp(n),h=Lx(this.namespaces,this.optionalNamespaces),f=Pc(xo({},h[r]),{accounts:n,chains:a});switch(r){case"eip155":this.rpcProviders[r]=new qx({namespace:f});break;case"solana":this.rpcProviders[r]=new zx({namespace:f});break;case"cosmos":this.rpcProviders[r]=new kx({namespace:f});break;case"polkadot":this.rpcProviders[r]=new Ux({namespace:f});break;case"cip34":this.rpcProviders[r]=new Hx({namespace:f});break;case"elrond":this.rpcProviders[r]=new Kx({namespace:f});break;case"multiversx":this.rpcProviders[r]=new Bx({namespace:f});break;case"near":this.rpcProviders[r]=new Vx({namespace:f});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:n}=r;if(n.name==="accountsChanged"){const a=n.data;a&&Xr(a)&&this.events.emit("accountsChanged",a.map(Mx))}else if(n.name==="chainChanged"){const a=r.chainId,h=r.event.data,f=ns(a),g=xc(a)!==xc(h)?`${f}:${xc(h)}`:a;this.onChainChanged(g)}else this.events.emit(n.name,n.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var n;const{namespaces:a}=r,h=(n=this.client)==null?void 0:n.session.get(t);this.session=Pc(xo({},h),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Pc(xo({},It("USER_DISCONNECTED")),{data:t.topic}))}),this.on(vi.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:n,sessionProperties:a}=t;r&&Object.keys(r).length&&(this.namespaces=r),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=a,this.persist("namespaces",r),this.persist("optionalNamespaces",n)}validateChain(t){const[r,n]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,n];if(r&&!Object.keys(this.namespaces||{}).map(f=>ns(f)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&n)return[r,n];const a=ns(Object.keys(this.namespaces)[0]),h=this.rpcProviders[a].getDefaultChain();return[a,h]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var n;if(!this.namespaces)return;const[a,h]=this.validateChain(t);r||this.getProvider(a).setDefaultChain(h),((n=this.namespaces[a])!=null?n:this.namespaces[`${a}:${h}`]).defaultChain=h,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",h)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${vf}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${vf}/${t}`)}}const Yx=iu,Xx="wc",Zx="ethereum_provider",eS=`${Xx}@2:${Zx}:`,tS="https://rpc.walletconnect.com/v1/",qc=["eth_sendTransaction","personal_sign"],rS=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],zc=["chainChanged","accountsChanged"],iS=["chainChanged","accountsChanged","message","disconnect","connect"];var nS=Object.defineProperty,sS=Object.defineProperties,oS=Object.getOwnPropertyDescriptors,If=Object.getOwnPropertySymbols,aS=Object.prototype.hasOwnProperty,cS=Object.prototype.propertyIsEnumerable,xf=(s,t,r)=>t in s?nS(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,os=(s,t)=>{for(var r in t||(t={}))aS.call(t,r)&&xf(s,r,t[r]);if(If)for(var r of If(t))cS.call(t,r)&&xf(s,r,t[r]);return s},Sf=(s,t)=>sS(s,oS(t));function Do(s){return Number(s[0].split(":")[1])}function Oc(s){return`0x${s.toString(16)}`}function uS(s){const{chains:t,optionalChains:r,methods:n,optionalMethods:a,events:h,optionalEvents:f,rpcMap:g}=s;if(!Xr(t))throw new Error("Invalid chains");const b={chains:t,methods:n||qc,events:h||zc,rpcMap:os({},t.length?{[Do(t)]:g[Do(t)]}:{})},y=h==null?void 0:h.filter(q=>!zc.includes(q)),E=n==null?void 0:n.filter(q=>!qc.includes(q));if(!r&&!f&&!a&&!(y!=null&&y.length)&&!(E!=null&&E.length))return{required:t.length?b:void 0};const O=(y==null?void 0:y.length)&&(E==null?void 0:E.length)||!r,C={chains:[...new Set(O?b.chains.concat(r||[]):r)],methods:[...new Set(b.methods.concat(a!=null&&a.length?a:rS))],events:[...new Set(b.events.concat(f!=null&&f.length?f:iS))],rpcMap:g};return{required:t.length?b:void 0,optional:r.length?C:void 0}}class nu{constructor(){this.events=new $r.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=eS,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new nu;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:n}=uS(this.rpc);try{const a=await new Promise(async(f,g)=>{var b;this.rpc.showQrModal&&((b=this.modal)==null||b.subscribeModal(y=>{!y.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),g(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Sf(os({namespaces:os({},r&&{[this.namespace]:r})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(y=>{f(y)}).catch(y=>{g(new Error(y.message))})});if(!a)return;const h=jw(a.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:h),this.setAccounts(h),this.events.emit("connect",{chainId:Oc(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:n}=r;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",Oc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",Sf(os({},It("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,n;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(n=this.modal)==null||n.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",Oc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(t){const[r,n,a]=t.split(":");return{chainId:`${r}:${n}`,address:a}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,n;const a=(r=t==null?void 0:t.chains)!=null?r:[],h=(n=t==null?void 0:t.optionalChains)!=null?n:[],f=a.concat(h);if(!f.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const g=a.length?(t==null?void 0:t.methods)||qc:[],b=a.length?(t==null?void 0:t.events)||zc:[],y=(t==null?void 0:t.optionalMethods)||[],E=(t==null?void 0:t.optionalEvents)||[],O=(t==null?void 0:t.rpcMap)||this.buildRpcMap(f,t.projectId),C=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:a==null?void 0:a.map(q=>this.formatChainId(q)),optionalChains:h.map(q=>this.formatChainId(q)),methods:g,events:b,optionalMethods:y,optionalEvents:E,rpcMap:O,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:C,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const n={};return t.forEach(a=>{n[a]=this.getRpcUrl(a,r)}),n}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?Do(this.rpc.chains):Do(this.rpc.optionalChains),this.signer=await Yx.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:n}=await bw(()=>import("./index-P9_62miT.js").then(a=>a.i),__vite__mapDeps([0,1,2]));r=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(os({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:n,rpcMap:a}=t;r&&Xr(r)&&(this.rpc.chains=r.map(h=>this.formatChainId(h)),r.forEach(h=>{this.rpc.rpcMap[h]=(a==null?void 0:a[h])||this.getRpcUrl(h)})),n&&Xr(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(h=>this.formatChainId(h)),n.forEach(h=>{this.rpc.rpcMap[h]=(a==null?void 0:a[h])||this.getRpcUrl(h)}))}getRpcUrl(t,r){var n;return((n=this.rpc.rpcMap)==null?void 0:n[t])||`${tS}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const OS=nu;export{OS as EthereumProvider,iS as OPTIONAL_EVENTS,rS as OPTIONAL_METHODS,zc as REQUIRED_EVENTS,qc as REQUIRED_METHODS,nu as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/index-P9_62miT.js","assets/index-IIPSTlTY.js","assets/index-l1SnzB4_.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}